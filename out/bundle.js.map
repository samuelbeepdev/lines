{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///../node_modules/tslib/tslib.es6.js","webpack:///../node_modules/gl-vec3/index.js","webpack:///../node_modules/events/events.js","webpack:///../node_modules/ndarray/ndarray.js","webpack:///../node_modules/aabb-3d/index.js","webpack:///../node_modules/typedarray-pool/pool.js","webpack:///../node_modules/bit-twiddle/twiddle.js","webpack:///../node_modules/noa-engine/src/components/position.js","webpack:///../node_modules/noa-engine/src/components/physics.js","webpack:///../node_modules/gl-vec3/epsilon.js","webpack:///../node_modules/gl-vec3/create.js","webpack:///../node_modules/gl-vec3/fromValues.js","webpack:///../node_modules/gl-vec3/normalize.js","webpack:///../node_modules/gl-vec3/dot.js","webpack:///../node_modules/gl-vec3/subtract.js","webpack:///../node_modules/gl-vec3/multiply.js","webpack:///../node_modules/gl-vec3/divide.js","webpack:///../node_modules/gl-vec3/distance.js","webpack:///../node_modules/gl-vec3/squaredDistance.js","webpack:///../node_modules/gl-vec3/length.js","webpack:///../node_modules/gl-vec3/squaredLength.js","webpack:///../node_modules/iota-array/iota.js","webpack:///../node_modules/voxel-aabb-sweep/index.js","webpack:///../node_modules/webpack/buildin/global.js","webpack:///../node_modules/box-intersect/lib/sweep.js","webpack:///../node_modules/box-intersect/lib/partition.js","webpack:///../node_modules/gl-vec3/clone.js","webpack:///../node_modules/gl-vec3/angle.js","webpack:///../node_modules/gl-vec3/copy.js","webpack:///../node_modules/gl-vec3/set.js","webpack:///../node_modules/gl-vec3/equals.js","webpack:///../node_modules/gl-vec3/exactEquals.js","webpack:///../node_modules/gl-vec3/add.js","webpack:///../node_modules/gl-vec3/sub.js","webpack:///../node_modules/gl-vec3/mul.js","webpack:///../node_modules/gl-vec3/div.js","webpack:///../node_modules/gl-vec3/min.js","webpack:///../node_modules/gl-vec3/max.js","webpack:///../node_modules/gl-vec3/floor.js","webpack:///../node_modules/gl-vec3/ceil.js","webpack:///../node_modules/gl-vec3/round.js","webpack:///../node_modules/gl-vec3/scale.js","webpack:///../node_modules/gl-vec3/scaleAndAdd.js","webpack:///../node_modules/gl-vec3/dist.js","webpack:///../node_modules/gl-vec3/sqrDist.js","webpack:///../node_modules/gl-vec3/len.js","webpack:///../node_modules/gl-vec3/sqrLen.js","webpack:///../node_modules/gl-vec3/negate.js","webpack:///../node_modules/gl-vec3/inverse.js","webpack:///../node_modules/gl-vec3/cross.js","webpack:///../node_modules/gl-vec3/lerp.js","webpack:///../node_modules/gl-vec3/random.js","webpack:///../node_modules/gl-vec3/transformMat4.js","webpack:///../node_modules/gl-vec3/transformMat3.js","webpack:///../node_modules/gl-vec3/transformQuat.js","webpack:///../node_modules/gl-vec3/rotateX.js","webpack:///../node_modules/gl-vec3/rotateY.js","webpack:///../node_modules/gl-vec3/rotateZ.js","webpack:///../node_modules/gl-vec3/forEach.js","webpack:///../node_modules/is-buffer/index.js","webpack:///../node_modules/fast-voxel-raycast/index.js","webpack:///../node_modules/game-shell/shell.js","webpack:///../node_modules/util/util.js","webpack:///../node_modules/process/browser.js","webpack:///../node_modules/util/support/isBufferBrowser.js","webpack:///../node_modules/util/node_modules/inherits/inherits_browser.js","webpack:///../node_modules/domready/ready.js","webpack:///../node_modules/game-shell/node_modules/vkey/index.js","webpack:///../node_modules/invert-hash/invert.js","webpack:///../node_modules/uniq/uniq.js","webpack:///../node_modules/binary-search-bounds/search-bounds.js","webpack:///../node_modules/game-shell/lib/raf-polyfill.js","webpack:///../node_modules/game-shell/lib/mousewheel-polyfill.js","webpack:///../node_modules/game-shell/lib/hrtime-polyfill.js","webpack:///../node_modules/game-inputs/inputs.js","webpack:///../node_modules/vkey/index.js","webpack:///../node_modules/game-inputs/lib/mousewheel-polyfill.js","webpack:///../node_modules/voxel-physics-engine/src/index.js","webpack:///../node_modules/voxel-physics-engine/src/rigidBody.js","webpack:///../node_modules/ent-comp/src/ECS.js","webpack:///../node_modules/ent-comp/src/dataStore.js","webpack:///../node_modules/noa-engine/src/components sync nonrecursive \\.js$","webpack:///../node_modules/noa-engine/src/components/collideEntities.js","webpack:///../node_modules/box-intersect/index.js","webpack:///../node_modules/dup/dup.js","webpack:///../node_modules/buffer/index.js","webpack:///../node_modules/base64-js/index.js","webpack:///../node_modules/ieee754/index.js","webpack:///../node_modules/isarray/index.js","webpack:///../node_modules/box-intersect/lib/sort.js","webpack:///../node_modules/box-intersect/lib/intersect.js","webpack:///../node_modules/box-intersect/lib/brute.js","webpack:///../node_modules/box-intersect/lib/median.js","webpack:///../node_modules/noa-engine/src/components/collideTerrain.js","webpack:///../node_modules/noa-engine/src/components/fadeOnZoom.js","webpack:///../node_modules/noa-engine/src/components/followsEntity.js","webpack:///../node_modules/noa-engine/src/components/mesh.js","webpack:///../node_modules/noa-engine/src/components/movement.js","webpack:///../node_modules/noa-engine/src/components/receivesInputs.js","webpack:///../node_modules/noa-engine/src/components/shadow.js","webpack:///../node_modules/noa-engine/src/components/smoothCamera.js","webpack:///../node_modules/noa-engine/src/lib/container.js","webpack:///../node_modules/noa-engine/src/lib/util.js","webpack:///../node_modules/noa-engine/src/lib/rendering.js","webpack:///../node_modules/noa-engine/src/lib/terrainMesher.js","webpack:///../node_modules/noa-engine/src/lib/objectMesher.js","webpack:///../node_modules/noa-engine/src/lib/chunk.js","webpack:///../node_modules/noa-engine/src/lib/world.js","webpack:///../node_modules/noa-engine/src/lib/inputs.js","webpack:///../node_modules/noa-engine/src/lib/physics.js","webpack:///../node_modules/noa-engine/src/lib/camera.js","webpack:///../node_modules/noa-engine/src/lib/registry.js","webpack:///../node_modules/noa-engine/src/lib/entities.js","webpack:///../node_modules/noa-engine/src/index.js","webpack:///./index.js"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","1","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","extendStatics","b","setPrototypeOf","__proto__","Array","__extends","__","this","constructor","__assign","assign","arguments","__decorate","decorators","target","desc","getOwnPropertyDescriptor","Reflect","decorate","EPSILON","clone","angle","fromValues","copy","set","equals","exactEquals","add","subtract","sub","multiply","mul","divide","div","min","max","floor","ceil","round","scale","scaleAndAdd","distance","dist","squaredDistance","sqrDist","len","squaredLength","sqrLen","negate","inverse","normalize","dot","cross","lerp","random","transformMat4","transformMat3","transformQuat","rotateX","rotateY","rotateZ","forEach","ReflectOwnKeys","R","ReflectApply","receiver","args","Function","ownKeys","getOwnPropertySymbols","getOwnPropertyNames","concat","NumberIsNaN","Number","isNaN","EventEmitter","init","once","emitter","Promise","resolve","reject","eventListener","undefined","errorListener","removeListener","err","_events","_eventsCount","_maxListeners","defaultMaxListeners","checkListener","listener","TypeError","_getMaxListeners","that","_addListener","type","prepend","events","existing","warning","newListener","emit","unshift","warned","w","Error","String","count","console","warn","onceWrapper","fired","wrapFn","_onceWrap","state","wrapped","_listeners","unwrap","evlistener","arr","ret","unwrapListeners","arrayClone","listenerCount","arg","RangeError","getPrototypeOf","setMaxListeners","getMaxListeners","doError","error","er","message","context","handler","listeners","addListener","on","prependListener","prependOnceListener","list","position","originalListener","index","pop","spliceOne","off","removeAllListeners","keys","rawListeners","eventNames","iota","isBuffer","hasTypedArrays","Float64Array","compare1st","a","order","stride","terms","Math","abs","sort","compileConstructor","dtype","dimension","className","join","useGetters","code","procedure","CACHED_CONSTRUCTORS","indices","map","index_str","shapeArg","strideArg","a_vars","c_vars","tShape","tStride","idx","shape","offset","ctor","array","sz","toString","isArray","arrayDType","ctor_list","AABB","vec3","pos","vec","pos2","base","mag","proto","width","height","depth","x0","y0","z0","x1","y1","z1","translate","by","setPosition","expand","aabb","intersects","touches","intersection","union","base_x","base_y","base_z","bits","dup","Buffer","global","__TYPEDARRAY_POOL","UINT8","UINT16","UINT32","BIGUINT64","INT8","INT16","INT32","BIGINT64","FLOAT","DOUBLE","DATA","UINT8C","BUFFER","hasUint8C","Uint8ClampedArray","hasBigUint64","BigUint64Array","hasBigInt64","BigInt64Array","POOL","freeArrayBuffer","buffer","byteLength","log_n","log2","mallocArrayBuffer","nextPow2","ArrayBuffer","mallocUint8","Uint8Array","mallocUint16","Uint16Array","mallocUint32","Uint32Array","mallocInt8","Int8Array","mallocInt16","Int16Array","mallocInt32","Int32Array","mallocFloat","Float32Array","mallocDouble","mallocUint8Clamped","mallocBigUint64","mallocBigInt64","mallocDataView","DataView","mallocBuffer","cache","free","freeUint8","freeUint16","freeUint32","freeBigUint64","freeInt8","freeInt16","freeInt32","freeBigInt64","freeFloat32","freeFloat","freeFloat64","freeDouble","freeUint8Clamped","freeDataView","freeBuffer","malloc","mallocFloat32","mallocFloat64","clearCache","countTrailingZeros","v","INT_BITS","INT_MAX","INT_MIN","sign","mask","x","y","isPow2","log10","popCount","prevPow2","parity","REVERSE_TABLE","tab","reverse","interleave2","deinterleave2","interleave3","z","deinterleave3","nextCombination","updatePositionExtents","hw","lpos","_localPosition","ext","_extents","_renderPosition","onAdd","eid","noa","globalToLocal","onRemove","system","dt","states","worldOriginOffset","body","entID","physics","addBody","setPhysicsFromPosition","ents","getPositionData","__id","hasPosition","pdat","setPositionFromPhysics","backtrackRenderPos","removeBody","renderSystem","backtrackAmt","positionInCurrentTick","_tickRate","id","smoothed","cameraSmoothed","local","physState","posState","box","vel","velocity","out","sqrt","tr_arr","ldi_arr","tri_arr","step_arr","tDelta_arr","tNext_arr","vec_arr","normed_arr","base_arr","max_arr","left_arr","result_arr","getVoxel","dir","callback","noTranslate","epsilon","tr","ldi","tri","step","tDelta","tNext","normed","cumulative_t","max_t","axis","initSweep","stepForward","checkCollision","handleCollision","lead","leadEdgeToInt","trailEdgeToInt","Infinity","i_axis","stepx","stepy","stepz","done","left","dv","coord","sweep_impl","g","e","rcount","RED_SWEEP_QUEUE","pool","RED_SWEEP_INDEX","BLUE_SWEEP_QUEUE","BLUE_SWEEP_INDEX","COMMON_SWEEP_QUEUE","COMMON_SWEEP_INDEX","eventLength","SWEEP_EVENTS","sweepBipartite","visit","redStart","redEnd","red","redIndex","blueStart","blueEnd","blue","blueIndex","ptr","elemSize","istart","iend","redOffset","blueOffset","isort","redActive","blueActive","sqPop","retval","sqPush","sweepComplete","commonActive","color","scanBipartite","flip","redShift","blueShift","isRed","blueId","bluePtr","b0","b1","red_loop","oidx","redPtr","k","redId","scanComplete","INIT_CAPACITY","queue","item","top","predicate","fargs","split","reads","indexOf","replace","tempA","tempB","cosine","acos","a0","a1","a2","b2","ax","ay","az","bx","bz","PI","zScale","cos","sin","q","qx","qy","qz","qw","ix","iy","iz","iw","py","pz","sc","cc","px","fn","obj","readFloatLE","isSlowBuffer","_isBuffer","origin","direction","max_d","hit_pos","hit_norm","dx","dy","dz","ds","txDelta","tyDelta","tzDelta","txMax","tyMax","tzMax","steppedIndex","traceRay_impl","util","domready","vkey","invert","uniq","bsearch","addMouseWheel","hrtime","filtered_vkey","charAt","substring","parseInt","keyNames","virtualKeyCode","eq","physicalKeyCode","GameShell","_curKeyState","_pressCount","_releaseCount","_tickInterval","_rafHandle","_lastTick","_frameTime","_paused","_width","_height","_wantFullscreen","_wantPointerLock","_fullscreenActive","_pointerLockActive","_rafFunction","tickOrRender","preventDefaults","stopPropagation","element","bindings","frameSkip","tickCount","frameCount","startTime","tickTime","frameTime","stickyFullscreen","stickyPointerLock","scroll","mouseX","mouseY","prevMouseX","prevMouseY","inherits","lookupCount","kc","tryFullscreen","shell","elem","requestFullscreen","requestFullScreen","webkitRequestFullscreen","webkitRequestFullScreen","mozRequestFullscreen","mozRequestFullScreen","requestPointerLock","webkitRequestPointerLock","mozRequestPointerLock","msRequestPointerLock","oRequestPointerLock","virtual_key","physical_key","keybinds","unbind","down","lookupKey","wasDown","press","up","wasUp","release","setInterval","requestAnimationFrame","clearInterval","cancelFullscreen","document","exitFullscreen","cancelFullScreen","webkitCancelFullscreen","webkitCancelFullScreen","mozCancelFullscreen","mozCancelFullScreen","handleFullscreen","fullscreen","mozFullScreen","webkitIsFullScreen","exitPointerLock","webkitExitPointerLock","mozExitPointerLock","handlePointerLockChange","event","pointerLockElement","mozPointerLockElement","webkitPointerLockElement","setKeyState","doRender","skip","pCount","rCount","tick","render","handleEvent","ev","preventDefault","handleKeyUp","keyCode","char","which","charCode","handleKeyDown","activeElement","isFocused","metaKey","handleBlur","clientWidth","clientHeight","mouseCodes","handleMouseMove","movementX","mozMovementX","webkitMovementX","movementY","mozMovementY","webkitMovementY","clientX","offsetLeft","clientY","offsetTop","handleMouseDown","button","handleMouseUp","handleMouseEnter","handleMouseLeave","buttons","setMouseButtons","handleMouseWheel","deltaMode","deltaX","deltaY","deltaZ","handleContexMenu","handleResizeElement","h","makeDefaultContainer","container","createElement","tabindex","style","right","bottom","overflow","appendChild","options","useFullscreen","usePointerLock","pointerLock","tickRate","sticky","setTimeout","querySelector","getElementById","getElementByClass","handleResize","MutationObserver","observe","attributes","subtree","addEventListener","oncontextmenu","leave","blur","fullscreenChange","pointerLockChange","paused","getOwnPropertyDescriptors","descriptors","formatRegExp","format","f","isString","objects","inspect","str","JSON","stringify","_","isNull","isObject","deprecate","msg","process","noDeprecation","throwDeprecation","traceDeprecation","trace","debugEnviron","debugs","opts","ctx","seen","stylize","stylizeNoColor","colors","isBoolean","showHidden","_extend","isUndefined","customInspect","stylizeWithColor","formatValue","styleType","styles","recurseTimes","isFunction","primitive","simple","isNumber","formatPrimitive","visibleKeys","hash","val","arrayToHash","isError","formatError","isRegExp","RegExp","isDate","Date","output","braces","toUTCString","formatProperty","match","formatArray","reduce","prev","cur","numLinesEst","reduceToSingleString","line","substr","ar","re","objectToString","pad","debuglog","env","NODE_DEBUG","toUpperCase","test","pid","isNullOrUndefined","isSymbol","isPrimitive","months","timestamp","time","getHours","getMinutes","getSeconds","getDate","getMonth","prop","log","kCustomPromisifiedSymbol","callbackifyOnRejected","reason","cb","newReason","promisify","original","writable","configurable","promiseResolve","promiseReject","promise","defineProperties","custom","callbackify","callbackified","maybeCb","self","then","nextTick","rej","cachedSetTimeout","cachedClearTimeout","defaultSetTimout","defaultClearTimeout","runTimeout","fun","clearTimeout","currentQueue","draining","queueIndex","cleanUpNextTick","drainQueue","timeout","run","marker","runClearTimeout","Item","noop","title","browser","argv","version","versions","binding","cwd","chdir","umask","fill","readUInt8","superCtor","super_","TempCtor","fns","doc","hack","loaded","documentElement","doScroll","readyState","removeEventListener","ua","navigator","userAgent","isOSX","isOpera","maybeFirefox","0","2","3","4","5","6","8","9","12","13","16","17","18","19","20","21","23","24","25","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","91","92","93","95","106","107","108","109","110","111","144","145","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","186","187","188","189","190","191","192","219","220","221","222","223","224","226","229","231","246","247","248","249","250","251","252","253","254","fromCharCode","compare","sorted","unique_pred","unique_eq","compileSearch","funcName","reversed","extraArgs","useNdarray","earlyOut","compileBoundsSearch","suffix","ge","gt","lt","le","lastTime","vendors","cancelAnimationFrame","currTime","getTime","timeToCall","_addEventListener","support","prefix","_addWheelListener","eventName","useCapture","originalEvent","srcElement","delatZ","returnValue","wheelDelta","wheelDeltaX","detail","onmousewheel","performance","now","webkitNow","Inputs","allowContextMenu","disabled","scrollx","scrolly","scrollz","_keybindmap","_keyStates","_bindPressCounts","_ignoreMousemoveOnce","initEvents","onKeyEvent","inputs","handleKeyEvent","onMouseEvent","onContextMenu","onMouseMove","xy","touch","changedTouches","identifier","lastTouchID","res","lastTouchX","lastTouchY","getTouchMovement","domElement","onTouchStart","onMouseWheel","onLockChange","vkeyCode","getBoundKeys","innerHeight","keycode","vcode","XOR","handleBindingEvent","ct","sweep","RigidBody","testSolid","testFluid","Physics","defaults","gravity","minBounceImpulse","airDrag","fluidDrag","fluidDensity","bodies","_aabb","mass","friction","restitution","gravMult","onCollide","impacts","oldResting","noGravity","resting","_forces","_impulses","localNoGrav","gravityMultiplier","_sleepFrameCount","isResting","gmult","sleepVec","bodyAsleep","cx","cz","inFluid","ratioInFluid","submerged","cy","displaced","_fluidVec","applyForce","applyFluidForces","sanityCheck","applyFrictionByAxis","drag","mult","autoStep","cloneAABB","tmpBox","processCollisions","oldBox","xBlocked","zBlocked","ratio","targetPos","getVoxels","ydist","upvec","collided","leftover","tmpResting","onStep","tryAutoStepping","applyImpulse","_markActive","iterateBody","dvel","restDir","vNormal","lateralVel","vCurr","dvMax","scaler","tgt","src","_ratioInFluid","getPosition","atRestX","atRestY","atRestZ","ECS","components","comps","UID","storage","systems","renderSystems","deferredEntityRemovals","deferredCompRemovals","deferredMultiCompRemovals","deleteEntityNow","compName","removeComponentNow","def","multi","DataStore","remove","removeMultiCompNow","stateObj","statesArr","makeDeferralTimeout","deferralTimeoutPending","runAllDeferredRemovals","_storage","_systems","_renderSystems","createEntity","compList","addComponent","deleteEntity","immediately","createComponent","compDefn","internalDef","deleteComponent","removeComponent","pendingRemoval","doDeferredComponentRemovals","newState","hasComponent","getState","getStatesList","getStateAccessor","getComponentAccessor","removeMultiComponent","stateToRemove","ecs","doDeferredMultiComponentRemovals","doDeferredEntityRemovals","_map","movedItem","movedID","webpackContext","req","webpackContextResolve","boxIntersect","intervals","cylinder","collideBits","collideMask","dat","stateA","stateB","intervalA","intervalB","rada","radb","radsum","cylinderCylinderTest","cylinderBoxTest","cylindricalHitTest","idA","idB","onPairwiseEntityCollision","cyl","cube","rad","clamp","lo","hi","arg0","arg1","arg2","intersectFullArray","intersectBipartiteArray","RESULT","boxIntersectIter","boxEmpty","convertBoxes","boxes","ids","full","redList","redIds","blueList","blueIds","appendItem","dupe_number","dupe_array","base64","ieee754","kMaxLength","TYPED_ARRAY_SUPPORT","createBuffer","encodingOrOffset","allocUnsafe","from","byteOffset","fromArrayLike","fromArrayBuffer","string","encoding","isEncoding","actual","write","fromString","checked","fromObject","assertSize","size","isView","loweredCase","utf8ToBytes","base64ToBytes","toLowerCase","slowToString","start","end","hexSlice","utf8Slice","asciiSlice","latin1Slice","base64Slice","utf16leSlice","swap","bidirectionalIndexOf","arrayIndexOf","lastIndexOf","indexSize","arrLength","valLength","read","buf","readUInt16BE","foundIndex","found","hexWrite","remaining","strLen","parsed","utf8Write","blitBuffer","asciiWrite","byteArray","charCodeAt","asciiToBytes","latin1Write","base64Write","ucs2Write","units","utf16leToBytes","fromByteArray","secondByte","thirdByte","fourthByte","tempCodePoint","firstByte","codePoint","bytesPerSequence","codePoints","decodeCodePointsArray","SlowBuffer","alloc","INSPECT_MAX_BYTES","foo","subarray","typedArraySupport","poolSize","_augment","species","allocUnsafeSlow","swap16","swap32","swap64","thisStart","thisEnd","thisCopy","targetCopy","includes","isFinite","toJSON","_arr","toHex","bytes","checkOffset","checkInt","objectWriteUInt16","littleEndian","objectWriteUInt32","checkIEEE754","writeFloat","noAssert","writeDouble","newBuf","sliceLen","readUIntLE","readUIntBE","readUInt16LE","readUInt32LE","readUInt32BE","readIntLE","pow","readIntBE","readInt8","readInt16LE","readInt16BE","readInt32LE","readInt32BE","readFloatBE","readDoubleLE","readDoubleBE","writeUIntLE","writeUIntBE","writeUInt8","writeUInt16LE","writeUInt16BE","writeUInt32LE","writeUInt32BE","writeIntLE","limit","writeIntBE","writeInt8","writeInt16LE","writeInt16BE","writeInt32LE","writeInt32BE","writeFloatLE","writeFloatBE","writeDoubleLE","writeDoubleBE","targetStart","INVALID_BASE64_RE","leadSurrogate","toByteArray","trim","stringtrim","base64clean","dst","b64","lens","getLens","validLen","placeHoldersLen","tmp","Arr","_byteLength","curByte","revLookup","uint8","extraBytes","parts","len2","encodeChunk","lookup","num","isLE","mLen","nBytes","eLen","eMax","eBias","nBits","NaN","rt","LN2","n0","insertionSort","quickSort","sixth","index1","index5","index3","index2","index4","el1","el2","el3","el4","el5","less","great","pivot1X","pivot1Y","pivot2X","pivot2Y","ptr0","ptr2","ptr4","ptr5","ptr6","ptr7","i1","move","comparePivot","rotate","shufflePivot","jptr","initFull","xSize","xBoxes","xIndex","ySize","yBoxes","yIndex","levels","maxInts","BOX_ISTACK","maxDoubles","BOX_DSTACK","iterInit","iterPush","iptr","dptr","partitionStartLessThan","partitionEndLessThanEqual","redCount","blueCount","bruteForcePartial","red0","partitionInteriorContainsInterval","bruteForceFull","blue0","findMedian","mid","blue1","partitionStartEqual","onePointFull","onePointPartial","red1","partitionContainsPoint","redX","partitionContainsPointProper","bruteForce","partial","genPartition","blueX","r0","r1","ARGS","bruteForcePlanner","invoke","redMajor","redLoop","blueLoop","generateBruteForce","codeStr","proc","pivot","pivot0","value0","pivot1","value1","pivot2","value2","aPtr","bPtr","boxPtr","entities","hasPhysics","getPhysicsBody","impulse","getCollideTerrain","cutoff","_showing","zoom","camera","currentZoom","hasMesh","getMeshData","mesh","visibility","checkZoom","entity","onTargetMissing","updatePosition","updateRenderPosition","other","names","followsEntity","posDat","rendering","addMeshToScene","rpos","copyFromFloats","dispose","heading","running","jumping","maxSpeed","moveForce","responsiveness","runningFriction","standingFriction","airMoveMult","jumpImpulse","jumpForce","jumpTime","airJumps","_jumpCount","_isJumping","_currjumptime","onGround","canjump","jf","tempvec","tempvec2","speed","zeroVec","pushLen","canPush","pushAmt","applyMovementPhysics","inputState","camHeading","jump","fb","forward","backward","rl","setMovementState","getMovement","shadowDist","scene","getScene","disc","CreateDisc","rotation","material","makeStandardMaterial","diffuseColor","Black","ambientColor","alpha","setEnabled","removeMesh","_mesh","createInstance","cpos","_localGetPosition","getPhysics","physDat","camPos","localY","_localPick","shadowPos","scaling","updateShadowHeight","spos","createGameShell","Container","_noa","createContainerDiv","canvas","el","insertBefore","firstChild","getOrCreateCanvas","_shell","createShell","hasPointerLock","supportsPointerLock","pointerInGame","hasFocus","lockChange","detectPointerLock","onShellInit","resize","lastRAF","tickAccum","onAnimationFrame","t0","maxTicks","t1","renderPt","framePart","setupTimingEvents","removeUnorderedListItem","loopForTime","maxTimeInMS","appendTo","htmlElement","setPointerLock","lock","prevRad","prevAnswer","copyNdarrayContents","tgtPos","i0","j0","k0","si","sj","sk","ti","tj","tk","six","tix","doNdarrayCopy","doNdarrayZero","StringList","isEmpty","empty","keyToDistanceFn","mapping","copyFrom","glvec3","showFPS","antiAlias","clearColor","lightDiffuse","lightSpecular","groundLightColor","useAO","AOmultipliers","reverseAOmultiplier","preserveDrawingBuffer","Rendering","aoVals","revAoVal","meshingCutoffTime","_resizeDebounce","_engine","_scene","detachControl","_addComponent","_octree","$","blocks","_selectionOctree","_cameraHolder","_camera","parent","minZ","_camScreen","CreatePlane","_camScreenMat","_camLocBlock","lightVec","arrToColor","_light","diffuse","specular","groundColor","flatMaterial","initScene","longest","last","fps_hook","nt","fps","innerHTML","setUpFPS","profile_hook","cam","tgtLoc","_localGetTargetPosition","pitch","cloc","getBlock","matId","registry","getBlockFaceMaterial","matData","getMaterialData","col","checkCameraEffect","updateCameraForRender","beginFrame","endFrame","pendingResize","highlightBlockFace","show","posArr","normArr","_highlightMesh","hlm","backFaceCulling","emissiveColor","lines","CreateLines","getHighlightMesh","hlpos","slop","isStatic","_containingChunk","_noaContainingChunk","dynamicContent","addToOctree","chunk","world","_getChunkByCoords","octreeBlock","entries","freezeWorldMatrix","freezeNormals","remover","removeMeshFromScene","onDisposeObservable","mat","specularColor","prepareChunkForRendering","cs","loc","disposeChunkForRendering","_rebaseOrigin","delta","dvec","meshes","subtractInPlace","_isWorldMatrixFrozen","markAsDirty","minPoint","maxPoint","_boundingVectors","debug_SceneCheck","dyns","octs","numOcts","numSubs","mats","materials","allmats","subMaterials","block","_isDisposed","getIndices","missing","subMeshes","unusedMats","used","avgPerOct","list1","list2","debug_MeshCount","greedyMesher","GreedyMesher","meshBuilder","MeshBuilder","meshChunk","matGetter","colGetter","ignoreMaterials","cols","_getMaterialVertexColor","ao","vals","rev","voxels","cachedPadded","s2","_vecs","posValues","sizeValues","tgtPosValues","_cachedVecSize","allocateVectors","nab","_neighbors","buildPaddedVoxelArray","edgesOnly","isFull","build","Submesh","positions","normals","uvs","mergeable","mergeSubmeshes","meshDataList","mergeAll","vertices","matIDs","mdat","indexOffset","mergeArrays","numMergeable","url","getMaterialTexture","renderMat","results","submesh","verts","inds","vdat","applyToMesh","multiMat","vertStart","indStart","buildMeshFromSubmesh","matID","ignore","materialCache","tex","NEAREST_SAMPLINGMODE","textureAlpha","hasAlpha","diffuseTexture","makeTerrainMaterial","getTerrainMaterial","maskCache","aomaskCache","aoPackFunction","solidLookup","_solidityLookup","opacityLookup","_opacityLookup","constructMeshMasks","arrT","getMaterial","aomask","materialDir","dbase","istride","jstride","kstride","d0","id0","id1","faceDir","getFaceDir","op0","op1","m0","m1","constructMeshDataFromMasks","u","len1","doAO","submeshes","getColor","aoValues","du","norms","maskCompareFcn","maskCompare","maskCompare_noAO","meshColorFcn","pushMeshColors","pushMeshColors_noAO","maskVal","OUTER","triDir","vs","hx","wx","aoVal","ao00","unpackAOMask","ao10","ao11","ao01","pushAOColor","packAOMaskNoReverse","ipos","ineg","a00","a01","a10","a11","packAOMask","jpos","kpos","baseCol","skipReverseAO","transpose","len0","buildSPSforMaterialIndex","meshHash","blockHash","_objectBlocks","sps","updatable","blockHandlerLookup","_blockHandlerLookup","objectMeshLookup","_blockMeshLookup","blockID","handlerFn","blockArr","handlers","onCustomMeshCreate","addShape","positionFunction","particle","partIndex","shapeIndex","initChunk","_objectSystems","disposeChunk","removeObjectMeshes","addObjectBlock","ObjMeshDat","removeObjectBlock","buildObjectMeshes","matIndexes","matIndex","merged","buildMesh","opaqueLookup","objectLookup","Chunk","dataArray","requestID","isDisposed","_terrainDirty","_objectsDirty","_objectLookup","_terrainMesh","objectMesher","narr","_neighborCount","_maxMeshedNeighbors","_timesMeshed","scanVoxelData","callBlockHandler","affectsTerrain","fullyOpaque","fullyAir","hasObj","handlerLookup","callAllBlockHandlers","_createVoxelArray","_updateVoxelArray","getSolidityAt","newID","oldID","oldIDnum","_queueChunkForRemesh","SOchanged","edge","iedge","jedge","kedge","js","ks","ignoreMats","updateMeshes","defaultOptions","chunkSize","chunkAddDistance","chunkRemoveDistance","worldGenWhilePaused","manuallyControlChunkLoading","World","playerChunkLoaded","minNeighborsToMesh","maxChunksPendingCreation","maxChunksPendingMeshing","maxProcessingPerTick","maxProcessingPerRender","_cachedWorldName","_lastPlayerChunkID","_chunkStorage","_chunkIDsKnown","_chunkIDsToRequest","_chunkIDsPending","_chunkIDsToMesh","_chunkIDsToMeshFirst","_chunkIDsToRemove","queueChunkForRemesh","_getChunk","_setChunk","getChunkID","_worldCoordsToChunkCoords","initChunkStorage","_worldCoordToChunkCoord","_worldCoordToChunkIndex","_worldCoordsToChunkIndexes","getBlockID","getBlockSolidity","getBlockOpacity","getBlockFluidity","getBlockProperties","getBlockProps","getBlockObjectMesh","getObjectMeshAt","setBlockID","isBoxUnobstructed","setChunkData","userData","reqID","worldName","updateNeighborsOfChunk","profile_queues_hook","invalidateVoxelsInAABB","parseChunkID","invalidateChunksInBox","manuallyLoadChunk","manualErr","manuallyUnloadChunk","getPlayerChunkCoords","playerEntity","tickStartTime","sortIDListByDistanceFrom","markAllChunksForRemoval","ci","cj","ck","remDistSq","toRemove","chunkID","changedChunks","di","dj","dk","numChunks","rsq","numberOfVoxelsInSphere","addDistSq","known","toRequest","findNewChunksInRange","pending","toMesh","dataArr","requestNewChunk","processRequestQueue","removeChunk","processRemoveQueue","processMeshingQueue","numQueued","lookIndex","nc","lookForChunksToMesh","pChunk","firstOnly","doChunkRemesh","nid","neighbor","_report","exist","surrounded","remeshes","padEnd","sum","acc","toFixed","report","createInputs","defaultBindings","makeInputs","createPhysics","fluidLookup","_fluidityLookup","makePhysics","inverseX","inverseY","sensitivityX","sensitivityY","initialZoom","zoomSpeed","Camera","cameraTarget","eyeOffset","zoomDistance","_dirVector","_camPos","getTargetPosition","localToGlobal","globalCamPos","getDirection","applyInputsToCamera","wval","hval","badx","lastx","bady","lasty","bugFix","conv","twopi","maxPitch","updateBeforeEntityRenderSystems","updateAfterEntityRenderSystems","maxZoom","_camBox","_camBoxVec","_getVoxel","_sweepVec","_hitFn","cameraObstructionDistance","texturePath","blockDefaults","solid","opaque","viscosity","Registry","blockSolidity","blockOpacity","blockIsFluid","blockIsObject","blockMats","blockProps","blockMeshes","blockHandlers","registerBlock","_options","fluid","blockMesh","getMaterialId","hasHandler","onLoad","onUnload","onSet","onUnset","BlockCallbackHolder","registerMaterial","textureURL","texHasAlpha","renderMaterial","texture","blockId","getMaterialColor","white","reg","lazyInit","EntComp","shadowDistance","Entities","componentArgs","reqContext","bareName","exec","compFn","default","compDef","comp","isPlayer","smoothCamera","getPos","updateDerivedPositionData","getPhys","_localSetPosition","_yarg","_zarg","setEntitySize","xs","ys","zs","movement","collideTerrain","getCollideEntities","collideEntities","id2","extentsOverlap","extA","extB","addComponentAgain","isTerrainBlocked","xlocal","ylocal","zlocal","blockExt","getEntitiesInAABB","withComponent","testExtents","entStates","hits","meshOffset","doPhysics","shadow","smoothName","raycast","debug","silent","playerHeight","playerWidth","playerStart","playerAutoStep","blockTestDistance","dragCameraOutsidePointerLock","skipDefaultHighlighting","originRebaseDistance","Engine","_lastRenderTime","_dragOutsideLock","debugstr","_originRebaseDistance","receivesInputs","fadeOnZoom","ver","dep","blockTargetIdCheck","targetedBlock","defaultBlockHighlightFunction","normal","ndarray","setViewDistance","throwFn","checkWorldOffset","newhash","blockIdFn","_targetedBlockDat","adjacent","_prevTargetHash","updateBlockTargets","st","profile_hook_render","fire","globalPrecise","floored","setPaused","setBlock","addBlock","pick","blockIdTestFunction","_pickPos","testFn","_hitResult","rnorm","dirtID","grassID","getVoxelID","voxelID","player","CreateBox"],"mappings":"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","file":"bundle.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t1: 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([185,0]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n});\r\n\r\nexport function __exportStar(m, o) {\r\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(o, p)) __createBinding(o, m, p);\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nvar __setModuleDefault = Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, privateMap) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to get private field on non-instance\");\r\n    }\r\n    return privateMap.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, privateMap, value) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to set private field on non-instance\");\r\n    }\r\n    privateMap.set(receiver, value);\r\n    return value;\r\n}\r\n","module.exports = {\n  EPSILON: require('./epsilon')\n  , create: require('./create')\n  , clone: require('./clone')\n  , angle: require('./angle')\n  , fromValues: require('./fromValues')\n  , copy: require('./copy')\n  , set: require('./set')\n  , equals: require('./equals')\n  , exactEquals: require('./exactEquals')\n  , add: require('./add')\n  , subtract: require('./subtract')\n  , sub: require('./sub')\n  , multiply: require('./multiply')\n  , mul: require('./mul')\n  , divide: require('./divide')\n  , div: require('./div')\n  , min: require('./min')\n  , max: require('./max')\n  , floor: require('./floor')\n  , ceil: require('./ceil')\n  , round: require('./round')\n  , scale: require('./scale')\n  , scaleAndAdd: require('./scaleAndAdd')\n  , distance: require('./distance')\n  , dist: require('./dist')\n  , squaredDistance: require('./squaredDistance')\n  , sqrDist: require('./sqrDist')\n  , length: require('./length')\n  , len: require('./len')\n  , squaredLength: require('./squaredLength')\n  , sqrLen: require('./sqrLen')\n  , negate: require('./negate')\n  , inverse: require('./inverse')\n  , normalize: require('./normalize')\n  , dot: require('./dot')\n  , cross: require('./cross')\n  , lerp: require('./lerp')\n  , random: require('./random')\n  , transformMat4: require('./transformMat4')\n  , transformMat3: require('./transformMat3')\n  , transformQuat: require('./transformQuat')\n  , rotateX: require('./rotateX')\n  , rotateY: require('./rotateY')\n  , rotateZ: require('./rotateZ')\n  , forEach: require('./forEach')\n}\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n'use strict';\n\nvar R = typeof Reflect === 'object' ? Reflect : null\nvar ReflectApply = R && typeof R.apply === 'function'\n  ? R.apply\n  : function ReflectApply(target, receiver, args) {\n    return Function.prototype.apply.call(target, receiver, args);\n  }\n\nvar ReflectOwnKeys\nif (R && typeof R.ownKeys === 'function') {\n  ReflectOwnKeys = R.ownKeys\n} else if (Object.getOwnPropertySymbols) {\n  ReflectOwnKeys = function ReflectOwnKeys(target) {\n    return Object.getOwnPropertyNames(target)\n      .concat(Object.getOwnPropertySymbols(target));\n  };\n} else {\n  ReflectOwnKeys = function ReflectOwnKeys(target) {\n    return Object.getOwnPropertyNames(target);\n  };\n}\n\nfunction ProcessEmitWarning(warning) {\n  if (console && console.warn) console.warn(warning);\n}\n\nvar NumberIsNaN = Number.isNaN || function NumberIsNaN(value) {\n  return value !== value;\n}\n\nfunction EventEmitter() {\n  EventEmitter.init.call(this);\n}\nmodule.exports = EventEmitter;\nmodule.exports.once = once;\n\n// Backwards-compat with node 0.10.x\nEventEmitter.EventEmitter = EventEmitter;\n\nEventEmitter.prototype._events = undefined;\nEventEmitter.prototype._eventsCount = 0;\nEventEmitter.prototype._maxListeners = undefined;\n\n// By default EventEmitters will print a warning if more than 10 listeners are\n// added to it. This is a useful default which helps finding memory leaks.\nvar defaultMaxListeners = 10;\n\nfunction checkListener(listener) {\n  if (typeof listener !== 'function') {\n    throw new TypeError('The \"listener\" argument must be of type Function. Received type ' + typeof listener);\n  }\n}\n\nObject.defineProperty(EventEmitter, 'defaultMaxListeners', {\n  enumerable: true,\n  get: function() {\n    return defaultMaxListeners;\n  },\n  set: function(arg) {\n    if (typeof arg !== 'number' || arg < 0 || NumberIsNaN(arg)) {\n      throw new RangeError('The value of \"defaultMaxListeners\" is out of range. It must be a non-negative number. Received ' + arg + '.');\n    }\n    defaultMaxListeners = arg;\n  }\n});\n\nEventEmitter.init = function() {\n\n  if (this._events === undefined ||\n      this._events === Object.getPrototypeOf(this)._events) {\n    this._events = Object.create(null);\n    this._eventsCount = 0;\n  }\n\n  this._maxListeners = this._maxListeners || undefined;\n};\n\n// Obviously not all Emitters should be limited to 10. This function allows\n// that to be increased. Set to zero for unlimited.\nEventEmitter.prototype.setMaxListeners = function setMaxListeners(n) {\n  if (typeof n !== 'number' || n < 0 || NumberIsNaN(n)) {\n    throw new RangeError('The value of \"n\" is out of range. It must be a non-negative number. Received ' + n + '.');\n  }\n  this._maxListeners = n;\n  return this;\n};\n\nfunction _getMaxListeners(that) {\n  if (that._maxListeners === undefined)\n    return EventEmitter.defaultMaxListeners;\n  return that._maxListeners;\n}\n\nEventEmitter.prototype.getMaxListeners = function getMaxListeners() {\n  return _getMaxListeners(this);\n};\n\nEventEmitter.prototype.emit = function emit(type) {\n  var args = [];\n  for (var i = 1; i < arguments.length; i++) args.push(arguments[i]);\n  var doError = (type === 'error');\n\n  var events = this._events;\n  if (events !== undefined)\n    doError = (doError && events.error === undefined);\n  else if (!doError)\n    return false;\n\n  // If there is no 'error' event listener then throw.\n  if (doError) {\n    var er;\n    if (args.length > 0)\n      er = args[0];\n    if (er instanceof Error) {\n      // Note: The comments on the `throw` lines are intentional, they show\n      // up in Node's output if this results in an unhandled exception.\n      throw er; // Unhandled 'error' event\n    }\n    // At least give some kind of context to the user\n    var err = new Error('Unhandled error.' + (er ? ' (' + er.message + ')' : ''));\n    err.context = er;\n    throw err; // Unhandled 'error' event\n  }\n\n  var handler = events[type];\n\n  if (handler === undefined)\n    return false;\n\n  if (typeof handler === 'function') {\n    ReflectApply(handler, this, args);\n  } else {\n    var len = handler.length;\n    var listeners = arrayClone(handler, len);\n    for (var i = 0; i < len; ++i)\n      ReflectApply(listeners[i], this, args);\n  }\n\n  return true;\n};\n\nfunction _addListener(target, type, listener, prepend) {\n  var m;\n  var events;\n  var existing;\n\n  checkListener(listener);\n\n  events = target._events;\n  if (events === undefined) {\n    events = target._events = Object.create(null);\n    target._eventsCount = 0;\n  } else {\n    // To avoid recursion in the case that type === \"newListener\"! Before\n    // adding it to the listeners, first emit \"newListener\".\n    if (events.newListener !== undefined) {\n      target.emit('newListener', type,\n                  listener.listener ? listener.listener : listener);\n\n      // Re-assign `events` because a newListener handler could have caused the\n      // this._events to be assigned to a new object\n      events = target._events;\n    }\n    existing = events[type];\n  }\n\n  if (existing === undefined) {\n    // Optimize the case of one listener. Don't need the extra array object.\n    existing = events[type] = listener;\n    ++target._eventsCount;\n  } else {\n    if (typeof existing === 'function') {\n      // Adding the second element, need to change to array.\n      existing = events[type] =\n        prepend ? [listener, existing] : [existing, listener];\n      // If we've already got an array, just append.\n    } else if (prepend) {\n      existing.unshift(listener);\n    } else {\n      existing.push(listener);\n    }\n\n    // Check for listener leak\n    m = _getMaxListeners(target);\n    if (m > 0 && existing.length > m && !existing.warned) {\n      existing.warned = true;\n      // No error code for this since it is a Warning\n      // eslint-disable-next-line no-restricted-syntax\n      var w = new Error('Possible EventEmitter memory leak detected. ' +\n                          existing.length + ' ' + String(type) + ' listeners ' +\n                          'added. Use emitter.setMaxListeners() to ' +\n                          'increase limit');\n      w.name = 'MaxListenersExceededWarning';\n      w.emitter = target;\n      w.type = type;\n      w.count = existing.length;\n      ProcessEmitWarning(w);\n    }\n  }\n\n  return target;\n}\n\nEventEmitter.prototype.addListener = function addListener(type, listener) {\n  return _addListener(this, type, listener, false);\n};\n\nEventEmitter.prototype.on = EventEmitter.prototype.addListener;\n\nEventEmitter.prototype.prependListener =\n    function prependListener(type, listener) {\n      return _addListener(this, type, listener, true);\n    };\n\nfunction onceWrapper() {\n  if (!this.fired) {\n    this.target.removeListener(this.type, this.wrapFn);\n    this.fired = true;\n    if (arguments.length === 0)\n      return this.listener.call(this.target);\n    return this.listener.apply(this.target, arguments);\n  }\n}\n\nfunction _onceWrap(target, type, listener) {\n  var state = { fired: false, wrapFn: undefined, target: target, type: type, listener: listener };\n  var wrapped = onceWrapper.bind(state);\n  wrapped.listener = listener;\n  state.wrapFn = wrapped;\n  return wrapped;\n}\n\nEventEmitter.prototype.once = function once(type, listener) {\n  checkListener(listener);\n  this.on(type, _onceWrap(this, type, listener));\n  return this;\n};\n\nEventEmitter.prototype.prependOnceListener =\n    function prependOnceListener(type, listener) {\n      checkListener(listener);\n      this.prependListener(type, _onceWrap(this, type, listener));\n      return this;\n    };\n\n// Emits a 'removeListener' event if and only if the listener was removed.\nEventEmitter.prototype.removeListener =\n    function removeListener(type, listener) {\n      var list, events, position, i, originalListener;\n\n      checkListener(listener);\n\n      events = this._events;\n      if (events === undefined)\n        return this;\n\n      list = events[type];\n      if (list === undefined)\n        return this;\n\n      if (list === listener || list.listener === listener) {\n        if (--this._eventsCount === 0)\n          this._events = Object.create(null);\n        else {\n          delete events[type];\n          if (events.removeListener)\n            this.emit('removeListener', type, list.listener || listener);\n        }\n      } else if (typeof list !== 'function') {\n        position = -1;\n\n        for (i = list.length - 1; i >= 0; i--) {\n          if (list[i] === listener || list[i].listener === listener) {\n            originalListener = list[i].listener;\n            position = i;\n            break;\n          }\n        }\n\n        if (position < 0)\n          return this;\n\n        if (position === 0)\n          list.shift();\n        else {\n          spliceOne(list, position);\n        }\n\n        if (list.length === 1)\n          events[type] = list[0];\n\n        if (events.removeListener !== undefined)\n          this.emit('removeListener', type, originalListener || listener);\n      }\n\n      return this;\n    };\n\nEventEmitter.prototype.off = EventEmitter.prototype.removeListener;\n\nEventEmitter.prototype.removeAllListeners =\n    function removeAllListeners(type) {\n      var listeners, events, i;\n\n      events = this._events;\n      if (events === undefined)\n        return this;\n\n      // not listening for removeListener, no need to emit\n      if (events.removeListener === undefined) {\n        if (arguments.length === 0) {\n          this._events = Object.create(null);\n          this._eventsCount = 0;\n        } else if (events[type] !== undefined) {\n          if (--this._eventsCount === 0)\n            this._events = Object.create(null);\n          else\n            delete events[type];\n        }\n        return this;\n      }\n\n      // emit removeListener for all listeners on all events\n      if (arguments.length === 0) {\n        var keys = Object.keys(events);\n        var key;\n        for (i = 0; i < keys.length; ++i) {\n          key = keys[i];\n          if (key === 'removeListener') continue;\n          this.removeAllListeners(key);\n        }\n        this.removeAllListeners('removeListener');\n        this._events = Object.create(null);\n        this._eventsCount = 0;\n        return this;\n      }\n\n      listeners = events[type];\n\n      if (typeof listeners === 'function') {\n        this.removeListener(type, listeners);\n      } else if (listeners !== undefined) {\n        // LIFO order\n        for (i = listeners.length - 1; i >= 0; i--) {\n          this.removeListener(type, listeners[i]);\n        }\n      }\n\n      return this;\n    };\n\nfunction _listeners(target, type, unwrap) {\n  var events = target._events;\n\n  if (events === undefined)\n    return [];\n\n  var evlistener = events[type];\n  if (evlistener === undefined)\n    return [];\n\n  if (typeof evlistener === 'function')\n    return unwrap ? [evlistener.listener || evlistener] : [evlistener];\n\n  return unwrap ?\n    unwrapListeners(evlistener) : arrayClone(evlistener, evlistener.length);\n}\n\nEventEmitter.prototype.listeners = function listeners(type) {\n  return _listeners(this, type, true);\n};\n\nEventEmitter.prototype.rawListeners = function rawListeners(type) {\n  return _listeners(this, type, false);\n};\n\nEventEmitter.listenerCount = function(emitter, type) {\n  if (typeof emitter.listenerCount === 'function') {\n    return emitter.listenerCount(type);\n  } else {\n    return listenerCount.call(emitter, type);\n  }\n};\n\nEventEmitter.prototype.listenerCount = listenerCount;\nfunction listenerCount(type) {\n  var events = this._events;\n\n  if (events !== undefined) {\n    var evlistener = events[type];\n\n    if (typeof evlistener === 'function') {\n      return 1;\n    } else if (evlistener !== undefined) {\n      return evlistener.length;\n    }\n  }\n\n  return 0;\n}\n\nEventEmitter.prototype.eventNames = function eventNames() {\n  return this._eventsCount > 0 ? ReflectOwnKeys(this._events) : [];\n};\n\nfunction arrayClone(arr, n) {\n  var copy = new Array(n);\n  for (var i = 0; i < n; ++i)\n    copy[i] = arr[i];\n  return copy;\n}\n\nfunction spliceOne(list, index) {\n  for (; index + 1 < list.length; index++)\n    list[index] = list[index + 1];\n  list.pop();\n}\n\nfunction unwrapListeners(arr) {\n  var ret = new Array(arr.length);\n  for (var i = 0; i < ret.length; ++i) {\n    ret[i] = arr[i].listener || arr[i];\n  }\n  return ret;\n}\n\nfunction once(emitter, name) {\n  return new Promise(function (resolve, reject) {\n    function eventListener() {\n      if (errorListener !== undefined) {\n        emitter.removeListener('error', errorListener);\n      }\n      resolve([].slice.call(arguments));\n    };\n    var errorListener;\n\n    // Adding an error listener is not optional because\n    // if an error is thrown on an event emitter we cannot\n    // guarantee that the actual event we are waiting will\n    // be fired. The result could be a silent way to create\n    // memory or file descriptor leaks, which is something\n    // we should avoid.\n    if (name !== 'error') {\n      errorListener = function errorListener(err) {\n        emitter.removeListener(name, eventListener);\n        reject(err);\n      };\n\n      emitter.once('error', errorListener);\n    }\n\n    emitter.once(name, eventListener);\n  });\n}\n","var iota = require(\"iota-array\")\nvar isBuffer = require(\"is-buffer\")\n\nvar hasTypedArrays  = ((typeof Float64Array) !== \"undefined\")\n\nfunction compare1st(a, b) {\n  return a[0] - b[0]\n}\n\nfunction order() {\n  var stride = this.stride\n  var terms = new Array(stride.length)\n  var i\n  for(i=0; i<terms.length; ++i) {\n    terms[i] = [Math.abs(stride[i]), i]\n  }\n  terms.sort(compare1st)\n  var result = new Array(terms.length)\n  for(i=0; i<result.length; ++i) {\n    result[i] = terms[i][1]\n  }\n  return result\n}\n\nfunction compileConstructor(dtype, dimension) {\n  var className = [\"View\", dimension, \"d\", dtype].join(\"\")\n  if(dimension < 0) {\n    className = \"View_Nil\" + dtype\n  }\n  var useGetters = (dtype === \"generic\")\n\n  if(dimension === -1) {\n    //Special case for trivial arrays\n    var code =\n      \"function \"+className+\"(a){this.data=a;};\\\nvar proto=\"+className+\".prototype;\\\nproto.dtype='\"+dtype+\"';\\\nproto.index=function(){return -1};\\\nproto.size=0;\\\nproto.dimension=-1;\\\nproto.shape=proto.stride=proto.order=[];\\\nproto.lo=proto.hi=proto.transpose=proto.step=\\\nfunction(){return new \"+className+\"(this.data);};\\\nproto.get=proto.set=function(){};\\\nproto.pick=function(){return null};\\\nreturn function construct_\"+className+\"(a){return new \"+className+\"(a);}\"\n    var procedure = new Function(code)\n    return procedure()\n  } else if(dimension === 0) {\n    //Special case for 0d arrays\n    var code =\n      \"function \"+className+\"(a,d) {\\\nthis.data = a;\\\nthis.offset = d\\\n};\\\nvar proto=\"+className+\".prototype;\\\nproto.dtype='\"+dtype+\"';\\\nproto.index=function(){return this.offset};\\\nproto.dimension=0;\\\nproto.size=1;\\\nproto.shape=\\\nproto.stride=\\\nproto.order=[];\\\nproto.lo=\\\nproto.hi=\\\nproto.transpose=\\\nproto.step=function \"+className+\"_copy() {\\\nreturn new \"+className+\"(this.data,this.offset)\\\n};\\\nproto.pick=function \"+className+\"_pick(){\\\nreturn TrivialArray(this.data);\\\n};\\\nproto.valueOf=proto.get=function \"+className+\"_get(){\\\nreturn \"+(useGetters ? \"this.data.get(this.offset)\" : \"this.data[this.offset]\")+\n\"};\\\nproto.set=function \"+className+\"_set(v){\\\nreturn \"+(useGetters ? \"this.data.set(this.offset,v)\" : \"this.data[this.offset]=v\")+\"\\\n};\\\nreturn function construct_\"+className+\"(a,b,c,d){return new \"+className+\"(a,d)}\"\n    var procedure = new Function(\"TrivialArray\", code)\n    return procedure(CACHED_CONSTRUCTORS[dtype][0])\n  }\n\n  var code = [\"'use strict'\"]\n\n  //Create constructor for view\n  var indices = iota(dimension)\n  var args = indices.map(function(i) { return \"i\"+i })\n  var index_str = \"this.offset+\" + indices.map(function(i) {\n        return \"this.stride[\" + i + \"]*i\" + i\n      }).join(\"+\")\n  var shapeArg = indices.map(function(i) {\n      return \"b\"+i\n    }).join(\",\")\n  var strideArg = indices.map(function(i) {\n      return \"c\"+i\n    }).join(\",\")\n  code.push(\n    \"function \"+className+\"(a,\" + shapeArg + \",\" + strideArg + \",d){this.data=a\",\n      \"this.shape=[\" + shapeArg + \"]\",\n      \"this.stride=[\" + strideArg + \"]\",\n      \"this.offset=d|0}\",\n    \"var proto=\"+className+\".prototype\",\n    \"proto.dtype='\"+dtype+\"'\",\n    \"proto.dimension=\"+dimension)\n\n  //view.size:\n  code.push(\"Object.defineProperty(proto,'size',{get:function \"+className+\"_size(){\\\nreturn \"+indices.map(function(i) { return \"this.shape[\"+i+\"]\" }).join(\"*\"),\n\"}})\")\n\n  //view.order:\n  if(dimension === 1) {\n    code.push(\"proto.order=[0]\")\n  } else {\n    code.push(\"Object.defineProperty(proto,'order',{get:\")\n    if(dimension < 4) {\n      code.push(\"function \"+className+\"_order(){\")\n      if(dimension === 2) {\n        code.push(\"return (Math.abs(this.stride[0])>Math.abs(this.stride[1]))?[1,0]:[0,1]}})\")\n      } else if(dimension === 3) {\n        code.push(\n\"var s0=Math.abs(this.stride[0]),s1=Math.abs(this.stride[1]),s2=Math.abs(this.stride[2]);\\\nif(s0>s1){\\\nif(s1>s2){\\\nreturn [2,1,0];\\\n}else if(s0>s2){\\\nreturn [1,2,0];\\\n}else{\\\nreturn [1,0,2];\\\n}\\\n}else if(s0>s2){\\\nreturn [2,0,1];\\\n}else if(s2>s1){\\\nreturn [0,1,2];\\\n}else{\\\nreturn [0,2,1];\\\n}}})\")\n      }\n    } else {\n      code.push(\"ORDER})\")\n    }\n  }\n\n  //view.set(i0, ..., v):\n  code.push(\n\"proto.set=function \"+className+\"_set(\"+args.join(\",\")+\",v){\")\n  if(useGetters) {\n    code.push(\"return this.data.set(\"+index_str+\",v)}\")\n  } else {\n    code.push(\"return this.data[\"+index_str+\"]=v}\")\n  }\n\n  //view.get(i0, ...):\n  code.push(\"proto.get=function \"+className+\"_get(\"+args.join(\",\")+\"){\")\n  if(useGetters) {\n    code.push(\"return this.data.get(\"+index_str+\")}\")\n  } else {\n    code.push(\"return this.data[\"+index_str+\"]}\")\n  }\n\n  //view.index:\n  code.push(\n    \"proto.index=function \"+className+\"_index(\", args.join(), \"){return \"+index_str+\"}\")\n\n  //view.hi():\n  code.push(\"proto.hi=function \"+className+\"_hi(\"+args.join(\",\")+\"){return new \"+className+\"(this.data,\"+\n    indices.map(function(i) {\n      return [\"(typeof i\",i,\"!=='number'||i\",i,\"<0)?this.shape[\", i, \"]:i\", i,\"|0\"].join(\"\")\n    }).join(\",\")+\",\"+\n    indices.map(function(i) {\n      return \"this.stride[\"+i + \"]\"\n    }).join(\",\")+\",this.offset)}\")\n\n  //view.lo():\n  var a_vars = indices.map(function(i) { return \"a\"+i+\"=this.shape[\"+i+\"]\" })\n  var c_vars = indices.map(function(i) { return \"c\"+i+\"=this.stride[\"+i+\"]\" })\n  code.push(\"proto.lo=function \"+className+\"_lo(\"+args.join(\",\")+\"){var b=this.offset,d=0,\"+a_vars.join(\",\")+\",\"+c_vars.join(\",\"))\n  for(var i=0; i<dimension; ++i) {\n    code.push(\n\"if(typeof i\"+i+\"==='number'&&i\"+i+\">=0){\\\nd=i\"+i+\"|0;\\\nb+=c\"+i+\"*d;\\\na\"+i+\"-=d}\")\n  }\n  code.push(\"return new \"+className+\"(this.data,\"+\n    indices.map(function(i) {\n      return \"a\"+i\n    }).join(\",\")+\",\"+\n    indices.map(function(i) {\n      return \"c\"+i\n    }).join(\",\")+\",b)}\")\n\n  //view.step():\n  code.push(\"proto.step=function \"+className+\"_step(\"+args.join(\",\")+\"){var \"+\n    indices.map(function(i) {\n      return \"a\"+i+\"=this.shape[\"+i+\"]\"\n    }).join(\",\")+\",\"+\n    indices.map(function(i) {\n      return \"b\"+i+\"=this.stride[\"+i+\"]\"\n    }).join(\",\")+\",c=this.offset,d=0,ceil=Math.ceil\")\n  for(var i=0; i<dimension; ++i) {\n    code.push(\n\"if(typeof i\"+i+\"==='number'){\\\nd=i\"+i+\"|0;\\\nif(d<0){\\\nc+=b\"+i+\"*(a\"+i+\"-1);\\\na\"+i+\"=ceil(-a\"+i+\"/d)\\\n}else{\\\na\"+i+\"=ceil(a\"+i+\"/d)\\\n}\\\nb\"+i+\"*=d\\\n}\")\n  }\n  code.push(\"return new \"+className+\"(this.data,\"+\n    indices.map(function(i) {\n      return \"a\" + i\n    }).join(\",\")+\",\"+\n    indices.map(function(i) {\n      return \"b\" + i\n    }).join(\",\")+\",c)}\")\n\n  //view.transpose():\n  var tShape = new Array(dimension)\n  var tStride = new Array(dimension)\n  for(var i=0; i<dimension; ++i) {\n    tShape[i] = \"a[i\"+i+\"]\"\n    tStride[i] = \"b[i\"+i+\"]\"\n  }\n  code.push(\"proto.transpose=function \"+className+\"_transpose(\"+args+\"){\"+\n    args.map(function(n,idx) { return n + \"=(\" + n + \"===undefined?\" + idx + \":\" + n + \"|0)\"}).join(\";\"),\n    \"var a=this.shape,b=this.stride;return new \"+className+\"(this.data,\"+tShape.join(\",\")+\",\"+tStride.join(\",\")+\",this.offset)}\")\n\n  //view.pick():\n  code.push(\"proto.pick=function \"+className+\"_pick(\"+args+\"){var a=[],b=[],c=this.offset\")\n  for(var i=0; i<dimension; ++i) {\n    code.push(\"if(typeof i\"+i+\"==='number'&&i\"+i+\">=0){c=(c+this.stride[\"+i+\"]*i\"+i+\")|0}else{a.push(this.shape[\"+i+\"]);b.push(this.stride[\"+i+\"])}\")\n  }\n  code.push(\"var ctor=CTOR_LIST[a.length+1];return ctor(this.data,a,b,c)}\")\n\n  //Add return statement\n  code.push(\"return function construct_\"+className+\"(data,shape,stride,offset){return new \"+className+\"(data,\"+\n    indices.map(function(i) {\n      return \"shape[\"+i+\"]\"\n    }).join(\",\")+\",\"+\n    indices.map(function(i) {\n      return \"stride[\"+i+\"]\"\n    }).join(\",\")+\",offset)}\")\n\n  //Compile procedure\n  var procedure = new Function(\"CTOR_LIST\", \"ORDER\", code.join(\"\\n\"))\n  return procedure(CACHED_CONSTRUCTORS[dtype], order)\n}\n\nfunction arrayDType(data) {\n  if(isBuffer(data)) {\n    return \"buffer\"\n  }\n  if(hasTypedArrays) {\n    switch(Object.prototype.toString.call(data)) {\n      case \"[object Float64Array]\":\n        return \"float64\"\n      case \"[object Float32Array]\":\n        return \"float32\"\n      case \"[object Int8Array]\":\n        return \"int8\"\n      case \"[object Int16Array]\":\n        return \"int16\"\n      case \"[object Int32Array]\":\n        return \"int32\"\n      case \"[object Uint8Array]\":\n        return \"uint8\"\n      case \"[object Uint16Array]\":\n        return \"uint16\"\n      case \"[object Uint32Array]\":\n        return \"uint32\"\n      case \"[object Uint8ClampedArray]\":\n        return \"uint8_clamped\"\n      case \"[object BigInt64Array]\":\n        return \"bigint64\"\n      case \"[object BigUint64Array]\":\n        return \"biguint64\"\n    }\n  }\n  if(Array.isArray(data)) {\n    return \"array\"\n  }\n  return \"generic\"\n}\n\nvar CACHED_CONSTRUCTORS = {\n  \"float32\":[],\n  \"float64\":[],\n  \"int8\":[],\n  \"int16\":[],\n  \"int32\":[],\n  \"uint8\":[],\n  \"uint16\":[],\n  \"uint32\":[],\n  \"array\":[],\n  \"uint8_clamped\":[],\n  \"bigint64\": [],\n  \"biguint64\": [],\n  \"buffer\":[],\n  \"generic\":[]\n}\n\n;(function() {\n  for(var id in CACHED_CONSTRUCTORS) {\n    CACHED_CONSTRUCTORS[id].push(compileConstructor(id, -1))\n  }\n});\n\nfunction wrappedNDArrayCtor(data, shape, stride, offset) {\n  if(data === undefined) {\n    var ctor = CACHED_CONSTRUCTORS.array[0]\n    return ctor([])\n  } else if(typeof data === \"number\") {\n    data = [data]\n  }\n  if(shape === undefined) {\n    shape = [ data.length ]\n  }\n  var d = shape.length\n  if(stride === undefined) {\n    stride = new Array(d)\n    for(var i=d-1, sz=1; i>=0; --i) {\n      stride[i] = sz\n      sz *= shape[i]\n    }\n  }\n  if(offset === undefined) {\n    offset = 0\n    for(var i=0; i<d; ++i) {\n      if(stride[i] < 0) {\n        offset -= (shape[i]-1)*stride[i]\n      }\n    }\n  }\n  var dtype = arrayDType(data)\n  var ctor_list = CACHED_CONSTRUCTORS[dtype]\n  while(ctor_list.length <= d+1) {\n    ctor_list.push(compileConstructor(dtype, ctor_list.length-1))\n  }\n  var ctor = ctor_list[d+1]\n  return ctor(data, shape, stride, offset)\n}\n\nmodule.exports = wrappedNDArrayCtor\n","module.exports = AABB\n\nvar vec3 = require('gl-vec3')\n\nfunction AABB(pos, vec) {\n\n  if(!(this instanceof AABB)) {\n    return new AABB(pos, vec)\n  }\n\n  var pos2 = vec3.create()\n  vec3.add(pos2, pos, vec)\n \n  this.base = vec3.min(vec3.create(), pos, pos2)\n  this.vec = vec3.clone(vec)\n  this.max = vec3.max(vec3.create(), pos, pos2)\n\n  this.mag = vec3.length(this.vec)\n\n}\n\nvar cons = AABB\n  , proto = cons.prototype\n\nproto.width = function() {\n  return this.vec[0]\n}\n\nproto.height = function() {\n  return this.vec[1]\n}\n\nproto.depth = function() {\n  return this.vec[2]\n}\n\nproto.x0 = function() {\n  return this.base[0]\n}\n\nproto.y0 = function() {\n  return this.base[1]\n}\n\nproto.z0 = function() {\n  return this.base[2]\n}\n\nproto.x1 = function() {\n  return this.max[0]\n}\n\nproto.y1 = function() {\n  return this.max[1]\n}\n\nproto.z1 = function() {\n  return this.max[2]\n}\n\nproto.translate = function(by) {\n  vec3.add(this.max, this.max, by)\n  vec3.add(this.base, this.base, by)\n  return this\n}\n\nproto.setPosition = function(pos) {\n  vec3.add(this.max, pos, this.vec)\n  vec3.copy(this.base, pos)\n  return this\n}\n\nproto.expand = function(aabb) {\n  var max = vec3.create()\n    , min = vec3.create()\n\n  vec3.max(max, aabb.max, this.max)\n  vec3.min(min, aabb.base, this.base)\n  vec3.subtract(max, max, min)\n\n  return new AABB(min, max)\n}\n\nproto.intersects = function(aabb) {\n  if(aabb.base[0] > this.max[0]) return false\n  if(aabb.base[1] > this.max[1]) return false\n  if(aabb.base[2] > this.max[2]) return false\n  if(aabb.max[0] < this.base[0]) return false\n  if(aabb.max[1] < this.base[1]) return false\n  if(aabb.max[2] < this.base[2]) return false\n\n  return true\n}\n\nproto.touches = function(aabb) {\n\n  var intersection = this.union(aabb);\n\n  return (intersection !== null) &&\n         ((intersection.width() == 0) ||\n         (intersection.height() == 0) || \n         (intersection.depth() == 0))\n\n}\n\nproto.union = function(aabb) {\n  if(!this.intersects(aabb)) return null\n\n  var base_x = Math.max(aabb.base[0], this.base[0])\n    , base_y = Math.max(aabb.base[1], this.base[1])\n    , base_z = Math.max(aabb.base[2], this.base[2])\n    , max_x = Math.min(aabb.max[0], this.max[0])\n    , max_y = Math.min(aabb.max[1], this.max[1])\n    , max_z = Math.min(aabb.max[2], this.max[2])\n\n  return new AABB([base_x, base_y, base_z], [max_x - base_x, max_y - base_y, max_z - base_z])\n}\n\n\n\n\n","'use strict'\n\nvar bits = require('bit-twiddle')\nvar dup = require('dup')\nvar Buffer = require('buffer').Buffer\n\n//Legacy pool support\nif(!global.__TYPEDARRAY_POOL) {\n  global.__TYPEDARRAY_POOL = {\n      UINT8     : dup([32, 0])\n    , UINT16    : dup([32, 0])\n    , UINT32    : dup([32, 0])\n    , BIGUINT64 : dup([32, 0])\n    , INT8      : dup([32, 0])\n    , INT16     : dup([32, 0])\n    , INT32     : dup([32, 0])\n    , BIGINT64  : dup([32, 0])\n    , FLOAT     : dup([32, 0])\n    , DOUBLE    : dup([32, 0])\n    , DATA      : dup([32, 0])\n    , UINT8C    : dup([32, 0])\n    , BUFFER    : dup([32, 0])\n  }\n}\n\nvar hasUint8C = (typeof Uint8ClampedArray) !== 'undefined'\nvar hasBigUint64 = (typeof BigUint64Array) !== 'undefined'\nvar hasBigInt64 = (typeof BigInt64Array) !== 'undefined'\nvar POOL = global.__TYPEDARRAY_POOL\n\n//Upgrade pool\nif(!POOL.UINT8C) {\n  POOL.UINT8C = dup([32, 0])\n}\nif(!POOL.BIGUINT64) {\n  POOL.BIGUINT64 = dup([32, 0])\n}\nif(!POOL.BIGINT64) {\n  POOL.BIGINT64 = dup([32, 0])\n}\nif(!POOL.BUFFER) {\n  POOL.BUFFER = dup([32, 0])\n}\n\n//New technique: Only allocate from ArrayBufferView and Buffer\nvar DATA    = POOL.DATA\n  , BUFFER  = POOL.BUFFER\n\nexports.free = function free(array) {\n  if(Buffer.isBuffer(array)) {\n    BUFFER[bits.log2(array.length)].push(array)\n  } else {\n    if(Object.prototype.toString.call(array) !== '[object ArrayBuffer]') {\n      array = array.buffer\n    }\n    if(!array) {\n      return\n    }\n    var n = array.length || array.byteLength\n    var log_n = bits.log2(n)|0\n    DATA[log_n].push(array)\n  }\n}\n\nfunction freeArrayBuffer(buffer) {\n  if(!buffer) {\n    return\n  }\n  var n = buffer.length || buffer.byteLength\n  var log_n = bits.log2(n)\n  DATA[log_n].push(buffer)\n}\n\nfunction freeTypedArray(array) {\n  freeArrayBuffer(array.buffer)\n}\n\nexports.freeUint8 =\nexports.freeUint16 =\nexports.freeUint32 =\nexports.freeBigUint64 =\nexports.freeInt8 =\nexports.freeInt16 =\nexports.freeInt32 =\nexports.freeBigInt64 =\nexports.freeFloat32 = \nexports.freeFloat =\nexports.freeFloat64 = \nexports.freeDouble = \nexports.freeUint8Clamped = \nexports.freeDataView = freeTypedArray\n\nexports.freeArrayBuffer = freeArrayBuffer\n\nexports.freeBuffer = function freeBuffer(array) {\n  BUFFER[bits.log2(array.length)].push(array)\n}\n\nexports.malloc = function malloc(n, dtype) {\n  if(dtype === undefined || dtype === 'arraybuffer') {\n    return mallocArrayBuffer(n)\n  } else {\n    switch(dtype) {\n      case 'uint8':\n        return mallocUint8(n)\n      case 'uint16':\n        return mallocUint16(n)\n      case 'uint32':\n        return mallocUint32(n)\n      case 'int8':\n        return mallocInt8(n)\n      case 'int16':\n        return mallocInt16(n)\n      case 'int32':\n        return mallocInt32(n)\n      case 'float':\n      case 'float32':\n        return mallocFloat(n)\n      case 'double':\n      case 'float64':\n        return mallocDouble(n)\n      case 'uint8_clamped':\n        return mallocUint8Clamped(n)\n      case 'bigint64':\n        return mallocBigInt64(n)\n      case 'biguint64':\n        return mallocBigUint64(n)\n      case 'buffer':\n        return mallocBuffer(n)\n      case 'data':\n      case 'dataview':\n        return mallocDataView(n)\n\n      default:\n        return null\n    }\n  }\n  return null\n}\n\nfunction mallocArrayBuffer(n) {\n  var n = bits.nextPow2(n)\n  var log_n = bits.log2(n)\n  var d = DATA[log_n]\n  if(d.length > 0) {\n    return d.pop()\n  }\n  return new ArrayBuffer(n)\n}\nexports.mallocArrayBuffer = mallocArrayBuffer\n\nfunction mallocUint8(n) {\n  return new Uint8Array(mallocArrayBuffer(n), 0, n)\n}\nexports.mallocUint8 = mallocUint8\n\nfunction mallocUint16(n) {\n  return new Uint16Array(mallocArrayBuffer(2*n), 0, n)\n}\nexports.mallocUint16 = mallocUint16\n\nfunction mallocUint32(n) {\n  return new Uint32Array(mallocArrayBuffer(4*n), 0, n)\n}\nexports.mallocUint32 = mallocUint32\n\nfunction mallocInt8(n) {\n  return new Int8Array(mallocArrayBuffer(n), 0, n)\n}\nexports.mallocInt8 = mallocInt8\n\nfunction mallocInt16(n) {\n  return new Int16Array(mallocArrayBuffer(2*n), 0, n)\n}\nexports.mallocInt16 = mallocInt16\n\nfunction mallocInt32(n) {\n  return new Int32Array(mallocArrayBuffer(4*n), 0, n)\n}\nexports.mallocInt32 = mallocInt32\n\nfunction mallocFloat(n) {\n  return new Float32Array(mallocArrayBuffer(4*n), 0, n)\n}\nexports.mallocFloat32 = exports.mallocFloat = mallocFloat\n\nfunction mallocDouble(n) {\n  return new Float64Array(mallocArrayBuffer(8*n), 0, n)\n}\nexports.mallocFloat64 = exports.mallocDouble = mallocDouble\n\nfunction mallocUint8Clamped(n) {\n  if(hasUint8C) {\n    return new Uint8ClampedArray(mallocArrayBuffer(n), 0, n)\n  } else {\n    return mallocUint8(n)\n  }\n}\nexports.mallocUint8Clamped = mallocUint8Clamped\n\nfunction mallocBigUint64(n) {\n  if(hasBigUint64) {\n    return new BigUint64Array(mallocArrayBuffer(8*n), 0, n)\n  } else {\n    return null;\n  }\n}\nexports.mallocBigUint64 = mallocBigUint64\n\nfunction mallocBigInt64(n) {\n  if (hasBigInt64) {\n    return new BigInt64Array(mallocArrayBuffer(8*n), 0, n)\n  } else {\n    return null;\n  }\n}\nexports.mallocBigInt64 = mallocBigInt64\n\nfunction mallocDataView(n) {\n  return new DataView(mallocArrayBuffer(n), 0, n)\n}\nexports.mallocDataView = mallocDataView\n\nfunction mallocBuffer(n) {\n  n = bits.nextPow2(n)\n  var log_n = bits.log2(n)\n  var cache = BUFFER[log_n]\n  if(cache.length > 0) {\n    return cache.pop()\n  }\n  return new Buffer(n)\n}\nexports.mallocBuffer = mallocBuffer\n\nexports.clearCache = function clearCache() {\n  for(var i=0; i<32; ++i) {\n    POOL.UINT8[i].length = 0\n    POOL.UINT16[i].length = 0\n    POOL.UINT32[i].length = 0\n    POOL.INT8[i].length = 0\n    POOL.INT16[i].length = 0\n    POOL.INT32[i].length = 0\n    POOL.FLOAT[i].length = 0\n    POOL.DOUBLE[i].length = 0\n    POOL.BIGUINT64[i].length = 0\n    POOL.BIGINT64[i].length = 0\n    POOL.UINT8C[i].length = 0\n    DATA[i].length = 0\n    BUFFER[i].length = 0\n  }\n}\n","/**\n * Bit twiddling hacks for JavaScript.\n *\n * Author: Mikola Lysenko\n *\n * Ported from Stanford bit twiddling hack library:\n *    http://graphics.stanford.edu/~seander/bithacks.html\n */\n\n\"use strict\"; \"use restrict\";\n\n//Number of bits in an integer\nvar INT_BITS = 32;\n\n//Constants\nexports.INT_BITS  = INT_BITS;\nexports.INT_MAX   =  0x7fffffff;\nexports.INT_MIN   = -1<<(INT_BITS-1);\n\n//Returns -1, 0, +1 depending on sign of x\nexports.sign = function(v) {\n  return (v > 0) - (v < 0);\n}\n\n//Computes absolute value of integer\nexports.abs = function(v) {\n  var mask = v >> (INT_BITS-1);\n  return (v ^ mask) - mask;\n}\n\n//Computes minimum of integers x and y\nexports.min = function(x, y) {\n  return y ^ ((x ^ y) & -(x < y));\n}\n\n//Computes maximum of integers x and y\nexports.max = function(x, y) {\n  return x ^ ((x ^ y) & -(x < y));\n}\n\n//Checks if a number is a power of two\nexports.isPow2 = function(v) {\n  return !(v & (v-1)) && (!!v);\n}\n\n//Computes log base 2 of v\nexports.log2 = function(v) {\n  var r, shift;\n  r =     (v > 0xFFFF) << 4; v >>>= r;\n  shift = (v > 0xFF  ) << 3; v >>>= shift; r |= shift;\n  shift = (v > 0xF   ) << 2; v >>>= shift; r |= shift;\n  shift = (v > 0x3   ) << 1; v >>>= shift; r |= shift;\n  return r | (v >> 1);\n}\n\n//Computes log base 10 of v\nexports.log10 = function(v) {\n  return  (v >= 1000000000) ? 9 : (v >= 100000000) ? 8 : (v >= 10000000) ? 7 :\n          (v >= 1000000) ? 6 : (v >= 100000) ? 5 : (v >= 10000) ? 4 :\n          (v >= 1000) ? 3 : (v >= 100) ? 2 : (v >= 10) ? 1 : 0;\n}\n\n//Counts number of bits\nexports.popCount = function(v) {\n  v = v - ((v >>> 1) & 0x55555555);\n  v = (v & 0x33333333) + ((v >>> 2) & 0x33333333);\n  return ((v + (v >>> 4) & 0xF0F0F0F) * 0x1010101) >>> 24;\n}\n\n//Counts number of trailing zeros\nfunction countTrailingZeros(v) {\n  var c = 32;\n  v &= -v;\n  if (v) c--;\n  if (v & 0x0000FFFF) c -= 16;\n  if (v & 0x00FF00FF) c -= 8;\n  if (v & 0x0F0F0F0F) c -= 4;\n  if (v & 0x33333333) c -= 2;\n  if (v & 0x55555555) c -= 1;\n  return c;\n}\nexports.countTrailingZeros = countTrailingZeros;\n\n//Rounds to next power of 2\nexports.nextPow2 = function(v) {\n  v += v === 0;\n  --v;\n  v |= v >>> 1;\n  v |= v >>> 2;\n  v |= v >>> 4;\n  v |= v >>> 8;\n  v |= v >>> 16;\n  return v + 1;\n}\n\n//Rounds down to previous power of 2\nexports.prevPow2 = function(v) {\n  v |= v >>> 1;\n  v |= v >>> 2;\n  v |= v >>> 4;\n  v |= v >>> 8;\n  v |= v >>> 16;\n  return v - (v>>>1);\n}\n\n//Computes parity of word\nexports.parity = function(v) {\n  v ^= v >>> 16;\n  v ^= v >>> 8;\n  v ^= v >>> 4;\n  v &= 0xf;\n  return (0x6996 >>> v) & 1;\n}\n\nvar REVERSE_TABLE = new Array(256);\n\n(function(tab) {\n  for(var i=0; i<256; ++i) {\n    var v = i, r = i, s = 7;\n    for (v >>>= 1; v; v >>>= 1) {\n      r <<= 1;\n      r |= v & 1;\n      --s;\n    }\n    tab[i] = (r << s) & 0xff;\n  }\n})(REVERSE_TABLE);\n\n//Reverse bits in a 32 bit word\nexports.reverse = function(v) {\n  return  (REVERSE_TABLE[ v         & 0xff] << 24) |\n          (REVERSE_TABLE[(v >>> 8)  & 0xff] << 16) |\n          (REVERSE_TABLE[(v >>> 16) & 0xff] << 8)  |\n           REVERSE_TABLE[(v >>> 24) & 0xff];\n}\n\n//Interleave bits of 2 coordinates with 16 bits.  Useful for fast quadtree codes\nexports.interleave2 = function(x, y) {\n  x &= 0xFFFF;\n  x = (x | (x << 8)) & 0x00FF00FF;\n  x = (x | (x << 4)) & 0x0F0F0F0F;\n  x = (x | (x << 2)) & 0x33333333;\n  x = (x | (x << 1)) & 0x55555555;\n\n  y &= 0xFFFF;\n  y = (y | (y << 8)) & 0x00FF00FF;\n  y = (y | (y << 4)) & 0x0F0F0F0F;\n  y = (y | (y << 2)) & 0x33333333;\n  y = (y | (y << 1)) & 0x55555555;\n\n  return x | (y << 1);\n}\n\n//Extracts the nth interleaved component\nexports.deinterleave2 = function(v, n) {\n  v = (v >>> n) & 0x55555555;\n  v = (v | (v >>> 1))  & 0x33333333;\n  v = (v | (v >>> 2))  & 0x0F0F0F0F;\n  v = (v | (v >>> 4))  & 0x00FF00FF;\n  v = (v | (v >>> 16)) & 0x000FFFF;\n  return (v << 16) >> 16;\n}\n\n\n//Interleave bits of 3 coordinates, each with 10 bits.  Useful for fast octree codes\nexports.interleave3 = function(x, y, z) {\n  x &= 0x3FF;\n  x  = (x | (x<<16)) & 4278190335;\n  x  = (x | (x<<8))  & 251719695;\n  x  = (x | (x<<4))  & 3272356035;\n  x  = (x | (x<<2))  & 1227133513;\n\n  y &= 0x3FF;\n  y  = (y | (y<<16)) & 4278190335;\n  y  = (y | (y<<8))  & 251719695;\n  y  = (y | (y<<4))  & 3272356035;\n  y  = (y | (y<<2))  & 1227133513;\n  x |= (y << 1);\n  \n  z &= 0x3FF;\n  z  = (z | (z<<16)) & 4278190335;\n  z  = (z | (z<<8))  & 251719695;\n  z  = (z | (z<<4))  & 3272356035;\n  z  = (z | (z<<2))  & 1227133513;\n  \n  return x | (z << 2);\n}\n\n//Extracts nth interleaved component of a 3-tuple\nexports.deinterleave3 = function(v, n) {\n  v = (v >>> n)       & 1227133513;\n  v = (v | (v>>>2))   & 3272356035;\n  v = (v | (v>>>4))   & 251719695;\n  v = (v | (v>>>8))   & 4278190335;\n  v = (v | (v>>>16))  & 0x3FF;\n  return (v<<22)>>22;\n}\n\n//Computes next combination in colexicographic order (this is mistakenly called nextPermutation on the bit twiddling hacks page)\nexports.nextCombination = function(v) {\n  var t = v | (v - 1);\n  return (t + 1) | (((~t & -~t) - 1) >>> (countTrailingZeros(v) + 1));\n}\n\n","var vec3 = require('gl-vec3')\n\nexport default function (noa) {\n\n    /**\n     * \n     * \tComponent holding entity's position, width, and height.\n     *  By convention, entity's \"position\" is the bottom center of its AABB\n     * \n     *  Of the various properties, _localPosition is the \"real\", \n     *  single-source-of-truth position. Others are derived.\n     *  Local coords are relative to `noa.worldOriginOffset`.\n     * \n     *  Props:\n     *      position: pos in global coords (may be low precision)\n     *      _localPosition: precise pos in local coords\n     *      _renderPosition: [x,y,z] in LOCAL COORDS\n     *      _extents: array [lo, lo, lo, hi, hi, hi] in LOCAL COORDS\n     * \n     */\n\n\n\n    return {\n\n        name: 'position',\n\n        order: 60,\n\n        state: {\n            position: null,\n            width: +1,\n            height: +1,\n            _localPosition: null,\n            _renderPosition: null,\n            _extents: null,\n        },\n\n\n        onAdd: function (eid, state) {\n            // copy position into a plain array\n            var pos = [0, 0, 0]\n            if (state.position) vec3.copy(pos, state.position)\n            state.position = pos\n\n            state._localPosition = vec3.create()\n            state._renderPosition = vec3.create()\n            state._extents = new Float32Array(6)\n\n            // on init only, set local from global\n            noa.globalToLocal(state.position, null, state._localPosition)\n            vec3.copy(state._renderPosition, state._localPosition)\n            updatePositionExtents(state)\n        },\n\n        onRemove: null,\n\n\n\n        system: function (dt, states) {\n            var off = noa.worldOriginOffset\n            states.forEach(state => {\n                vec3.add(state.position, state._localPosition, off)\n                updatePositionExtents(state)\n            })\n        },\n\n\n    }\n}\n\n\n\n// update an entity's position state `_extents` \nexport function updatePositionExtents(state) {\n    var hw = state.width / 2\n    var lpos = state._localPosition\n    var ext = state._extents\n    ext[0] = lpos[0] - hw\n    ext[1] = lpos[1]\n    ext[2] = lpos[2] - hw\n    ext[3] = lpos[0] + hw\n    ext[4] = lpos[1] + state.height\n    ext[5] = lpos[2] + hw\n}\n","var vec3 = require('gl-vec3')\n\n\nexport default function (noa) {\n\n\n    return {\n\n        name: 'physics',\n\n        order: 40,\n\n        state: {\n            body: null,\n        },\n\n\n        onAdd: function (entID, state) {\n            state.body = noa.physics.addBody()\n            // implicitly assume body has a position component, to get size\n            var posDat = noa.ents.getPositionData(state.__id)\n            setPhysicsFromPosition(state, posDat)\n        },\n\n\n        onRemove: function (entID, state) {\n            // update position before removing\n            // this lets entity wind up at e.g. the result of a collision\n            // even if physics component is removed in collision handler\n            if (noa.ents.hasPosition(state.__id)) {\n                var pdat = noa.ents.getPositionData(state.__id)\n                setPositionFromPhysics(state, pdat)\n                backtrackRenderPos(state, pdat, 0, false)\n            }\n            noa.physics.removeBody(state.body)\n        },\n\n\n        system: function (dt, states) {\n            states.forEach(state => {\n                var pdat = noa.ents.getPositionData(state.__id)\n                setPositionFromPhysics(state, pdat)\n            })\n\n        },\n\n\n        renderSystem: function (dt, states) {\n\n            var tickPos = noa.positionInCurrentTick\n            var tickMS = tickPos * noa._tickRate\n\n            // tickMS is time since last physics engine tick\n            // to avoid temporal aliasing, render the state as if lerping between\n            // the last position and the next one \n            // since the entity data is the \"next\" position this amounts to \n            // offsetting each entity into the past by tickRate - dt\n            // http://gafferongames.com/game-physics/fix-your-timestep/\n\n            var backtrackAmt = (tickMS - noa._tickRate) / 1000\n            states.forEach(state => {\n                var id = state.__id\n                var pdat = noa.ents.getPositionData(id)\n                var smoothed = noa.ents.cameraSmoothed(id)\n                backtrackRenderPos(state, pdat, backtrackAmt, smoothed)\n            })\n        }\n\n    }\n\n}\n\n\n\n// var offset = vec3.create()\nvar local = vec3.create()\n\nexport function setPhysicsFromPosition(physState, posState) {\n    var box = physState.body.aabb\n    var ext = posState._extents\n    vec3.copy(box.base, ext)\n    vec3.set(box.vec, posState.width, posState.height, posState.width)\n    vec3.add(box.max, box.base, box.vec)\n}\n\n\nfunction setPositionFromPhysics(physState, posState) {\n    var base = physState.body.aabb.base\n    var hw = posState.width / 2\n    vec3.set(posState._localPosition, base[0] + hw, base[1], base[2] + hw)\n}\n\n\nfunction backtrackRenderPos(physState, posState, backtrackAmt, smoothed) {\n    // pos = pos + backtrack * body.velocity\n    var vel = physState.body.velocity\n    vec3.scaleAndAdd(local, posState._localPosition, vel, backtrackAmt)\n\n    // smooth out update if component is present\n    // (this is set after sudden movements like auto-stepping)\n    if (smoothed) vec3.lerp(local, posState._renderPosition, local, 0.3)\n\n    // copy values over to renderPosition, \n    vec3.copy(posState._renderPosition, local)\n}\n","module.exports = 0.000001\n","module.exports = create;\n\n/**\n * Creates a new, empty vec3\n *\n * @returns {vec3} a new 3D vector\n */\nfunction create() {\n    var out = new Float32Array(3)\n    out[0] = 0\n    out[1] = 0\n    out[2] = 0\n    return out\n}","module.exports = fromValues;\n\n/**\n * Creates a new vec3 initialized with the given values\n *\n * @param {Number} x X component\n * @param {Number} y Y component\n * @param {Number} z Z component\n * @returns {vec3} a new 3D vector\n */\nfunction fromValues(x, y, z) {\n    var out = new Float32Array(3)\n    out[0] = x\n    out[1] = y\n    out[2] = z\n    return out\n}","module.exports = normalize;\n\n/**\n * Normalize a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a vector to normalize\n * @returns {vec3} out\n */\nfunction normalize(out, a) {\n    var x = a[0],\n        y = a[1],\n        z = a[2]\n    var len = x*x + y*y + z*z\n    if (len > 0) {\n        //TODO: evaluate use of glm_invsqrt here?\n        len = 1 / Math.sqrt(len)\n        out[0] = a[0] * len\n        out[1] = a[1] * len\n        out[2] = a[2] * len\n    }\n    return out\n}","module.exports = dot;\n\n/**\n * Calculates the dot product of two vec3's\n *\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @returns {Number} dot product of a and b\n */\nfunction dot(a, b) {\n    return a[0] * b[0] + a[1] * b[1] + a[2] * b[2]\n}","module.exports = subtract;\n\n/**\n * Subtracts vector b from vector a\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @returns {vec3} out\n */\nfunction subtract(out, a, b) {\n    out[0] = a[0] - b[0]\n    out[1] = a[1] - b[1]\n    out[2] = a[2] - b[2]\n    return out\n}","module.exports = multiply;\n\n/**\n * Multiplies two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @returns {vec3} out\n */\nfunction multiply(out, a, b) {\n    out[0] = a[0] * b[0]\n    out[1] = a[1] * b[1]\n    out[2] = a[2] * b[2]\n    return out\n}","module.exports = divide;\n\n/**\n * Divides two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @returns {vec3} out\n */\nfunction divide(out, a, b) {\n    out[0] = a[0] / b[0]\n    out[1] = a[1] / b[1]\n    out[2] = a[2] / b[2]\n    return out\n}","module.exports = distance;\n\n/**\n * Calculates the euclidian distance between two vec3's\n *\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @returns {Number} distance between a and b\n */\nfunction distance(a, b) {\n    var x = b[0] - a[0],\n        y = b[1] - a[1],\n        z = b[2] - a[2]\n    return Math.sqrt(x*x + y*y + z*z)\n}","module.exports = squaredDistance;\n\n/**\n * Calculates the squared euclidian distance between two vec3's\n *\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @returns {Number} squared distance between a and b\n */\nfunction squaredDistance(a, b) {\n    var x = b[0] - a[0],\n        y = b[1] - a[1],\n        z = b[2] - a[2]\n    return x*x + y*y + z*z\n}","module.exports = length;\n\n/**\n * Calculates the length of a vec3\n *\n * @param {vec3} a vector to calculate length of\n * @returns {Number} length of a\n */\nfunction length(a) {\n    var x = a[0],\n        y = a[1],\n        z = a[2]\n    return Math.sqrt(x*x + y*y + z*z)\n}","module.exports = squaredLength;\n\n/**\n * Calculates the squared length of a vec3\n *\n * @param {vec3} a vector to calculate squared length of\n * @returns {Number} squared length of a\n */\nfunction squaredLength(a) {\n    var x = a[0],\n        y = a[1],\n        z = a[2]\n    return x*x + y*y + z*z\n}","\"use strict\"\n\nfunction iota(n) {\n  var result = new Array(n)\n  for(var i=0; i<n; ++i) {\n    result[i] = i\n  }\n  return result\n}\n\nmodule.exports = iota","'use strict'\n\n\n// reused array instances\n\nvar tr_arr = []\nvar ldi_arr = []\nvar tri_arr = []\nvar step_arr = []\nvar tDelta_arr = []\nvar tNext_arr = []\nvar vec_arr = []\nvar normed_arr = []\nvar base_arr = []\nvar max_arr = []\nvar left_arr = []\nvar result_arr = []\n\n\n\n// core implementation:\n\nfunction sweep_impl(getVoxel, callback, vec, base, max, epsilon) {\n\n    // consider algo as a raycast along the AABB's leading corner\n    // as raycast enters each new voxel, iterate in 2D over the AABB's \n    // leading face in that axis looking for collisions\n    // \n    // original raycast implementation: https://github.com/andyhall/fast-voxel-raycast\n    // original raycast paper: http://www.cse.chalmers.se/edu/year/2010/course/TDA361/grid.pdf\n\n    var tr = tr_arr\n    var ldi = ldi_arr\n    var tri = tri_arr\n    var step = step_arr\n    var tDelta = tDelta_arr\n    var tNext = tNext_arr\n    var normed = normed_arr\n\n    var floor = Math.floor\n    var cumulative_t = 0.0\n    var t = 0.0\n    var max_t = 0.0\n    var axis = 0\n    var i = 0\n\n\n    // init for the current sweep vector and take first step\n    initSweep()\n    if (max_t === 0) return 0\n\n    axis = stepForward()\n\n    // loop along raycast vector\n    while (t <= max_t) {\n\n        // sweeps over leading face of AABB\n        if (checkCollision(axis)) {\n            // calls the callback and decides whether to continue\n            var done = handleCollision()\n            if (done) return cumulative_t\n        }\n\n        axis = stepForward()\n    }\n\n    // reached the end of the vector unobstructed, finish and exit\n    cumulative_t += max_t\n    for (i = 0; i < 3; i++) {\n        base[i] += vec[i]\n        max[i] += vec[i]\n    }\n    return cumulative_t\n\n\n\n\n\n    // low-level implementations of each step:\n    function initSweep() {\n\n        // parametrization t along raycast\n        t = 0.0\n        max_t = Math.sqrt(vec[0] * vec[0] + vec[1] * vec[1] + vec[2] * vec[2])\n        if (max_t === 0) return\n        for (var i = 0; i < 3; i++) {\n            var dir = (vec[i] >= 0)\n            step[i] = dir ? 1 : -1\n            // trailing / trailing edge coords\n            var lead = dir ? max[i] : base[i]\n            tr[i] = dir ? base[i] : max[i]\n            // int values of lead/trail edges\n            ldi[i] = leadEdgeToInt(lead, step[i])\n            tri[i] = trailEdgeToInt(tr[i], step[i])\n            // normed vector\n            normed[i] = vec[i] / max_t\n            // distance along t required to move one voxel in each axis\n            tDelta[i] = Math.abs(1 / normed[i])\n            // location of nearest voxel boundary, in units of t \n            var dist = dir ? (ldi[i] + 1 - lead) : (lead - ldi[i])\n            tNext[i] = (tDelta[i] < Infinity) ? tDelta[i] * dist : Infinity\n        }\n\n    }\n\n\n    // check for collisions - iterate over the leading face on the advancing axis\n\n    function checkCollision(i_axis) {\n        var stepx = step[0]\n        var x0 = (i_axis === 0) ? ldi[0] : tri[0]\n        var x1 = ldi[0] + stepx\n\n        var stepy = step[1]\n        var y0 = (i_axis === 1) ? ldi[1] : tri[1]\n        var y1 = ldi[1] + stepy\n\n        var stepz = step[2]\n        var z0 = (i_axis === 2) ? ldi[2] : tri[2]\n        var z1 = ldi[2] + stepz\n\n        // var j_axis = (i_axis + 1) % 3\n        // var k_axis = (i_axis + 2) % 3\n        // var s = ['x', 'y', 'z'][i_axis]\n        // var js = ['x', 'y', 'z'][j_axis]\n        // var ks = ['x', 'y', 'z'][k_axis]\n        // var i0 = [x0, y0, z0][i_axis]\n        // var j0 = [x0, y0, z0][j_axis]\n        // var k0 = [x0, y0, z0][k_axis]\n        // var i1 = [x1 - stepx, y1 - stepy, z1 - stepz][i_axis]\n        // var j1 = [x1 - stepx, y1 - stepy, z1 - stepz][j_axis]\n        // var k1 = [x1 - stepx, y1 - stepy, z1 - stepz][k_axis]\n        // console.log('=== step', s, 'to', i0, '   sweep', js, j0 + ',' + j1, '   ', ks, k0 + ',' + k1)\n\n        for (var x = x0; x != x1; x += stepx) {\n            for (var y = y0; y != y1; y += stepy) {\n                for (var z = z0; z != z1; z += stepz) {\n                    if (getVoxel(x, y, z)) return true\n                }\n            }\n        }\n        return false\n    }\n\n\n    // on collision - call the callback and return or set up for the next sweep\n\n    function handleCollision() {\n\n        // set up for callback\n        cumulative_t += t\n        var dir = step[axis]\n\n        // vector moved so far, and left to move\n        var done = t / max_t\n        var left = left_arr\n        for (i = 0; i < 3; i++) {\n            var dv = vec[i] * done\n            base[i] += dv\n            max[i] += dv\n            left[i] = vec[i] - dv\n        }\n\n        // set leading edge of stepped axis exactly to voxel boundary\n        // else we'll sometimes rounding error beyond it\n        if (dir > 0) {\n            max[axis] = Math.round(max[axis])\n        } else {\n            base[axis] = Math.round(base[axis])\n        }\n        \n        // call back to let client update the \"left to go\" vector\n        var res = callback(cumulative_t, axis, dir, left)\n\n        // bail out out on truthy response\n        if (res) return true\n\n        // init for new sweep along vec\n        for (i = 0; i < 3; i++) vec[i] = left[i]\n        initSweep()\n        if (max_t === 0) return true // no vector left\n\n        return false\n    }\n\n\n    // advance to next voxel boundary, and return which axis was stepped\n\n    function stepForward() {\n        var axis = (tNext[0] < tNext[1]) ?\n            ((tNext[0] < tNext[2]) ? 0 : 2) :\n            ((tNext[1] < tNext[2]) ? 1 : 2)\n        var dt = tNext[axis] - t\n        t = tNext[axis]\n        ldi[axis] += step[axis]\n        tNext[axis] += tDelta[axis]\n        for (i = 0; i < 3; i++) {\n            tr[i] += dt * normed[i]\n            tri[i] = trailEdgeToInt(tr[i], step[i])\n        }\n\n        return axis\n    }\n\n\n\n    function leadEdgeToInt(coord, step) {\n        return floor(coord - step * epsilon)\n    }\n    function trailEdgeToInt(coord, step) {\n        return floor(coord + step * epsilon)\n    }\n\n}\n\n\n\n\n\n// conform inputs\n\nfunction sweep(getVoxel, box, dir, callback, noTranslate, epsilon) {\n\n    var vec = vec_arr\n    var base = base_arr\n    var max = max_arr\n    var result = result_arr\n\n    // init parameter float arrays\n    for (var i = 0; i < 3; i++) {\n        vec[i] = +dir[i]\n        max[i] = +box.max[i]\n        base[i] = +box.base[i]\n    }\n\n    if (!epsilon) epsilon = 1e-10\n\n    // run sweep implementation\n    var dist = sweep_impl(getVoxel, callback, vec, base, max, epsilon)\n\n    // translate box by distance needed to updated base value\n    if (!noTranslate) {\n        for (i = 0; i < 3; i++) {\n            result[i] = (dir[i] > 0) ? max[i] - box.max[i] : base[i] - box.base[i]\n        }\n        box.translate(result)\n    }\n\n    // return value is total distance moved (not necessarily magnitude of [end]-[start])\n    return dist\n}\n\nmodule.exports = sweep\n\n","var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || new Function(\"return this\")();\n} catch (e) {\n\t// This works if the window reference is available\n\tif (typeof window === \"object\") g = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n","'use strict'\n\nmodule.exports = {\n  init:           sqInit,\n  sweepBipartite: sweepBipartite,\n  sweepComplete:  sweepComplete,\n  scanBipartite:  scanBipartite,\n  scanComplete:   scanComplete\n}\n\nvar pool  = require('typedarray-pool')\nvar bits  = require('bit-twiddle')\nvar isort = require('./sort')\n\n//Flag for blue\nvar BLUE_FLAG = (1<<28)\n\n//1D sweep event queue stuff (use pool to save space)\nvar INIT_CAPACITY      = 1024\nvar RED_SWEEP_QUEUE    = pool.mallocInt32(INIT_CAPACITY)\nvar RED_SWEEP_INDEX    = pool.mallocInt32(INIT_CAPACITY)\nvar BLUE_SWEEP_QUEUE   = pool.mallocInt32(INIT_CAPACITY)\nvar BLUE_SWEEP_INDEX   = pool.mallocInt32(INIT_CAPACITY)\nvar COMMON_SWEEP_QUEUE = pool.mallocInt32(INIT_CAPACITY)\nvar COMMON_SWEEP_INDEX = pool.mallocInt32(INIT_CAPACITY)\nvar SWEEP_EVENTS       = pool.mallocDouble(INIT_CAPACITY * 8)\n\n//Reserves memory for the 1D sweep data structures\nfunction sqInit(count) {\n  var rcount = bits.nextPow2(count)\n  if(RED_SWEEP_QUEUE.length < rcount) {\n    pool.free(RED_SWEEP_QUEUE)\n    RED_SWEEP_QUEUE = pool.mallocInt32(rcount)\n  }\n  if(RED_SWEEP_INDEX.length < rcount) {\n    pool.free(RED_SWEEP_INDEX)\n    RED_SWEEP_INDEX = pool.mallocInt32(rcount)\n  }\n  if(BLUE_SWEEP_QUEUE.length < rcount) {\n    pool.free(BLUE_SWEEP_QUEUE)\n    BLUE_SWEEP_QUEUE = pool.mallocInt32(rcount)\n  }\n  if(BLUE_SWEEP_INDEX.length < rcount) {\n    pool.free(BLUE_SWEEP_INDEX)\n    BLUE_SWEEP_INDEX = pool.mallocInt32(rcount)\n  }\n  if(COMMON_SWEEP_QUEUE.length < rcount) {\n    pool.free(COMMON_SWEEP_QUEUE)\n    COMMON_SWEEP_QUEUE = pool.mallocInt32(rcount)\n  }\n  if(COMMON_SWEEP_INDEX.length < rcount) {\n    pool.free(COMMON_SWEEP_INDEX)\n    COMMON_SWEEP_INDEX = pool.mallocInt32(rcount)\n  }\n  var eventLength = 8 * rcount\n  if(SWEEP_EVENTS.length < eventLength) {\n    pool.free(SWEEP_EVENTS)\n    SWEEP_EVENTS = pool.mallocDouble(eventLength)\n  }\n}\n\n//Remove an item from the active queue in O(1)\nfunction sqPop(queue, index, count, item) {\n  var idx = index[item]\n  var top = queue[count-1]\n  queue[idx] = top\n  index[top] = idx\n}\n\n//Insert an item into the active queue in O(1)\nfunction sqPush(queue, index, count, item) {\n  queue[count] = item\n  index[item]  = count\n}\n\n//Recursion base case: use 1D sweep algorithm\nfunction sweepBipartite(\n    d, visit,\n    redStart,  redEnd, red, redIndex,\n    blueStart, blueEnd, blue, blueIndex) {\n\n  //store events as pairs [coordinate, idx]\n  //\n  //  red create:  -(idx+1)\n  //  red destroy: idx\n  //  blue create: -(idx+BLUE_FLAG)\n  //  blue destroy: idx+BLUE_FLAG\n  //\n  var ptr      = 0\n  var elemSize = 2*d\n  var istart   = d-1\n  var iend     = elemSize-1\n\n  for(var i=redStart; i<redEnd; ++i) {\n    var idx = redIndex[i]\n    var redOffset = elemSize*i\n    SWEEP_EVENTS[ptr++] = red[redOffset+istart]\n    SWEEP_EVENTS[ptr++] = -(idx+1)\n    SWEEP_EVENTS[ptr++] = red[redOffset+iend]\n    SWEEP_EVENTS[ptr++] = idx\n  }\n\n  for(var i=blueStart; i<blueEnd; ++i) {\n    var idx = blueIndex[i]+BLUE_FLAG\n    var blueOffset = elemSize*i\n    SWEEP_EVENTS[ptr++] = blue[blueOffset+istart]\n    SWEEP_EVENTS[ptr++] = -idx\n    SWEEP_EVENTS[ptr++] = blue[blueOffset+iend]\n    SWEEP_EVENTS[ptr++] = idx\n  }\n\n  //process events from left->right\n  var n = ptr >>> 1\n  isort(SWEEP_EVENTS, n)\n  \n  var redActive  = 0\n  var blueActive = 0\n  for(var i=0; i<n; ++i) {\n    var e = SWEEP_EVENTS[2*i+1]|0\n    if(e >= BLUE_FLAG) {\n      //blue destroy event\n      e = (e-BLUE_FLAG)|0\n      sqPop(BLUE_SWEEP_QUEUE, BLUE_SWEEP_INDEX, blueActive--, e)\n    } else if(e >= 0) {\n      //red destroy event\n      sqPop(RED_SWEEP_QUEUE, RED_SWEEP_INDEX, redActive--, e)\n    } else if(e <= -BLUE_FLAG) {\n      //blue create event\n      e = (-e-BLUE_FLAG)|0\n      for(var j=0; j<redActive; ++j) {\n        var retval = visit(RED_SWEEP_QUEUE[j], e)\n        if(retval !== void 0) {\n          return retval\n        }\n      }\n      sqPush(BLUE_SWEEP_QUEUE, BLUE_SWEEP_INDEX, blueActive++, e)\n    } else {\n      //red create event\n      e = (-e-1)|0\n      for(var j=0; j<blueActive; ++j) {\n        var retval = visit(e, BLUE_SWEEP_QUEUE[j])\n        if(retval !== void 0) {\n          return retval\n        }\n      }\n      sqPush(RED_SWEEP_QUEUE, RED_SWEEP_INDEX, redActive++, e)\n    }\n  }\n}\n\n//Complete sweep\nfunction sweepComplete(d, visit, \n  redStart, redEnd, red, redIndex,\n  blueStart, blueEnd, blue, blueIndex) {\n\n  var ptr      = 0\n  var elemSize = 2*d\n  var istart   = d-1\n  var iend     = elemSize-1\n\n  for(var i=redStart; i<redEnd; ++i) {\n    var idx = (redIndex[i]+1)<<1\n    var redOffset = elemSize*i\n    SWEEP_EVENTS[ptr++] = red[redOffset+istart]\n    SWEEP_EVENTS[ptr++] = -idx\n    SWEEP_EVENTS[ptr++] = red[redOffset+iend]\n    SWEEP_EVENTS[ptr++] = idx\n  }\n\n  for(var i=blueStart; i<blueEnd; ++i) {\n    var idx = (blueIndex[i]+1)<<1\n    var blueOffset = elemSize*i\n    SWEEP_EVENTS[ptr++] = blue[blueOffset+istart]\n    SWEEP_EVENTS[ptr++] = (-idx)|1\n    SWEEP_EVENTS[ptr++] = blue[blueOffset+iend]\n    SWEEP_EVENTS[ptr++] = idx|1\n  }\n\n  //process events from left->right\n  var n = ptr >>> 1\n  isort(SWEEP_EVENTS, n)\n  \n  var redActive    = 0\n  var blueActive   = 0\n  var commonActive = 0\n  for(var i=0; i<n; ++i) {\n    var e     = SWEEP_EVENTS[2*i+1]|0\n    var color = e&1\n    if(i < n-1 && (e>>1) === (SWEEP_EVENTS[2*i+3]>>1)) {\n      color = 2\n      i += 1\n    }\n    \n    if(e < 0) {\n      //Create event\n      var id = -(e>>1) - 1\n\n      //Intersect with common\n      for(var j=0; j<commonActive; ++j) {\n        var retval = visit(COMMON_SWEEP_QUEUE[j], id)\n        if(retval !== void 0) {\n          return retval\n        }\n      }\n\n      if(color !== 0) {\n        //Intersect with red\n        for(var j=0; j<redActive; ++j) {\n          var retval = visit(RED_SWEEP_QUEUE[j], id)\n          if(retval !== void 0) {\n            return retval\n          }\n        }\n      }\n\n      if(color !== 1) {\n        //Intersect with blue\n        for(var j=0; j<blueActive; ++j) {\n          var retval = visit(BLUE_SWEEP_QUEUE[j], id)\n          if(retval !== void 0) {\n            return retval\n          }\n        }\n      }\n\n      if(color === 0) {\n        //Red\n        sqPush(RED_SWEEP_QUEUE, RED_SWEEP_INDEX, redActive++, id)\n      } else if(color === 1) {\n        //Blue\n        sqPush(BLUE_SWEEP_QUEUE, BLUE_SWEEP_INDEX, blueActive++, id)\n      } else if(color === 2) {\n        //Both\n        sqPush(COMMON_SWEEP_QUEUE, COMMON_SWEEP_INDEX, commonActive++, id)\n      }\n    } else {\n      //Destroy event\n      var id = (e>>1) - 1\n      if(color === 0) {\n        //Red\n        sqPop(RED_SWEEP_QUEUE, RED_SWEEP_INDEX, redActive--, id)\n      } else if(color === 1) {\n        //Blue\n        sqPop(BLUE_SWEEP_QUEUE, BLUE_SWEEP_INDEX, blueActive--, id)\n      } else if(color === 2) {\n        //Both\n        sqPop(COMMON_SWEEP_QUEUE, COMMON_SWEEP_INDEX, commonActive--, id)\n      }\n    }\n  }\n}\n\n//Sweep and prune/scanline algorithm:\n//  Scan along axis, detect intersections\n//  Brute force all boxes along axis\nfunction scanBipartite(\n  d, axis, visit, flip,\n  redStart,  redEnd, red, redIndex,\n  blueStart, blueEnd, blue, blueIndex) {\n  \n  var ptr      = 0\n  var elemSize = 2*d\n  var istart   = axis\n  var iend     = axis+d\n\n  var redShift  = 1\n  var blueShift = 1\n  if(flip) {\n    blueShift = BLUE_FLAG\n  } else {\n    redShift  = BLUE_FLAG\n  }\n\n  for(var i=redStart; i<redEnd; ++i) {\n    var idx = i + redShift\n    var redOffset = elemSize*i\n    SWEEP_EVENTS[ptr++] = red[redOffset+istart]\n    SWEEP_EVENTS[ptr++] = -idx\n    SWEEP_EVENTS[ptr++] = red[redOffset+iend]\n    SWEEP_EVENTS[ptr++] = idx\n  }\n  for(var i=blueStart; i<blueEnd; ++i) {\n    var idx = i + blueShift\n    var blueOffset = elemSize*i\n    SWEEP_EVENTS[ptr++] = blue[blueOffset+istart]\n    SWEEP_EVENTS[ptr++] = -idx\n  }\n\n  //process events from left->right\n  var n = ptr >>> 1\n  isort(SWEEP_EVENTS, n)\n  \n  var redActive    = 0\n  for(var i=0; i<n; ++i) {\n    var e = SWEEP_EVENTS[2*i+1]|0\n    if(e < 0) {\n      var idx   = -e\n      var isRed = false\n      if(idx >= BLUE_FLAG) {\n        isRed = !flip\n        idx -= BLUE_FLAG \n      } else {\n        isRed = !!flip\n        idx -= 1\n      }\n      if(isRed) {\n        sqPush(RED_SWEEP_QUEUE, RED_SWEEP_INDEX, redActive++, idx)\n      } else {\n        var blueId  = blueIndex[idx]\n        var bluePtr = elemSize * idx\n        \n        var b0 = blue[bluePtr+axis+1]\n        var b1 = blue[bluePtr+axis+1+d]\n\nred_loop:\n        for(var j=0; j<redActive; ++j) {\n          var oidx   = RED_SWEEP_QUEUE[j]\n          var redPtr = elemSize * oidx\n\n          if(b1 < red[redPtr+axis+1] || \n             red[redPtr+axis+1+d] < b0) {\n            continue\n          }\n\n          for(var k=axis+2; k<d; ++k) {\n            if(blue[bluePtr + k + d] < red[redPtr + k] || \n               red[redPtr + k + d] < blue[bluePtr + k]) {\n              continue red_loop\n            }\n          }\n\n          var redId  = redIndex[oidx]\n          var retval\n          if(flip) {\n            retval = visit(blueId, redId)\n          } else {\n            retval = visit(redId, blueId)\n          }\n          if(retval !== void 0) {\n            return retval \n          }\n        }\n      }\n    } else {\n      sqPop(RED_SWEEP_QUEUE, RED_SWEEP_INDEX, redActive--, e - redShift)\n    }\n  }\n}\n\nfunction scanComplete(\n  d, axis, visit,\n  redStart,  redEnd, red, redIndex,\n  blueStart, blueEnd, blue, blueIndex) {\n\n  var ptr      = 0\n  var elemSize = 2*d\n  var istart   = axis\n  var iend     = axis+d\n\n  for(var i=redStart; i<redEnd; ++i) {\n    var idx = i + BLUE_FLAG\n    var redOffset = elemSize*i\n    SWEEP_EVENTS[ptr++] = red[redOffset+istart]\n    SWEEP_EVENTS[ptr++] = -idx\n    SWEEP_EVENTS[ptr++] = red[redOffset+iend]\n    SWEEP_EVENTS[ptr++] = idx\n  }\n  for(var i=blueStart; i<blueEnd; ++i) {\n    var idx = i + 1\n    var blueOffset = elemSize*i\n    SWEEP_EVENTS[ptr++] = blue[blueOffset+istart]\n    SWEEP_EVENTS[ptr++] = -idx\n  }\n\n  //process events from left->right\n  var n = ptr >>> 1\n  isort(SWEEP_EVENTS, n)\n  \n  var redActive    = 0\n  for(var i=0; i<n; ++i) {\n    var e = SWEEP_EVENTS[2*i+1]|0\n    if(e < 0) {\n      var idx   = -e\n      if(idx >= BLUE_FLAG) {\n        RED_SWEEP_QUEUE[redActive++] = idx - BLUE_FLAG\n      } else {\n        idx -= 1\n        var blueId  = blueIndex[idx]\n        var bluePtr = elemSize * idx\n\n        var b0 = blue[bluePtr+axis+1]\n        var b1 = blue[bluePtr+axis+1+d]\n\nred_loop:\n        for(var j=0; j<redActive; ++j) {\n          var oidx   = RED_SWEEP_QUEUE[j]\n          var redId  = redIndex[oidx]\n\n          if(redId === blueId) {\n            break\n          }\n\n          var redPtr = elemSize * oidx\n          if(b1 < red[redPtr+axis+1] || \n            red[redPtr+axis+1+d] < b0) {\n            continue\n          }\n          for(var k=axis+2; k<d; ++k) {\n            if(blue[bluePtr + k + d] < red[redPtr + k] || \n               red[redPtr + k + d]   < blue[bluePtr + k]) {\n              continue red_loop\n            }\n          }\n\n          var retval = visit(redId, blueId)\n          if(retval !== void 0) {\n            return retval \n          }\n        }\n      }\n    } else {\n      var idx = e - BLUE_FLAG\n      for(var j=redActive-1; j>=0; --j) {\n        if(RED_SWEEP_QUEUE[j] === idx) {\n          for(var k=j+1; k<redActive; ++k) {\n            RED_SWEEP_QUEUE[k-1] = RED_SWEEP_QUEUE[k]\n          }\n          break\n        }\n      }\n      --redActive\n    }\n  }\n}","'use strict'\n\nmodule.exports = genPartition\n\nvar code = 'for(var j=2*a,k=j*c,l=k,m=c,n=b,o=a+b,p=c;d>p;++p,k+=j){var _;if($)if(m===p)m+=1,l+=j;else{for(var s=0;j>s;++s){var t=e[k+s];e[k+s]=e[l],e[l++]=t}var u=f[p];f[p]=f[m],f[m++]=u}}return m'\n\nfunction genPartition(predicate, args) {\n  var fargs ='abcdef'.split('').concat(args)\n  var reads = []\n  if(predicate.indexOf('lo') >= 0) {\n    reads.push('lo=e[k+n]')\n  }\n  if(predicate.indexOf('hi') >= 0) {\n    reads.push('hi=e[k+o]')\n  }\n  fargs.push(\n    code.replace('_', reads.join())\n        .replace('$', predicate))\n  return Function.apply(void 0, fargs)\n}","module.exports = clone;\n\n/**\n * Creates a new vec3 initialized with values from an existing vector\n *\n * @param {vec3} a vector to clone\n * @returns {vec3} a new 3D vector\n */\nfunction clone(a) {\n    var out = new Float32Array(3)\n    out[0] = a[0]\n    out[1] = a[1]\n    out[2] = a[2]\n    return out\n}","module.exports = angle\n\nvar fromValues = require('./fromValues')\nvar normalize = require('./normalize')\nvar dot = require('./dot')\n\n/**\n * Get the angle between two 3D vectors\n * @param {vec3} a The first operand\n * @param {vec3} b The second operand\n * @returns {Number} The angle in radians\n */\nfunction angle(a, b) {\n    var tempA = fromValues(a[0], a[1], a[2])\n    var tempB = fromValues(b[0], b[1], b[2])\n \n    normalize(tempA, tempA)\n    normalize(tempB, tempB)\n \n    var cosine = dot(tempA, tempB)\n\n    if(cosine > 1.0){\n        return 0\n    } else {\n        return Math.acos(cosine)\n    }     \n}\n","module.exports = copy;\n\n/**\n * Copy the values from one vec3 to another\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the source vector\n * @returns {vec3} out\n */\nfunction copy(out, a) {\n    out[0] = a[0]\n    out[1] = a[1]\n    out[2] = a[2]\n    return out\n}","module.exports = set;\n\n/**\n * Set the components of a vec3 to the given values\n *\n * @param {vec3} out the receiving vector\n * @param {Number} x X component\n * @param {Number} y Y component\n * @param {Number} z Z component\n * @returns {vec3} out\n */\nfunction set(out, x, y, z) {\n    out[0] = x\n    out[1] = y\n    out[2] = z\n    return out\n}","module.exports = equals\n\nvar EPSILON = require('./epsilon')\n\n/**\n * Returns whether or not the vectors have approximately the same elements in the same position.\n *\n * @param {vec3} a The first vector.\n * @param {vec3} b The second vector.\n * @returns {Boolean} True if the vectors are equal, false otherwise.\n */\nfunction equals(a, b) {\n  var a0 = a[0]\n  var a1 = a[1]\n  var a2 = a[2]\n  var b0 = b[0]\n  var b1 = b[1]\n  var b2 = b[2]\n  return (Math.abs(a0 - b0) <= EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) &&\n          Math.abs(a1 - b1) <= EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) &&\n          Math.abs(a2 - b2) <= EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2)))\n}\n","module.exports = exactEquals\n\n/**\n * Returns whether or not the vectors exactly have the same elements in the same position (when compared with ===)\n *\n * @param {vec3} a The first vector.\n * @param {vec3} b The second vector.\n * @returns {Boolean} True if the vectors are equal, false otherwise.\n */\nfunction exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2]\n}\n","module.exports = add;\n\n/**\n * Adds two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @returns {vec3} out\n */\nfunction add(out, a, b) {\n    out[0] = a[0] + b[0]\n    out[1] = a[1] + b[1]\n    out[2] = a[2] + b[2]\n    return out\n}","module.exports = require('./subtract')\n","module.exports = require('./multiply')\n","module.exports = require('./divide')\n","module.exports = min;\n\n/**\n * Returns the minimum of two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @returns {vec3} out\n */\nfunction min(out, a, b) {\n    out[0] = Math.min(a[0], b[0])\n    out[1] = Math.min(a[1], b[1])\n    out[2] = Math.min(a[2], b[2])\n    return out\n}","module.exports = max;\n\n/**\n * Returns the maximum of two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @returns {vec3} out\n */\nfunction max(out, a, b) {\n    out[0] = Math.max(a[0], b[0])\n    out[1] = Math.max(a[1], b[1])\n    out[2] = Math.max(a[2], b[2])\n    return out\n}","module.exports = floor\n\n/**\n * Math.floor the components of a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a vector to floor\n * @returns {vec3} out\n */\nfunction floor(out, a) {\n  out[0] = Math.floor(a[0])\n  out[1] = Math.floor(a[1])\n  out[2] = Math.floor(a[2])\n  return out\n}\n","module.exports = ceil\n\n/**\n * Math.ceil the components of a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a vector to ceil\n * @returns {vec3} out\n */\nfunction ceil(out, a) {\n  out[0] = Math.ceil(a[0])\n  out[1] = Math.ceil(a[1])\n  out[2] = Math.ceil(a[2])\n  return out\n}\n","module.exports = round\n\n/**\n * Math.round the components of a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a vector to round\n * @returns {vec3} out\n */\nfunction round(out, a) {\n  out[0] = Math.round(a[0])\n  out[1] = Math.round(a[1])\n  out[2] = Math.round(a[2])\n  return out\n}\n","module.exports = scale;\n\n/**\n * Scales a vec3 by a scalar number\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the vector to scale\n * @param {Number} b amount to scale the vector by\n * @returns {vec3} out\n */\nfunction scale(out, a, b) {\n    out[0] = a[0] * b\n    out[1] = a[1] * b\n    out[2] = a[2] * b\n    return out\n}","module.exports = scaleAndAdd;\n\n/**\n * Adds two vec3's after scaling the second operand by a scalar value\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @param {Number} scale the amount to scale b by before adding\n * @returns {vec3} out\n */\nfunction scaleAndAdd(out, a, b, scale) {\n    out[0] = a[0] + (b[0] * scale)\n    out[1] = a[1] + (b[1] * scale)\n    out[2] = a[2] + (b[2] * scale)\n    return out\n}","module.exports = require('./distance')\n","module.exports = require('./squaredDistance')\n","module.exports = require('./length')\n","module.exports = require('./squaredLength')\n","module.exports = negate;\n\n/**\n * Negates the components of a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a vector to negate\n * @returns {vec3} out\n */\nfunction negate(out, a) {\n    out[0] = -a[0]\n    out[1] = -a[1]\n    out[2] = -a[2]\n    return out\n}","module.exports = inverse;\n\n/**\n * Returns the inverse of the components of a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a vector to invert\n * @returns {vec3} out\n */\nfunction inverse(out, a) {\n  out[0] = 1.0 / a[0]\n  out[1] = 1.0 / a[1]\n  out[2] = 1.0 / a[2]\n  return out\n}","module.exports = cross;\n\n/**\n * Computes the cross product of two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @returns {vec3} out\n */\nfunction cross(out, a, b) {\n    var ax = a[0], ay = a[1], az = a[2],\n        bx = b[0], by = b[1], bz = b[2]\n\n    out[0] = ay * bz - az * by\n    out[1] = az * bx - ax * bz\n    out[2] = ax * by - ay * bx\n    return out\n}","module.exports = lerp;\n\n/**\n * Performs a linear interpolation between two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @param {Number} t interpolation amount between the two inputs\n * @returns {vec3} out\n */\nfunction lerp(out, a, b, t) {\n    var ax = a[0],\n        ay = a[1],\n        az = a[2]\n    out[0] = ax + t * (b[0] - ax)\n    out[1] = ay + t * (b[1] - ay)\n    out[2] = az + t * (b[2] - az)\n    return out\n}","module.exports = random;\n\n/**\n * Generates a random vector with the given scale\n *\n * @param {vec3} out the receiving vector\n * @param {Number} [scale] Length of the resulting vector. If ommitted, a unit vector will be returned\n * @returns {vec3} out\n */\nfunction random(out, scale) {\n    scale = scale || 1.0\n\n    var r = Math.random() * 2.0 * Math.PI\n    var z = (Math.random() * 2.0) - 1.0\n    var zScale = Math.sqrt(1.0-z*z) * scale\n\n    out[0] = Math.cos(r) * zScale\n    out[1] = Math.sin(r) * zScale\n    out[2] = z * scale\n    return out\n}","module.exports = transformMat4;\n\n/**\n * Transforms the vec3 with a mat4.\n * 4th vector component is implicitly '1'\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the vector to transform\n * @param {mat4} m matrix to transform with\n * @returns {vec3} out\n */\nfunction transformMat4(out, a, m) {\n    var x = a[0], y = a[1], z = a[2],\n        w = m[3] * x + m[7] * y + m[11] * z + m[15]\n    w = w || 1.0\n    out[0] = (m[0] * x + m[4] * y + m[8] * z + m[12]) / w\n    out[1] = (m[1] * x + m[5] * y + m[9] * z + m[13]) / w\n    out[2] = (m[2] * x + m[6] * y + m[10] * z + m[14]) / w\n    return out\n}","module.exports = transformMat3;\n\n/**\n * Transforms the vec3 with a mat3.\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the vector to transform\n * @param {mat4} m the 3x3 matrix to transform with\n * @returns {vec3} out\n */\nfunction transformMat3(out, a, m) {\n    var x = a[0], y = a[1], z = a[2]\n    out[0] = x * m[0] + y * m[3] + z * m[6]\n    out[1] = x * m[1] + y * m[4] + z * m[7]\n    out[2] = x * m[2] + y * m[5] + z * m[8]\n    return out\n}","module.exports = transformQuat;\n\n/**\n * Transforms the vec3 with a quat\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the vector to transform\n * @param {quat} q quaternion to transform with\n * @returns {vec3} out\n */\nfunction transformQuat(out, a, q) {\n    // benchmarks: http://jsperf.com/quaternion-transform-vec3-implementations\n\n    var x = a[0], y = a[1], z = a[2],\n        qx = q[0], qy = q[1], qz = q[2], qw = q[3],\n\n        // calculate quat * vec\n        ix = qw * x + qy * z - qz * y,\n        iy = qw * y + qz * x - qx * z,\n        iz = qw * z + qx * y - qy * x,\n        iw = -qx * x - qy * y - qz * z\n\n    // calculate result * inverse quat\n    out[0] = ix * qw + iw * -qx + iy * -qz - iz * -qy\n    out[1] = iy * qw + iw * -qy + iz * -qx - ix * -qz\n    out[2] = iz * qw + iw * -qz + ix * -qy - iy * -qx\n    return out\n}","module.exports = rotateX;\n\n/**\n * Rotate a 3D vector around the x-axis\n * @param {vec3} out The receiving vec3\n * @param {vec3} a The vec3 point to rotate\n * @param {vec3} b The origin of the rotation\n * @param {Number} c The angle of rotation\n * @returns {vec3} out\n */\nfunction rotateX(out, a, b, c){\n    var by = b[1]\n    var bz = b[2]\n\n    // Translate point to the origin\n    var py = a[1] - by\n    var pz = a[2] - bz\n\n    var sc = Math.sin(c)\n    var cc = Math.cos(c)\n\n    // perform rotation and translate to correct position\n    out[0] = a[0]\n    out[1] = by + py * cc - pz * sc\n    out[2] = bz + py * sc + pz * cc\n\n    return out\n}\n","module.exports = rotateY;\n\n/**\n * Rotate a 3D vector around the y-axis\n * @param {vec3} out The receiving vec3\n * @param {vec3} a The vec3 point to rotate\n * @param {vec3} b The origin of the rotation\n * @param {Number} c The angle of rotation\n * @returns {vec3} out\n */\nfunction rotateY(out, a, b, c){\n    var bx = b[0]\n    var bz = b[2]\n\n    // translate point to the origin\n    var px = a[0] - bx\n    var pz = a[2] - bz\n    \n    var sc = Math.sin(c)\n    var cc = Math.cos(c)\n  \n    // perform rotation and translate to correct position\n    out[0] = bx + pz * sc + px * cc\n    out[1] = a[1]\n    out[2] = bz + pz * cc - px * sc\n  \n    return out\n}\n","module.exports = rotateZ;\n\n/**\n * Rotate a 3D vector around the z-axis\n * @param {vec3} out The receiving vec3\n * @param {vec3} a The vec3 point to rotate\n * @param {vec3} b The origin of the rotation\n * @param {Number} c The angle of rotation\n * @returns {vec3} out\n */\nfunction rotateZ(out, a, b, c){\n    var bx = b[0]\n    var by = b[1]\n\n    //Translate point to the origin\n    var px = a[0] - bx\n    var py = a[1] - by\n  \n    var sc = Math.sin(c)\n    var cc = Math.cos(c)\n\n    // perform rotation and translate to correct position\n    out[0] = bx + px * cc - py * sc\n    out[1] = by + px * sc + py * cc\n    out[2] = a[2]\n  \n    return out\n}\n","module.exports = forEach;\n\nvar vec = require('./create')()\n\n/**\n * Perform some operation over an array of vec3s.\n *\n * @param {Array} a the array of vectors to iterate over\n * @param {Number} stride Number of elements between the start of each vec3. If 0 assumes tightly packed\n * @param {Number} offset Number of elements to skip at the beginning of the array\n * @param {Number} count Number of vec3s to iterate over. If 0 iterates over entire array\n * @param {Function} fn Function to call for each vector in the array\n * @param {Object} [arg] additional argument to pass to fn\n * @returns {Array} a\n * @function\n */\nfunction forEach(a, stride, offset, count, fn, arg) {\n        var i, l\n        if(!stride) {\n            stride = 3\n        }\n\n        if(!offset) {\n            offset = 0\n        }\n        \n        if(count) {\n            l = Math.min((count * stride) + offset, a.length)\n        } else {\n            l = a.length\n        }\n\n        for(i = offset; i < l; i += stride) {\n            vec[0] = a[i] \n            vec[1] = a[i+1] \n            vec[2] = a[i+2]\n            fn(vec, vec, arg)\n            a[i] = vec[0] \n            a[i+1] = vec[1] \n            a[i+2] = vec[2]\n        }\n        \n        return a\n}","/*!\n * Determine if an object is a Buffer\n *\n * @author   Feross Aboukhadijeh <https://feross.org>\n * @license  MIT\n */\n\n// The _isBuffer check is for Safari 5-7 support, because it's missing\n// Object.prototype.constructor. Remove this eventually\nmodule.exports = function (obj) {\n  return obj != null && (isBuffer(obj) || isSlowBuffer(obj) || !!obj._isBuffer)\n}\n\nfunction isBuffer (obj) {\n  return !!obj.constructor && typeof obj.constructor.isBuffer === 'function' && obj.constructor.isBuffer(obj)\n}\n\n// For Node v0.10 support. Remove this eventually.\nfunction isSlowBuffer (obj) {\n  return typeof obj.readFloatLE === 'function' && typeof obj.slice === 'function' && isBuffer(obj.slice(0, 0))\n}\n","\"use strict\"\n\nfunction traceRay_impl( getVoxel,\n\tpx, py, pz,\n\tdx, dy, dz,\n\tmax_d, hit_pos, hit_norm) {\n\t\n\t// consider raycast vector to be parametrized by t\n\t//   vec = [px,py,pz] + t * [dx,dy,dz]\n\t\n\t// algo below is as described by this paper:\n\t// http://www.cse.chalmers.se/edu/year/2010/course/TDA361/grid.pdf\n\t\n\tvar t = 0.0\n\t\t, floor = Math.floor\n\t\t, ix = floor(px) | 0\n\t\t, iy = floor(py) | 0\n\t\t, iz = floor(pz) | 0\n\n\t\t, stepx = (dx > 0) ? 1 : -1\n\t\t, stepy = (dy > 0) ? 1 : -1\n\t\t, stepz = (dz > 0) ? 1 : -1\n\t\t\n\t// dx,dy,dz are already normalized\n\t\t, txDelta = Math.abs(1 / dx)\n\t\t, tyDelta = Math.abs(1 / dy)\n\t\t, tzDelta = Math.abs(1 / dz)\n\n\t\t, xdist = (stepx > 0) ? (ix + 1 - px) : (px - ix)\n\t\t, ydist = (stepy > 0) ? (iy + 1 - py) : (py - iy)\n\t\t, zdist = (stepz > 0) ? (iz + 1 - pz) : (pz - iz)\n\t\t\n\t// location of nearest voxel boundary, in units of t \n\t\t, txMax = (txDelta < Infinity) ? txDelta * xdist : Infinity\n\t\t, tyMax = (tyDelta < Infinity) ? tyDelta * ydist : Infinity\n\t\t, tzMax = (tzDelta < Infinity) ? tzDelta * zdist : Infinity\n\n\t\t, steppedIndex = -1\n\t\n\t// main loop along raycast vector\n\twhile (t <= max_d) {\n\t\t\n\t\t// exit check\n\t\tvar b = getVoxel(ix, iy, iz)\n\t\tif (b) {\n\t\t\tif (hit_pos) {\n\t\t\t\thit_pos[0] = px + t * dx\n\t\t\t\thit_pos[1] = py + t * dy\n\t\t\t\thit_pos[2] = pz + t * dz\n\t\t\t}\n\t\t\tif (hit_norm) {\n\t\t\t\thit_norm[0] = hit_norm[1] = hit_norm[2] = 0\n\t\t\t\tif (steppedIndex === 0) hit_norm[0] = -stepx\n\t\t\t\tif (steppedIndex === 1) hit_norm[1] = -stepy\n\t\t\t\tif (steppedIndex === 2) hit_norm[2] = -stepz\n\t\t\t}\n\t\t\treturn b\n\t\t}\n\t\t\n\t\t// advance t to next nearest voxel boundary\n\t\tif (txMax < tyMax) {\n\t\t\tif (txMax < tzMax) {\n\t\t\t\tix += stepx\n\t\t\t\tt = txMax\n\t\t\t\ttxMax += txDelta\n\t\t\t\tsteppedIndex = 0\n\t\t\t} else {\n\t\t\t\tiz += stepz\n\t\t\t\tt = tzMax\n\t\t\t\ttzMax += tzDelta\n\t\t\t\tsteppedIndex = 2\n\t\t\t}\n\t\t} else {\n\t\t\tif (tyMax < tzMax) {\n\t\t\t\tiy += stepy\n\t\t\t\tt = tyMax\n\t\t\t\ttyMax += tyDelta\n\t\t\t\tsteppedIndex = 1\n\t\t\t} else {\n\t\t\t\tiz += stepz\n\t\t\t\tt = tzMax\n\t\t\t\ttzMax += tzDelta\n\t\t\t\tsteppedIndex = 2\n\t\t\t}\n\t\t}\n\n\t}\n\t\n\t// no voxel hit found\n\tif (hit_pos) {\n\t\thit_pos[0] = px + t * dx\n\t\thit_pos[1] = py + t * dy\n\t\thit_pos[2] = pz + t * dz\n\t}\n\tif (hit_norm) {\n\t\thit_norm[0] = hit_norm[1] = hit_norm[2] = 0\n\t}\n\n\treturn 0\n\n}\n\n\n// conform inputs\n\nfunction traceRay(getVoxel, origin, direction, max_d, hit_pos, hit_norm) {\n\tvar px = +origin[0]\n\t\t, py = +origin[1]\n\t\t, pz = +origin[2]\n\t\t, dx = +direction[0]\n\t\t, dy = +direction[1]\n\t\t, dz = +direction[2]\n\t\t, ds = Math.sqrt(dx * dx + dy * dy + dz * dz)\n\n\tif (ds === 0) {\n\t\tthrow new Error(\"Can't raycast along a zero vector\")\n\t}\n\n\tdx /= ds\n\tdy /= ds\n\tdz /= ds\n\tif (typeof (max_d) === \"undefined\") {\n\t\tmax_d = 64.0\n\t} else {\n\t\tmax_d = +max_d\n\t}\n\treturn traceRay_impl(getVoxel, px, py, pz, dx, dy, dz, max_d, hit_pos, hit_norm)\n}\n\nmodule.exports = traceRay","\"use strict\"\n\nvar EventEmitter = require(\"events\").EventEmitter\n  , util         = require(\"util\")\n  , domready     = require(\"domready\")\n  , vkey         = require(\"vkey\")\n  , invert       = require(\"invert-hash\")\n  , uniq         = require(\"uniq\")\n  , bsearch      = require(\"binary-search-bounds\")\n  , iota         = require(\"iota-array\")\n  , min          = Math.min\n\n//Browser compatibility hacks\nrequire(\"./lib/raf-polyfill.js\")\nvar addMouseWheel = require(\"./lib/mousewheel-polyfill.js\")\nvar hrtime = require(\"./lib/hrtime-polyfill.js\")\n\n//Remove angle braces and other useless crap\nvar filtered_vkey = (function() {\n  var result = new Array(256)\n    , i, j, k\n  for(i=0; i<256; ++i) {\n    result[i] = \"UNK\"\n  }\n  for(i in vkey) {\n    k = vkey[i]\n    if(k.charAt(0) === '<' && k.charAt(k.length-1) === '>') {\n      k = k.substring(1, k.length-1)\n    }\n    k = k.replace(/\\s/g, \"-\")\n    result[parseInt(i)] = k\n  }\n  return result\n})()\n\n//Compute minimal common set of keyboard functions\nvar keyNames = uniq(Object.keys(invert(filtered_vkey)))\n\n//Translates a virtual keycode to a normalized keycode\nfunction virtualKeyCode(key) {\n  return bsearch.eq(keyNames, key)\n}\n\n//Maps a physical keycode to a normalized keycode\nfunction physicalKeyCode(key) {\n  return virtualKeyCode(filtered_vkey[key])\n}\n\n//Game shell\nfunction GameShell() {\n  EventEmitter.call(this)\n  this._curKeyState  = new Array(keyNames.length)\n  this._pressCount   = new Array(keyNames.length)\n  this._releaseCount = new Array(keyNames.length)\n  \n  this._tickInterval = null\n  this._rafHandle = null\n  this._tickRate = 0\n  this._lastTick = hrtime()\n  this._frameTime = 0.0\n  this._paused = true\n  this._width = 0\n  this._height = 0\n  \n  this._wantFullscreen = false\n  this._wantPointerLock = false\n  this._fullscreenActive = false\n  this._pointerLockActive = false\n  \n  this._rafFunction = tickOrRender.bind(undefined, this, true)\n\n  this.preventDefaults = true\n  this.stopPropagation = false\n  \n  for(var i=0; i<keyNames.length; ++i) {\n    this._curKeyState[i] = false\n    this._pressCount[i] = this._releaseCount[i] = 0\n  }\n  \n  //Public members\n  this.element = null\n  this.bindings = {}\n  this.frameSkip = 100.0\n  this.tickCount = 0\n  this.frameCount = 0\n  this.startTime = hrtime()\n  this.tickTime = this._tickRate\n  this.frameTime = 10.0\n  this.stickyFullscreen = false\n  this.stickyPointerLock = false\n  \n  //Scroll stuff\n  this.scroll = [0,0,0]\n    \n  //Mouse state\n  this.mouseX = 0\n  this.mouseY = 0\n  this.prevMouseX = 0\n  this.prevMouseY = 0\n}\n\nutil.inherits(GameShell, EventEmitter)\n\nvar proto = GameShell.prototype\n\n//Bind keynames\nproto.keyNames = keyNames\n\n//Binds a virtual keyboard event to a physical key\nproto.bind = function(virtual_key) {\n  //Look up previous key bindings\n  var arr\n  if(virtual_key in this.bindings) {\n    arr = this.bindings[virtual_key]\n  } else {\n    arr = []\n  }\n  //Add keys to list\n  var physical_key\n  for(var i=1, n=arguments.length; i<n; ++i) {\n    physical_key = arguments[i]\n    if(virtualKeyCode(physical_key) >= 0) {\n      arr.push(physical_key)\n    } else if(physical_key in this.bindings) {\n      var keybinds = this.bindings[physical_key]\n      for(var j=0; j<keybinds.length; ++j) {\n        arr.push(keybinds[j])\n      }\n    }\n  }\n  //Remove any duplicate keys\n  arr = uniq(arr)\n  if(arr.length > 0) {\n    this.bindings[virtual_key] = arr\n  }\n  this.emit('bind', virtual_key, arr)\n}\n\n//Unbinds a virtual keyboard event\nproto.unbind = function(virtual_key) {\n  if(virtual_key in this.bindings) {\n    delete this.bindings[virtual_key]\n  }\n  this.emit('unbind', virtual_key)\n}\n\n//Checks if a key is set in a given state\nfunction lookupKey(state, bindings, key) {\n  if(key in bindings) {\n    var arr = bindings[key]\n    for(var i=0, n=arr.length; i<n; ++i) {\n      if(state[virtualKeyCode(arr[i])]) {\n        return true\n      }\n    }\n    return false\n  }\n  var kc = virtualKeyCode(key)\n  if(kc >= 0) {\n    return state[kc]\n  }\n  return false\n}\n\n//Checks if a key is set in a given state\nfunction lookupCount(state, bindings, key) {\n  if(key in bindings) {\n    var arr = bindings[key], r = 0\n    for(var i=0, n=arr.length; i<n; ++i) {\n      r += state[virtualKeyCode(arr[i])]\n    }\n    return r\n  }\n  var kc = virtualKeyCode(key)\n  if(kc >= 0) {\n    return state[kc]\n  }\n  return 0\n}\n\n//Checks if a key (either physical or virtual) is currently held down\nproto.down = function(key) {\n  return lookupKey(this._curKeyState, this.bindings, key)\n}\n\n//Checks if a key was ever down\nproto.wasDown = function(key) {\n  return this.down(key) || !!this.press(key)\n}\n\n//Opposite of down\nproto.up = function(key) {\n  return !this.down(key)\n}\n\n//Checks if a key was released during previous frame\nproto.wasUp = function(key) {\n  return this.up(key) || !!this.release(key)\n}\n\n//Returns the number of times a key was pressed since last tick\nproto.press = function(key) {\n  return lookupCount(this._pressCount, this.bindings, key)\n}\n\n//Returns the number of times a key was released since last tick\nproto.release = function(key) {\n  return lookupCount(this._releaseCount, this.bindings, key)\n}\n\n//Pause/unpause the game loop\nObject.defineProperty(proto, \"paused\", {\n  get: function() {\n    return this._paused\n  },\n  set: function(state) {\n    var ns = !!state\n    if(ns !== this._paused) {\n      if(!this._paused) {\n        this._paused = true\n        this._frameTime = min(1.0, (hrtime() - this._lastTick) / this._tickRate)\n        clearInterval(this._tickInterval)\n        //cancelAnimationFrame(this._rafHandle)\n      } else {\n        this._paused = false\n        this._lastTick = hrtime() - Math.floor(this._frameTime * this._tickRate)\n        this._tickInterval = setInterval(tickOrRender, this._tickRate, this, false)\n        this._rafHandle = requestAnimationFrame(this._rafFunction)\n      }\n    }\n  }\n})\n\n//Fullscreen state toggle\n\nfunction tryFullscreen(shell) {\n  //Request full screen\n  var elem = shell.element\n  \n  if(shell._wantFullscreen && !shell._fullscreenActive) {\n    var fs = elem.requestFullscreen ||\n             elem.requestFullScreen ||\n             elem.webkitRequestFullscreen ||\n             elem.webkitRequestFullScreen ||\n             elem.mozRequestFullscreen ||\n             elem.mozRequestFullScreen ||\n             function() {}\n    fs.call(elem)\n  }\n  if(shell._wantPointerLock && !shell._pointerLockActive) {\n    var pl =  elem.requestPointerLock ||\n              elem.webkitRequestPointerLock ||\n              elem.mozRequestPointerLock ||\n              elem.msRequestPointerLock ||\n              elem.oRequestPointerLock ||\n              function() {}\n    pl.call(elem)\n  }\n}\n\nvar cancelFullscreen = document.exitFullscreen ||\n                       document.cancelFullscreen ||  //Why can no one agree on this?\n                       document.cancelFullScreen ||\n                       document.webkitCancelFullscreen ||\n                       document.webkitCancelFullScreen ||\n                       document.mozCancelFullscreen ||\n                       document.mozCancelFullScreen ||\n                       function(){}\n\nObject.defineProperty(proto, \"fullscreen\", {\n  get: function() {\n    return this._fullscreenActive\n  },\n  set: function(state) {\n    var ns = !!state\n    if(!ns) {\n      this._wantFullscreen = false\n      var hasFS = document.fullscreen ||\n                  document.mozFullScreen ||\n                  document.webkitIsFullScreen ||\n                  false\n      if (hasFS) cancelFullscreen.call(document)\n    } else {\n      this._wantFullscreen = true\n      tryFullscreen(this)\n    }\n    return this._fullscreenActive\n  }\n})\n\nfunction handleFullscreen(shell) {\n  shell._fullscreenActive = document.fullscreen ||\n                            document.mozFullScreen ||\n                            document.webkitIsFullScreen ||\n                            false\n  if(!shell.stickyFullscreen && shell._fullscreenActive) {\n    shell._wantFullscreen = false\n  }\n}\n\n//Pointer lock state toggle\nvar exitPointerLock = document.exitPointerLock ||\n                      document.webkitExitPointerLock ||\n                      document.mozExitPointerLock ||\n                      function() {}\n\nObject.defineProperty(proto, \"pointerLock\", {\n  get: function() {\n    return this._pointerLockActive\n  },\n  set: function(state) {\n    var ns = !!state\n    if(!ns) {\n      this._wantPointerLock = false\n      exitPointerLock.call(document)\n    } else {\n      this._wantPointerLock = true\n      tryFullscreen(this)\n    }\n    return this._pointerLockActive\n  }\n})\n\nfunction handlePointerLockChange(shell, event) {\n  shell._pointerLockActive = shell.element === (\n      document.pointerLockElement ||\n      document.mozPointerLockElement ||\n      document.webkitPointerLockElement ||\n      null)\n  if(!shell.stickyPointerLock && shell._pointerLockActive) {\n    shell._wantPointerLock = false\n  }\n}\n\n//Width and height\nObject.defineProperty(proto, \"width\", {\n  get: function() {\n    return this.element.clientWidth\n  }\n})\nObject.defineProperty(proto, \"height\", {\n  get: function() {\n    return this.element.clientHeight\n  }\n})\n\n//Set key state\nfunction setKeyState(shell, key, state) {\n  var ps = shell._curKeyState[key]\n  if(ps !== state) {\n    if(state) {\n      shell._pressCount[key]++\n    } else {\n      shell._releaseCount[key]++\n    }\n    shell._curKeyState[key] = state\n  }\n}\n\nfunction tickOrRender(shell, doRender) {\n  tick(shell)\n  if (doRender) {\n    render(shell)\n  }\n}\n\n//Ticks the game state one update\nfunction tick(shell) {\n  var skip = hrtime() + shell.frameSkip\n    , pCount = shell._pressCount\n    , rCount = shell._releaseCount\n    , i, s, t\n    , tr = shell._tickRate\n    , n = keyNames.length\n  while(!shell._paused &&\n        hrtime() >= shell._lastTick + tr) {\n    \n    //Skip frames if we are over budget\n    if(hrtime() > skip) {\n      shell._lastTick = hrtime() + tr\n      return\n    }\n    \n    //Tick the game\n    s = hrtime()\n    shell.emit(\"tick\")\n    t = hrtime()\n    shell.tickTime = t - s\n    \n    //Update counters and time\n    ++shell.tickCount\n    shell._lastTick += tr\n    \n    //Shift input state\n    for(i=0; i<n; ++i) {\n      pCount[i] = rCount[i] = 0\n    }\n    if(shell._pointerLockActive) {\n      shell.prevMouseX = shell.mouseX = shell.width>>1\n      shell.prevMouseY = shell.mouseY = shell.height>>1\n    } else {\n      shell.prevMouseX = shell.mouseX\n      shell.prevMouseY = shell.mouseY\n    }\n    shell.scroll[0] = shell.scroll[1] = shell.scroll[2] = 0\n  }\n}\n\n//Render stuff\nfunction render(shell) {\n\n  //Request next frame\n  shell._rafHandle = requestAnimationFrame(shell._rafFunction)\n\n  //Compute frame time\n  var dt\n  if(shell._paused) {\n    dt = shell._frameTime\n  } else {\n    dt = min(1.0, (hrtime() - shell._lastTick) / shell._tickRate)\n  }\n  \n  //Draw a frame\n  ++shell.frameCount\n  var s = hrtime()\n  shell.emit(\"render\", dt)\n  var t = hrtime()\n  shell.frameTime = t - s\n  \n}\n\nfunction isFocused(shell) {\n  return (document.activeElement === document.body) ||\n         (document.activeElement === shell.element)\n}\n\nfunction handleEvent(shell, ev) {\n  if(shell.preventDefaults) {\n    ev.preventDefault()\n  }\n  if(shell.stopPropagation) {\n    ev.stopPropagation()\n  }\n}\n\n//Set key up\nfunction handleKeyUp(shell, ev) {\n  handleEvent(shell, ev)\n  var kc = physicalKeyCode(ev.keyCode || ev.char || ev.which || ev.charCode)\n  if(kc >= 0) {\n    setKeyState(shell, kc, false)\n  }\n}\n\n//Set key down\nfunction handleKeyDown(shell, ev) {\n  if(!isFocused(shell)) {\n    return\n  }\n  handleEvent(shell, ev)\n  if(ev.metaKey) {\n    //Hack: Clear key state when meta gets pressed to prevent keys sticking\n    handleBlur(shell, ev)\n  } else {\n    var kc = physicalKeyCode(ev.keyCode || ev.char || ev.which || ev.charCode)\n    if(kc >= 0) {\n      setKeyState(shell, kc, true)\n    }\n  }\n}\n\n//Mouse events are really annoying\nvar mouseCodes = iota(32).map(function(n) {\n  return virtualKeyCode(\"mouse-\" + (n+1))\n})\n\nfunction setMouseButtons(shell, buttons) {\n  for(var i=0; i<32; ++i) {\n    setKeyState(shell, mouseCodes[i], !!(buttons & (1<<i)))\n  }\n}\n\nfunction handleMouseMove(shell, ev) {\n  handleEvent(shell, ev)\n  if(shell._pointerLockActive) {\n    var movementX = ev.movementX       ||\n                    ev.mozMovementX    ||\n                    ev.webkitMovementX ||\n                    0,\n        movementY = ev.movementY       ||\n                    ev.mozMovementY    ||\n                    ev.webkitMovementY ||\n                    0\n    shell.mouseX += movementX\n    shell.mouseY += movementY\n  } else {\n    shell.mouseX = ev.clientX - shell.element.offsetLeft\n    shell.mouseY = ev.clientY - shell.element.offsetTop\n  }\n  return false\n}\n\nfunction handleMouseDown(shell, ev) {\n  handleEvent(shell, ev)\n  setKeyState(shell, mouseCodes[ev.button], true)\n  return false\n}\n\nfunction handleMouseUp(shell, ev) {\n  handleEvent(shell, ev)\n  setKeyState(shell, mouseCodes[ev.button], false)\n  return false\n}\n\nfunction handleMouseEnter(shell, ev) {\n  handleEvent(shell, ev)\n  if(shell._pointerLockActive) {\n    shell.prevMouseX = shell.mouseX = shell.width>>1\n    shell.prevMouseY = shell.mouseY = shell.height>>1\n  } else {\n    shell.prevMouseX = shell.mouseX = ev.clientX - shell.element.offsetLeft\n    shell.prevMouseY = shell.mouseY = ev.clientY - shell.element.offsetTop\n  }\n  return false\n}\n\nfunction handleMouseLeave(shell, ev) {\n  handleEvent(shell, ev)\n  setMouseButtons(shell, 0)\n  return false\n}\n\n//Handle mouse wheel events\nfunction handleMouseWheel(shell, ev) {\n  handleEvent(shell, ev)\n  var scale = 1\n  switch(ev.deltaMode) {\n    case 0: //Pixel\n      scale = 1\n    break\n    case 1: //Line\n      scale = 12\n    break\n    case 2: //Page\n       scale = shell.height\n    break\n  }\n  //Add scroll\n  shell.scroll[0] +=  ev.deltaX * scale\n  shell.scroll[1] +=  ev.deltaY * scale\n  shell.scroll[2] += (ev.deltaZ * scale)||0.0\n  return false\n}\n\nfunction handleContexMenu(shell, ev) {\n  handleEvent(shell, ev)\n  return false\n}\n\nfunction handleBlur(shell, ev) {\n  var n = keyNames.length\n    , c = shell._curKeyState\n    , r = shell._releaseCount\n    , i\n  for(i=0; i<n; ++i) {\n    if(c[i]) {\n      ++r[i]\n    }\n    c[i] = false\n  }\n  return false\n}\n\nfunction handleResizeElement(shell, ev) {\n  var w = shell.element.clientWidth|0\n  var h = shell.element.clientHeight|0\n  if((w !== shell._width) || (h !== shell._height)) {\n    shell._width = w\n    shell._height = h\n    shell.emit(\"resize\", w, h)\n  }\n}\n\nfunction makeDefaultContainer() {\n  var container = document.createElement(\"div\")\n  container.tabindex = 1\n  container.style.position = \"absolute\"\n  container.style.left = \"0px\"\n  container.style.right = \"0px\"\n  container.style.top = \"0px\"\n  container.style.bottom = \"0px\"\n  container.style.height = \"100%\"\n  container.style.overflow = \"hidden\"\n  document.body.appendChild(container)\n  document.body.style.overflow = \"hidden\" //Prevent bounce\n  document.body.style.height = \"100%\"\n  return container\n}\n\nfunction createShell(options) {\n  options = options || {}\n  \n  //Check fullscreen and pointer lock flags\n  var useFullscreen = !!options.fullscreen\n  var usePointerLock = useFullscreen\n  if(typeof options.pointerLock !== undefined) {\n    usePointerLock = !!options.pointerLock\n  }\n  \n  //Create initial shell\n  var shell = new GameShell()\n  shell._tickRate = options.tickRate || 30\n  shell.frameSkip = options.frameSkip || (shell._tickRate+5) * 5\n  shell.stickyFullscreen = !!options.stickyFullscreen || !!options.sticky\n  shell.stickyPointerLock = !!options.stickyPointerLock || !!options.sticky\n  \n  //Set bindings\n  if(options.bindings) {\n    shell.bindings = options.bindings\n  }\n  \n  //Wait for dom to intiailize\n  setTimeout(function() { domready(function initGameShell() {\n    \n    //Retrieve element\n    var element = options.element\n    if(typeof element === \"string\") {\n      var e = document.querySelector(element)\n      if(!e) {\n        e = document.getElementById(element)\n      }\n      if(!e) {\n        e = document.getElementByClass(element)[0]\n      }\n      if(!e) {\n        e = makeDefaultContainer()\n      }\n      shell.element = e\n    } else if(typeof element === \"object\" && !!element) {\n      shell.element = element\n    } else if(typeof element === \"function\") {\n      shell.element = element()\n    } else {\n      shell.element = makeDefaultContainer()\n    }\n    \n    //Disable user-select\n    if(shell.element.style) {\n      shell.element.style[\"-webkit-touch-callout\"] = \"none\"\n      shell.element.style[\"-webkit-user-select\"] = \"none\"\n      shell.element.style[\"-khtml-user-select\"] = \"none\"\n      shell.element.style[\"-moz-user-select\"] = \"none\"\n      shell.element.style[\"-ms-user-select\"] = \"none\"\n      shell.element.style[\"user-select\"] = \"none\"\n    }\n    \n    //Hook resize handler\n    shell._width = shell.element.clientWidth\n    shell._height = shell.element.clientHeight\n    var handleResize = handleResizeElement.bind(undefined, shell)\n    if(typeof MutationObserver !== \"undefined\") {\n      var observer = new MutationObserver(handleResize)\n      observer.observe(shell.element, {\n        attributes: true,\n        subtree: true\n      })\n    } else {\n      shell.element.addEventListener(\"DOMSubtreeModified\", handleResize, false)\n    }\n    window.addEventListener(\"resize\", handleResize, false)\n    \n    //Hook keyboard listener\n    window.addEventListener(\"keydown\", handleKeyDown.bind(undefined, shell), false)\n    window.addEventListener(\"keyup\", handleKeyUp.bind(undefined, shell), false)\n    \n    //Disable right click\n    shell.element.oncontextmenu = handleContexMenu.bind(undefined, shell)\n    \n    //Hook mouse listeners\n    shell.element.addEventListener(\"mousedown\", handleMouseDown.bind(undefined, shell), false)\n    shell.element.addEventListener(\"mouseup\", handleMouseUp.bind(undefined, shell), false)\n    shell.element.addEventListener(\"mousemove\", handleMouseMove.bind(undefined, shell), false)\n    shell.element.addEventListener(\"mouseenter\", handleMouseEnter.bind(undefined, shell), false)\n    \n    //Mouse leave\n    var leave = handleMouseLeave.bind(undefined, shell)\n    shell.element.addEventListener(\"mouseleave\", leave, false)\n    shell.element.addEventListener(\"mouseout\", leave, false)\n    window.addEventListener(\"mouseleave\", leave, false)\n    window.addEventListener(\"mouseout\", leave, false)\n    \n    //Blur event \n    var blur = handleBlur.bind(undefined, shell)\n    shell.element.addEventListener(\"blur\", blur, false)\n    shell.element.addEventListener(\"focusout\", blur, false)\n    shell.element.addEventListener(\"focus\", blur, false)\n    window.addEventListener(\"blur\", blur, false)\n    window.addEventListener(\"focusout\", blur, false)\n    window.addEventListener(\"focus\", blur, false)\n\n    //Mouse wheel handler\n    addMouseWheel(shell.element, handleMouseWheel.bind(undefined, shell), false)\n\n    //Fullscreen handler\n    var fullscreenChange = handleFullscreen.bind(undefined, shell)\n    document.addEventListener(\"fullscreenchange\", fullscreenChange, false)\n    document.addEventListener(\"mozfullscreenchange\", fullscreenChange, false)\n    document.addEventListener(\"webkitfullscreenchange\", fullscreenChange, false)\n\n    //Stupid fullscreen hack\n    shell.element.addEventListener(\"click\", tryFullscreen.bind(undefined, shell), false)\n\n    //Pointer lock change handler\n    var pointerLockChange = handlePointerLockChange.bind(undefined, shell)\n    document.addEventListener(\"pointerlockchange\", pointerLockChange, false)\n    document.addEventListener(\"mozpointerlockchange\", pointerLockChange, false)\n    document.addEventListener(\"webkitpointerlockchange\", pointerLockChange, false)\n    document.addEventListener(\"pointerlocklost\", pointerLockChange, false)\n    document.addEventListener(\"webkitpointerlocklost\", pointerLockChange, false)\n    document.addEventListener(\"mozpointerlocklost\", pointerLockChange, false)\n    \n    //Update flags\n    shell.fullscreen = useFullscreen\n    shell.pointerLock = usePointerLock\n  \n    //Default mouse button aliases\n    shell.bind(\"mouse-left\",   \"mouse-1\")\n    shell.bind(\"mouse-right\",  \"mouse-3\")\n    shell.bind(\"mouse-middle\", \"mouse-2\")\n    \n    //Initialize tick counter\n    shell._lastTick = hrtime()\n    shell.startTime = hrtime()\n\n    //Unpause shell\n    shell.paused = false\n    \n    //Emit initialize event\n    shell.emit(\"init\")\n  })}, 0)\n  \n  return shell\n}\n\nmodule.exports = createShell\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\nvar getOwnPropertyDescriptors = Object.getOwnPropertyDescriptors ||\n  function getOwnPropertyDescriptors(obj) {\n    var keys = Object.keys(obj);\n    var descriptors = {};\n    for (var i = 0; i < keys.length; i++) {\n      descriptors[keys[i]] = Object.getOwnPropertyDescriptor(obj, keys[i]);\n    }\n    return descriptors;\n  };\n\nvar formatRegExp = /%[sdj%]/g;\nexports.format = function(f) {\n  if (!isString(f)) {\n    var objects = [];\n    for (var i = 0; i < arguments.length; i++) {\n      objects.push(inspect(arguments[i]));\n    }\n    return objects.join(' ');\n  }\n\n  var i = 1;\n  var args = arguments;\n  var len = args.length;\n  var str = String(f).replace(formatRegExp, function(x) {\n    if (x === '%%') return '%';\n    if (i >= len) return x;\n    switch (x) {\n      case '%s': return String(args[i++]);\n      case '%d': return Number(args[i++]);\n      case '%j':\n        try {\n          return JSON.stringify(args[i++]);\n        } catch (_) {\n          return '[Circular]';\n        }\n      default:\n        return x;\n    }\n  });\n  for (var x = args[i]; i < len; x = args[++i]) {\n    if (isNull(x) || !isObject(x)) {\n      str += ' ' + x;\n    } else {\n      str += ' ' + inspect(x);\n    }\n  }\n  return str;\n};\n\n\n// Mark that a method should not be used.\n// Returns a modified function which warns once by default.\n// If --no-deprecation is set, then it is a no-op.\nexports.deprecate = function(fn, msg) {\n  if (typeof process !== 'undefined' && process.noDeprecation === true) {\n    return fn;\n  }\n\n  // Allow for deprecating things in the process of starting up.\n  if (typeof process === 'undefined') {\n    return function() {\n      return exports.deprecate(fn, msg).apply(this, arguments);\n    };\n  }\n\n  var warned = false;\n  function deprecated() {\n    if (!warned) {\n      if (process.throwDeprecation) {\n        throw new Error(msg);\n      } else if (process.traceDeprecation) {\n        console.trace(msg);\n      } else {\n        console.error(msg);\n      }\n      warned = true;\n    }\n    return fn.apply(this, arguments);\n  }\n\n  return deprecated;\n};\n\n\nvar debugs = {};\nvar debugEnviron;\nexports.debuglog = function(set) {\n  if (isUndefined(debugEnviron))\n    debugEnviron = process.env.NODE_DEBUG || '';\n  set = set.toUpperCase();\n  if (!debugs[set]) {\n    if (new RegExp('\\\\b' + set + '\\\\b', 'i').test(debugEnviron)) {\n      var pid = process.pid;\n      debugs[set] = function() {\n        var msg = exports.format.apply(exports, arguments);\n        console.error('%s %d: %s', set, pid, msg);\n      };\n    } else {\n      debugs[set] = function() {};\n    }\n  }\n  return debugs[set];\n};\n\n\n/**\n * Echos the value of a value. Trys to print the value out\n * in the best way possible given the different types.\n *\n * @param {Object} obj The object to print out.\n * @param {Object} opts Optional options object that alters the output.\n */\n/* legacy: obj, showHidden, depth, colors*/\nfunction inspect(obj, opts) {\n  // default options\n  var ctx = {\n    seen: [],\n    stylize: stylizeNoColor\n  };\n  // legacy...\n  if (arguments.length >= 3) ctx.depth = arguments[2];\n  if (arguments.length >= 4) ctx.colors = arguments[3];\n  if (isBoolean(opts)) {\n    // legacy...\n    ctx.showHidden = opts;\n  } else if (opts) {\n    // got an \"options\" object\n    exports._extend(ctx, opts);\n  }\n  // set default options\n  if (isUndefined(ctx.showHidden)) ctx.showHidden = false;\n  if (isUndefined(ctx.depth)) ctx.depth = 2;\n  if (isUndefined(ctx.colors)) ctx.colors = false;\n  if (isUndefined(ctx.customInspect)) ctx.customInspect = true;\n  if (ctx.colors) ctx.stylize = stylizeWithColor;\n  return formatValue(ctx, obj, ctx.depth);\n}\nexports.inspect = inspect;\n\n\n// http://en.wikipedia.org/wiki/ANSI_escape_code#graphics\ninspect.colors = {\n  'bold' : [1, 22],\n  'italic' : [3, 23],\n  'underline' : [4, 24],\n  'inverse' : [7, 27],\n  'white' : [37, 39],\n  'grey' : [90, 39],\n  'black' : [30, 39],\n  'blue' : [34, 39],\n  'cyan' : [36, 39],\n  'green' : [32, 39],\n  'magenta' : [35, 39],\n  'red' : [31, 39],\n  'yellow' : [33, 39]\n};\n\n// Don't use 'blue' not visible on cmd.exe\ninspect.styles = {\n  'special': 'cyan',\n  'number': 'yellow',\n  'boolean': 'yellow',\n  'undefined': 'grey',\n  'null': 'bold',\n  'string': 'green',\n  'date': 'magenta',\n  // \"name\": intentionally not styling\n  'regexp': 'red'\n};\n\n\nfunction stylizeWithColor(str, styleType) {\n  var style = inspect.styles[styleType];\n\n  if (style) {\n    return '\\u001b[' + inspect.colors[style][0] + 'm' + str +\n           '\\u001b[' + inspect.colors[style][1] + 'm';\n  } else {\n    return str;\n  }\n}\n\n\nfunction stylizeNoColor(str, styleType) {\n  return str;\n}\n\n\nfunction arrayToHash(array) {\n  var hash = {};\n\n  array.forEach(function(val, idx) {\n    hash[val] = true;\n  });\n\n  return hash;\n}\n\n\nfunction formatValue(ctx, value, recurseTimes) {\n  // Provide a hook for user-specified inspect functions.\n  // Check that value is an object with an inspect function on it\n  if (ctx.customInspect &&\n      value &&\n      isFunction(value.inspect) &&\n      // Filter out the util module, it's inspect function is special\n      value.inspect !== exports.inspect &&\n      // Also filter out any prototype objects using the circular check.\n      !(value.constructor && value.constructor.prototype === value)) {\n    var ret = value.inspect(recurseTimes, ctx);\n    if (!isString(ret)) {\n      ret = formatValue(ctx, ret, recurseTimes);\n    }\n    return ret;\n  }\n\n  // Primitive types cannot have properties\n  var primitive = formatPrimitive(ctx, value);\n  if (primitive) {\n    return primitive;\n  }\n\n  // Look up the keys of the object.\n  var keys = Object.keys(value);\n  var visibleKeys = arrayToHash(keys);\n\n  if (ctx.showHidden) {\n    keys = Object.getOwnPropertyNames(value);\n  }\n\n  // IE doesn't make error fields non-enumerable\n  // http://msdn.microsoft.com/en-us/library/ie/dww52sbt(v=vs.94).aspx\n  if (isError(value)\n      && (keys.indexOf('message') >= 0 || keys.indexOf('description') >= 0)) {\n    return formatError(value);\n  }\n\n  // Some type of object without properties can be shortcutted.\n  if (keys.length === 0) {\n    if (isFunction(value)) {\n      var name = value.name ? ': ' + value.name : '';\n      return ctx.stylize('[Function' + name + ']', 'special');\n    }\n    if (isRegExp(value)) {\n      return ctx.stylize(RegExp.prototype.toString.call(value), 'regexp');\n    }\n    if (isDate(value)) {\n      return ctx.stylize(Date.prototype.toString.call(value), 'date');\n    }\n    if (isError(value)) {\n      return formatError(value);\n    }\n  }\n\n  var base = '', array = false, braces = ['{', '}'];\n\n  // Make Array say that they are Array\n  if (isArray(value)) {\n    array = true;\n    braces = ['[', ']'];\n  }\n\n  // Make functions say that they are functions\n  if (isFunction(value)) {\n    var n = value.name ? ': ' + value.name : '';\n    base = ' [Function' + n + ']';\n  }\n\n  // Make RegExps say that they are RegExps\n  if (isRegExp(value)) {\n    base = ' ' + RegExp.prototype.toString.call(value);\n  }\n\n  // Make dates with properties first say the date\n  if (isDate(value)) {\n    base = ' ' + Date.prototype.toUTCString.call(value);\n  }\n\n  // Make error with message first say the error\n  if (isError(value)) {\n    base = ' ' + formatError(value);\n  }\n\n  if (keys.length === 0 && (!array || value.length == 0)) {\n    return braces[0] + base + braces[1];\n  }\n\n  if (recurseTimes < 0) {\n    if (isRegExp(value)) {\n      return ctx.stylize(RegExp.prototype.toString.call(value), 'regexp');\n    } else {\n      return ctx.stylize('[Object]', 'special');\n    }\n  }\n\n  ctx.seen.push(value);\n\n  var output;\n  if (array) {\n    output = formatArray(ctx, value, recurseTimes, visibleKeys, keys);\n  } else {\n    output = keys.map(function(key) {\n      return formatProperty(ctx, value, recurseTimes, visibleKeys, key, array);\n    });\n  }\n\n  ctx.seen.pop();\n\n  return reduceToSingleString(output, base, braces);\n}\n\n\nfunction formatPrimitive(ctx, value) {\n  if (isUndefined(value))\n    return ctx.stylize('undefined', 'undefined');\n  if (isString(value)) {\n    var simple = '\\'' + JSON.stringify(value).replace(/^\"|\"$/g, '')\n                                             .replace(/'/g, \"\\\\'\")\n                                             .replace(/\\\\\"/g, '\"') + '\\'';\n    return ctx.stylize(simple, 'string');\n  }\n  if (isNumber(value))\n    return ctx.stylize('' + value, 'number');\n  if (isBoolean(value))\n    return ctx.stylize('' + value, 'boolean');\n  // For some reason typeof null is \"object\", so special case here.\n  if (isNull(value))\n    return ctx.stylize('null', 'null');\n}\n\n\nfunction formatError(value) {\n  return '[' + Error.prototype.toString.call(value) + ']';\n}\n\n\nfunction formatArray(ctx, value, recurseTimes, visibleKeys, keys) {\n  var output = [];\n  for (var i = 0, l = value.length; i < l; ++i) {\n    if (hasOwnProperty(value, String(i))) {\n      output.push(formatProperty(ctx, value, recurseTimes, visibleKeys,\n          String(i), true));\n    } else {\n      output.push('');\n    }\n  }\n  keys.forEach(function(key) {\n    if (!key.match(/^\\d+$/)) {\n      output.push(formatProperty(ctx, value, recurseTimes, visibleKeys,\n          key, true));\n    }\n  });\n  return output;\n}\n\n\nfunction formatProperty(ctx, value, recurseTimes, visibleKeys, key, array) {\n  var name, str, desc;\n  desc = Object.getOwnPropertyDescriptor(value, key) || { value: value[key] };\n  if (desc.get) {\n    if (desc.set) {\n      str = ctx.stylize('[Getter/Setter]', 'special');\n    } else {\n      str = ctx.stylize('[Getter]', 'special');\n    }\n  } else {\n    if (desc.set) {\n      str = ctx.stylize('[Setter]', 'special');\n    }\n  }\n  if (!hasOwnProperty(visibleKeys, key)) {\n    name = '[' + key + ']';\n  }\n  if (!str) {\n    if (ctx.seen.indexOf(desc.value) < 0) {\n      if (isNull(recurseTimes)) {\n        str = formatValue(ctx, desc.value, null);\n      } else {\n        str = formatValue(ctx, desc.value, recurseTimes - 1);\n      }\n      if (str.indexOf('\\n') > -1) {\n        if (array) {\n          str = str.split('\\n').map(function(line) {\n            return '  ' + line;\n          }).join('\\n').substr(2);\n        } else {\n          str = '\\n' + str.split('\\n').map(function(line) {\n            return '   ' + line;\n          }).join('\\n');\n        }\n      }\n    } else {\n      str = ctx.stylize('[Circular]', 'special');\n    }\n  }\n  if (isUndefined(name)) {\n    if (array && key.match(/^\\d+$/)) {\n      return str;\n    }\n    name = JSON.stringify('' + key);\n    if (name.match(/^\"([a-zA-Z_][a-zA-Z_0-9]*)\"$/)) {\n      name = name.substr(1, name.length - 2);\n      name = ctx.stylize(name, 'name');\n    } else {\n      name = name.replace(/'/g, \"\\\\'\")\n                 .replace(/\\\\\"/g, '\"')\n                 .replace(/(^\"|\"$)/g, \"'\");\n      name = ctx.stylize(name, 'string');\n    }\n  }\n\n  return name + ': ' + str;\n}\n\n\nfunction reduceToSingleString(output, base, braces) {\n  var numLinesEst = 0;\n  var length = output.reduce(function(prev, cur) {\n    numLinesEst++;\n    if (cur.indexOf('\\n') >= 0) numLinesEst++;\n    return prev + cur.replace(/\\u001b\\[\\d\\d?m/g, '').length + 1;\n  }, 0);\n\n  if (length > 60) {\n    return braces[0] +\n           (base === '' ? '' : base + '\\n ') +\n           ' ' +\n           output.join(',\\n  ') +\n           ' ' +\n           braces[1];\n  }\n\n  return braces[0] + base + ' ' + output.join(', ') + ' ' + braces[1];\n}\n\n\n// NOTE: These type checking functions intentionally don't use `instanceof`\n// because it is fragile and can be easily faked with `Object.create()`.\nfunction isArray(ar) {\n  return Array.isArray(ar);\n}\nexports.isArray = isArray;\n\nfunction isBoolean(arg) {\n  return typeof arg === 'boolean';\n}\nexports.isBoolean = isBoolean;\n\nfunction isNull(arg) {\n  return arg === null;\n}\nexports.isNull = isNull;\n\nfunction isNullOrUndefined(arg) {\n  return arg == null;\n}\nexports.isNullOrUndefined = isNullOrUndefined;\n\nfunction isNumber(arg) {\n  return typeof arg === 'number';\n}\nexports.isNumber = isNumber;\n\nfunction isString(arg) {\n  return typeof arg === 'string';\n}\nexports.isString = isString;\n\nfunction isSymbol(arg) {\n  return typeof arg === 'symbol';\n}\nexports.isSymbol = isSymbol;\n\nfunction isUndefined(arg) {\n  return arg === void 0;\n}\nexports.isUndefined = isUndefined;\n\nfunction isRegExp(re) {\n  return isObject(re) && objectToString(re) === '[object RegExp]';\n}\nexports.isRegExp = isRegExp;\n\nfunction isObject(arg) {\n  return typeof arg === 'object' && arg !== null;\n}\nexports.isObject = isObject;\n\nfunction isDate(d) {\n  return isObject(d) && objectToString(d) === '[object Date]';\n}\nexports.isDate = isDate;\n\nfunction isError(e) {\n  return isObject(e) &&\n      (objectToString(e) === '[object Error]' || e instanceof Error);\n}\nexports.isError = isError;\n\nfunction isFunction(arg) {\n  return typeof arg === 'function';\n}\nexports.isFunction = isFunction;\n\nfunction isPrimitive(arg) {\n  return arg === null ||\n         typeof arg === 'boolean' ||\n         typeof arg === 'number' ||\n         typeof arg === 'string' ||\n         typeof arg === 'symbol' ||  // ES6 symbol\n         typeof arg === 'undefined';\n}\nexports.isPrimitive = isPrimitive;\n\nexports.isBuffer = require('./support/isBuffer');\n\nfunction objectToString(o) {\n  return Object.prototype.toString.call(o);\n}\n\n\nfunction pad(n) {\n  return n < 10 ? '0' + n.toString(10) : n.toString(10);\n}\n\n\nvar months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep',\n              'Oct', 'Nov', 'Dec'];\n\n// 26 Feb 16:19:34\nfunction timestamp() {\n  var d = new Date();\n  var time = [pad(d.getHours()),\n              pad(d.getMinutes()),\n              pad(d.getSeconds())].join(':');\n  return [d.getDate(), months[d.getMonth()], time].join(' ');\n}\n\n\n// log is just a thin wrapper to console.log that prepends a timestamp\nexports.log = function() {\n  console.log('%s - %s', timestamp(), exports.format.apply(exports, arguments));\n};\n\n\n/**\n * Inherit the prototype methods from one constructor into another.\n *\n * The Function.prototype.inherits from lang.js rewritten as a standalone\n * function (not on Function.prototype). NOTE: If this file is to be loaded\n * during bootstrapping this function needs to be rewritten using some native\n * functions as prototype setup using normal JavaScript does not work as\n * expected during bootstrapping (see mirror.js in r114903).\n *\n * @param {function} ctor Constructor function which needs to inherit the\n *     prototype.\n * @param {function} superCtor Constructor function to inherit prototype from.\n */\nexports.inherits = require('inherits');\n\nexports._extend = function(origin, add) {\n  // Don't do anything if add isn't an object\n  if (!add || !isObject(add)) return origin;\n\n  var keys = Object.keys(add);\n  var i = keys.length;\n  while (i--) {\n    origin[keys[i]] = add[keys[i]];\n  }\n  return origin;\n};\n\nfunction hasOwnProperty(obj, prop) {\n  return Object.prototype.hasOwnProperty.call(obj, prop);\n}\n\nvar kCustomPromisifiedSymbol = typeof Symbol !== 'undefined' ? Symbol('util.promisify.custom') : undefined;\n\nexports.promisify = function promisify(original) {\n  if (typeof original !== 'function')\n    throw new TypeError('The \"original\" argument must be of type Function');\n\n  if (kCustomPromisifiedSymbol && original[kCustomPromisifiedSymbol]) {\n    var fn = original[kCustomPromisifiedSymbol];\n    if (typeof fn !== 'function') {\n      throw new TypeError('The \"util.promisify.custom\" argument must be of type Function');\n    }\n    Object.defineProperty(fn, kCustomPromisifiedSymbol, {\n      value: fn, enumerable: false, writable: false, configurable: true\n    });\n    return fn;\n  }\n\n  function fn() {\n    var promiseResolve, promiseReject;\n    var promise = new Promise(function (resolve, reject) {\n      promiseResolve = resolve;\n      promiseReject = reject;\n    });\n\n    var args = [];\n    for (var i = 0; i < arguments.length; i++) {\n      args.push(arguments[i]);\n    }\n    args.push(function (err, value) {\n      if (err) {\n        promiseReject(err);\n      } else {\n        promiseResolve(value);\n      }\n    });\n\n    try {\n      original.apply(this, args);\n    } catch (err) {\n      promiseReject(err);\n    }\n\n    return promise;\n  }\n\n  Object.setPrototypeOf(fn, Object.getPrototypeOf(original));\n\n  if (kCustomPromisifiedSymbol) Object.defineProperty(fn, kCustomPromisifiedSymbol, {\n    value: fn, enumerable: false, writable: false, configurable: true\n  });\n  return Object.defineProperties(\n    fn,\n    getOwnPropertyDescriptors(original)\n  );\n}\n\nexports.promisify.custom = kCustomPromisifiedSymbol\n\nfunction callbackifyOnRejected(reason, cb) {\n  // `!reason` guard inspired by bluebird (Ref: https://goo.gl/t5IS6M).\n  // Because `null` is a special error value in callbacks which means \"no error\n  // occurred\", we error-wrap so the callback consumer can distinguish between\n  // \"the promise rejected with null\" or \"the promise fulfilled with undefined\".\n  if (!reason) {\n    var newReason = new Error('Promise was rejected with a falsy value');\n    newReason.reason = reason;\n    reason = newReason;\n  }\n  return cb(reason);\n}\n\nfunction callbackify(original) {\n  if (typeof original !== 'function') {\n    throw new TypeError('The \"original\" argument must be of type Function');\n  }\n\n  // We DO NOT return the promise as it gives the user a false sense that\n  // the promise is actually somehow related to the callback's execution\n  // and that the callback throwing will reject the promise.\n  function callbackified() {\n    var args = [];\n    for (var i = 0; i < arguments.length; i++) {\n      args.push(arguments[i]);\n    }\n\n    var maybeCb = args.pop();\n    if (typeof maybeCb !== 'function') {\n      throw new TypeError('The last argument must be of type Function');\n    }\n    var self = this;\n    var cb = function() {\n      return maybeCb.apply(self, arguments);\n    };\n    // In true node style we process the callback on `nextTick` with all the\n    // implications (stack, `uncaughtException`, `async_hooks`)\n    original.apply(this, args)\n      .then(function(ret) { process.nextTick(cb, null, ret) },\n            function(rej) { process.nextTick(callbackifyOnRejected, rej, cb) });\n  }\n\n  Object.setPrototypeOf(callbackified, Object.getPrototypeOf(original));\n  Object.defineProperties(callbackified,\n                          getOwnPropertyDescriptors(original));\n  return callbackified;\n}\nexports.callbackify = callbackify;\n","// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] }\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n","module.exports = function isBuffer(arg) {\n  return arg && typeof arg === 'object'\n    && typeof arg.copy === 'function'\n    && typeof arg.fill === 'function'\n    && typeof arg.readUInt8 === 'function';\n}","if (typeof Object.create === 'function') {\n  // implementation from standard node.js 'util' module\n  module.exports = function inherits(ctor, superCtor) {\n    ctor.super_ = superCtor\n    ctor.prototype = Object.create(superCtor.prototype, {\n      constructor: {\n        value: ctor,\n        enumerable: false,\n        writable: true,\n        configurable: true\n      }\n    });\n  };\n} else {\n  // old school shim for old browsers\n  module.exports = function inherits(ctor, superCtor) {\n    ctor.super_ = superCtor\n    var TempCtor = function () {}\n    TempCtor.prototype = superCtor.prototype\n    ctor.prototype = new TempCtor()\n    ctor.prototype.constructor = ctor\n  }\n}\n","/*!\n  * domready (c) Dustin Diaz 2014 - License MIT\n  */\n!function (name, definition) {\n\n  if (typeof module != 'undefined') module.exports = definition()\n  else if (typeof define == 'function' && typeof define.amd == 'object') define(definition)\n  else this[name] = definition()\n\n}('domready', function () {\n\n  var fns = [], listener\n    , doc = document\n    , hack = doc.documentElement.doScroll\n    , domContentLoaded = 'DOMContentLoaded'\n    , loaded = (hack ? /^loaded|^c/ : /^loaded|^i|^c/).test(doc.readyState)\n\n\n  if (!loaded)\n  doc.addEventListener(domContentLoaded, listener = function () {\n    doc.removeEventListener(domContentLoaded, listener)\n    loaded = 1\n    while (listener = fns.shift()) listener()\n  })\n\n  return function (fn) {\n    loaded ? setTimeout(fn, 0) : fns.push(fn)\n  }\n\n});\n","var ua = typeof window !== 'undefined' ? window.navigator.userAgent : ''\n  , isOSX = /OS X/.test(ua)\n  , isOpera = /Opera/.test(ua)\n  , maybeFirefox = !/like Gecko/.test(ua) && !isOpera\n\nvar i, output = module.exports = {\n  0:  isOSX ? '<menu>' : '<UNK>'\n, 1:  '<mouse 1>'\n, 2:  '<mouse 2>'\n, 3:  '<break>'\n, 4:  '<mouse 3>'\n, 5:  '<mouse 4>'\n, 6:  '<mouse 5>'\n, 8:  '<backspace>'\n, 9:  '<tab>'\n, 12: '<clear>'\n, 13: '<enter>'\n, 16: '<shift>'\n, 17: '<control>'\n, 18: '<alt>'\n, 19: '<pause>'\n, 20: '<caps-lock>'\n, 21: '<ime-hangul>'\n, 23: '<ime-junja>'\n, 24: '<ime-final>'\n, 25: '<ime-kanji>'\n, 27: '<escape>'\n, 28: '<ime-convert>'\n, 29: '<ime-nonconvert>'\n, 30: '<ime-accept>'\n, 31: '<ime-mode-change>'\n, 27: '<escape>'\n, 32: '<space>'\n, 33: '<page-up>'\n, 34: '<page-down>'\n, 35: '<end>'\n, 36: '<home>'\n, 37: '<left>'\n, 38: '<up>'\n, 39: '<right>'\n, 40: '<down>'\n, 41: '<select>'\n, 42: '<print>'\n, 43: '<execute>'\n, 44: '<snapshot>'\n, 45: '<insert>'\n, 46: '<delete>'\n, 47: '<help>'\n, 91: '<meta>'  // meta-left -- no one handles left and right properly, so we coerce into one.\n, 92: '<meta>'  // meta-right\n, 93: isOSX ? '<meta>' : '<menu>'      // chrome,opera,safari all report this for meta-right (osx mbp).\n, 95: '<sleep>'\n, 106: '<num-*>'\n, 107: '<num-+>'\n, 108: '<num-enter>'\n, 109: '<num-->'\n, 110: '<num-.>'\n, 111: '<num-/>'\n, 144: '<num-lock>'\n, 145: '<scroll-lock>'\n, 160: '<shift-left>'\n, 161: '<shift-right>'\n, 162: '<control-left>'\n, 163: '<control-right>'\n, 164: '<alt-left>'\n, 165: '<alt-right>'\n, 166: '<browser-back>'\n, 167: '<browser-forward>'\n, 168: '<browser-refresh>'\n, 169: '<browser-stop>'\n, 170: '<browser-search>'\n, 171: '<browser-favorites>'\n, 172: '<browser-home>'\n\n  // ff/osx reports '<volume-mute>' for '-'\n, 173: isOSX && maybeFirefox ? '-' : '<volume-mute>'\n, 174: '<volume-down>'\n, 175: '<volume-up>'\n, 176: '<next-track>'\n, 177: '<prev-track>'\n, 178: '<stop>'\n, 179: '<play-pause>'\n, 180: '<launch-mail>'\n, 181: '<launch-media-select>'\n, 182: '<launch-app 1>'\n, 183: '<launch-app 2>'\n, 186: ';'\n, 187: '='\n, 188: ','\n, 189: '-'\n, 190: '.'\n, 191: '/'\n, 192: '`'\n, 219: '['\n, 220: '\\\\'\n, 221: ']'\n, 222: \"'\"\n, 223: '<meta>'\n, 224: '<meta>'       // firefox reports meta here.\n, 226: '<alt-gr>'\n, 229: '<ime-process>'\n, 231: isOpera ? '`' : '<unicode>'\n, 246: '<attention>'\n, 247: '<crsel>'\n, 248: '<exsel>'\n, 249: '<erase-eof>'\n, 250: '<play>'\n, 251: '<zoom>'\n, 252: '<no-name>'\n, 253: '<pa-1>'\n, 254: '<clear>'\n}\n\nfor(i = 58; i < 65; ++i) {\n  output[i] = String.fromCharCode(i)\n}\n\n// 0-9\nfor(i = 48; i < 58; ++i) {\n  output[i] = (i - 48)+''\n}\n\n// A-Z\nfor(i = 65; i < 91; ++i) {\n  output[i] = String.fromCharCode(i)\n}\n\n// num0-9\nfor(i = 96; i < 106; ++i) {\n  output[i] = '<num-'+(i - 96)+'>'\n}\n\n// F1-F24\nfor(i = 112; i < 136; ++i) {\n  output[i] = 'F'+(i-111)\n}\n","\"use strict\"\n\nfunction invert(hash) {\n  var result = {}\n  for(var i in hash) {\n    if(hash.hasOwnProperty(i)) {\n      result[hash[i]] = i\n    }\n  }\n  return result\n}\n\nmodule.exports = invert","\"use strict\"\n\nfunction unique_pred(list, compare) {\n  var ptr = 1\n    , len = list.length\n    , a=list[0], b=list[0]\n  for(var i=1; i<len; ++i) {\n    b = a\n    a = list[i]\n    if(compare(a, b)) {\n      if(i === ptr) {\n        ptr++\n        continue\n      }\n      list[ptr++] = a\n    }\n  }\n  list.length = ptr\n  return list\n}\n\nfunction unique_eq(list) {\n  var ptr = 1\n    , len = list.length\n    , a=list[0], b = list[0]\n  for(var i=1; i<len; ++i, b=a) {\n    b = a\n    a = list[i]\n    if(a !== b) {\n      if(i === ptr) {\n        ptr++\n        continue\n      }\n      list[ptr++] = a\n    }\n  }\n  list.length = ptr\n  return list\n}\n\nfunction unique(list, compare, sorted) {\n  if(list.length === 0) {\n    return list\n  }\n  if(compare) {\n    if(!sorted) {\n      list.sort(compare)\n    }\n    return unique_pred(list, compare)\n  }\n  if(!sorted) {\n    list.sort()\n  }\n  return unique_eq(list)\n}\n\nmodule.exports = unique\n","\"use strict\"\n\nfunction compileSearch(funcName, predicate, reversed, extraArgs, useNdarray, earlyOut) {\n  var code = [\n    \"function \", funcName, \"(a,l,h,\", extraArgs.join(\",\"),  \"){\",\nearlyOut ? \"\" : \"var i=\", (reversed ? \"l-1\" : \"h+1\"),\n\";while(l<=h){\\\nvar m=(l+h)>>>1,x=a\", useNdarray ? \".get(m)\" : \"[m]\"]\n  if(earlyOut) {\n    if(predicate.indexOf(\"c\") < 0) {\n      code.push(\";if(x===y){return m}else if(x<=y){\")\n    } else {\n      code.push(\";var p=c(x,y);if(p===0){return m}else if(p<=0){\")\n    }\n  } else {\n    code.push(\";if(\", predicate, \"){i=m;\")\n  }\n  if(reversed) {\n    code.push(\"l=m+1}else{h=m-1}\")\n  } else {\n    code.push(\"h=m-1}else{l=m+1}\")\n  }\n  code.push(\"}\")\n  if(earlyOut) {\n    code.push(\"return -1};\")\n  } else {\n    code.push(\"return i};\")\n  }\n  return code.join(\"\")\n}\n\nfunction compileBoundsSearch(predicate, reversed, suffix, earlyOut) {\n  var result = new Function([\n  compileSearch(\"A\", \"x\" + predicate + \"y\", reversed, [\"y\"], false, earlyOut),\n  compileSearch(\"B\", \"x\" + predicate + \"y\", reversed, [\"y\"], true, earlyOut),\n  compileSearch(\"P\", \"c(x,y)\" + predicate + \"0\", reversed, [\"y\", \"c\"], false, earlyOut),\n  compileSearch(\"Q\", \"c(x,y)\" + predicate + \"0\", reversed, [\"y\", \"c\"], true, earlyOut),\n\"function dispatchBsearch\", suffix, \"(a,y,c,l,h){\\\nif(a.shape){\\\nif(typeof(c)==='function'){\\\nreturn Q(a,(l===undefined)?0:l|0,(h===undefined)?a.shape[0]-1:h|0,y,c)\\\n}else{\\\nreturn B(a,(c===undefined)?0:c|0,(l===undefined)?a.shape[0]-1:l|0,y)\\\n}}else{\\\nif(typeof(c)==='function'){\\\nreturn P(a,(l===undefined)?0:l|0,(h===undefined)?a.length-1:h|0,y,c)\\\n}else{\\\nreturn A(a,(c===undefined)?0:c|0,(l===undefined)?a.length-1:l|0,y)\\\n}}}\\\nreturn dispatchBsearch\", suffix].join(\"\"))\n  return result()\n}\n\nmodule.exports = {\n  ge: compileBoundsSearch(\">=\", false, \"GE\"),\n  gt: compileBoundsSearch(\">\", false, \"GT\"),\n  lt: compileBoundsSearch(\"<\", true, \"LT\"),\n  le: compileBoundsSearch(\"<=\", true, \"LE\"),\n  eq: compileBoundsSearch(\"-\", true, \"EQ\", true)\n}\n","// http://paulirish.com/2011/requestanimationframe-for-smart-animating/\n// http://my.opera.com/emoller/blog/2011/12/20/requestanimationframe-for-smart-er-animating\n \n// requestAnimationFrame polyfill by Erik Möller. fixes from Paul Irish and Tino Zijdel\n \n// MIT license\nvar lastTime = 0;\nvar vendors = ['ms', 'moz', 'webkit', 'o'];\nfor(var x = 0; x < vendors.length && !window.requestAnimationFrame; ++x) {\n    window.requestAnimationFrame = window[vendors[x]+'RequestAnimationFrame'];\n    window.cancelAnimationFrame = window[vendors[x]+'CancelAnimationFrame'] \n                               || window[vendors[x]+'CancelRequestAnimationFrame'];\n}\n\nif (!window.requestAnimationFrame)\n    window.requestAnimationFrame = function(callback, element) {\n        var currTime = new Date().getTime();\n        var timeToCall = Math.max(0, 16 - (currTime - lastTime));\n        var id = window.setTimeout(function() { callback(currTime + timeToCall); }, \n          timeToCall);\n        lastTime = currTime + timeToCall;\n        return id;\n    };\n\nif (!window.cancelAnimationFrame)\n    window.cancelAnimationFrame = function(id) {\n        clearTimeout(id);\n    };\n","//Adapted from here: https://developer.mozilla.org/en-US/docs/Web/Reference/Events/wheel?redirectlocale=en-US&redirectslug=DOM%2FMozilla_event_reference%2Fwheel\n\nvar prefix = \"\", _addEventListener, onwheel, support;\n\n// detect event model\nif ( window.addEventListener ) {\n  _addEventListener = \"addEventListener\";\n} else {\n  _addEventListener = \"attachEvent\";\n  prefix = \"on\";\n}\n\n// detect available wheel event\nsupport = \"onwheel\" in document.createElement(\"div\") ? \"wheel\" : // Modern browsers support \"wheel\"\n          document.onmousewheel !== undefined ? \"mousewheel\" : // Webkit and IE support at least \"mousewheel\"\n          \"DOMMouseScroll\"; // let's assume that remaining browsers are older Firefox\n\nfunction _addWheelListener( elem, eventName, callback, useCapture ) {\n  elem[ _addEventListener ]( prefix + eventName, support == \"wheel\" ? callback : function( originalEvent ) {\n    !originalEvent && ( originalEvent = window.event );\n\n    // create a normalized event object\n    var event = {\n      // keep a ref to the original event object\n      originalEvent: originalEvent,\n      target: originalEvent.target || originalEvent.srcElement,\n      type: \"wheel\",\n      deltaMode: originalEvent.type == \"MozMousePixelScroll\" ? 0 : 1,\n      deltaX: 0,\n      delatZ: 0,\n      preventDefault: function() {\n        originalEvent.preventDefault ?\n          originalEvent.preventDefault() :\n          originalEvent.returnValue = false;\n      }\n    };\n    \n    // calculate deltaY (and deltaX) according to the event\n    if ( support == \"mousewheel\" ) {\n      event.deltaY = - 1/40 * originalEvent.wheelDelta;\n      // Webkit also support wheelDeltaX\n      originalEvent.wheelDeltaX && ( event.deltaX = - 1/40 * originalEvent.wheelDeltaX );\n    } else {\n      event.deltaY = originalEvent.detail;\n    }\n\n    // it's time to fire the callback\n    return callback( event );\n  }, useCapture || false );\n}\n\nmodule.exports = function( elem, callback, useCapture ) {\n  _addWheelListener( elem, support, callback, useCapture );\n\n  // handle MozMousePixelScroll in older Firefox\n  if( support == \"DOMMouseScroll\" ) {\n    _addWheelListener( elem, \"MozMousePixelScroll\", callback, useCapture );\n  }\n};","if(typeof window.performance === \"object\") {\n  if(window.performance.now) {\n    module.exports = function() { return window.performance.now() }\n  } else if(window.performance.webkitNow) {\n    module.exports = function() { return window.performance.webkitNow() }\n  }\n} else if(Date.now) {\n  module.exports = Date.now\n} else {\n  module.exports = function() { return (new Date()).getTime() }\n}\n","\nvar vkey = require('vkey')\nvar EventEmitter = require('events').EventEmitter\n// mousewheel polyfill borrowed directly from game-shell\nvar addMouseWheel = require(\"./lib/mousewheel-polyfill.js\")\n\nmodule.exports = function (domElement, options) {\n    return new Inputs(domElement, options)\n}\n\n\n/*\n *   Simple inputs manager to abstract key/mouse inputs.\n *        Inspired by (and where applicable stealing code from) \n *        game-shell: https://github.com/mikolalysenko/game-shell\n *  \n *  inputs.bind( 'move-right', 'D', '<right>' )\n *  inputs.bind( 'move-left',  'A' )\n *  inputs.unbind( 'move-left' )\n *  \n *  inputs.down.on( 'move-right',  function( binding, event ) {})\n *  inputs.up.on(   'move-right',  function( binding, event ) {})\n *\n *  inputs.state['move-right']  // true when corresponding keys are down\n *  inputs.state.dx             // mouse x movement since tick() was last called\n *  inputs.getBindings()        // [ 'move-right', 'move-left', ... ]\n*/\n\n\nfunction Inputs(element, opts) {\n\n    // settings\n    this.element = element || document\n    opts = opts || {}\n    this.preventDefaults = !!opts.preventDefaults\n    this.stopPropagation = !!opts.stopPropagation\n    this.allowContextMenu = !!opts.allowContextMenu\n    this.disabled = !!opts.disabled\n\n    // emitters\n    this.down = new EventEmitter()\n    this.up = new EventEmitter()\n\n    // state object to be queried\n    this.state = {\n        dx: 0, dy: 0,\n        scrollx: 0, scrolly: 0, scrollz: 0\n    }\n\n    // internal state\n    this._keybindmap = {}       // { 'vkeycode' : [ 'binding', 'binding2' ] }\n    this._keyStates = {}        // { 'vkeycode' : boolean }\n    this._bindPressCounts = {}  // { 'binding' : int }\n\n    // needed to work around a bug in Mac Chrome 75\n    // https://bugs.chromium.org/p/chromium/issues/detail?id=977093\n    this._ignoreMousemoveOnce = false\n\n    // register for dom events\n    this.initEvents()\n}\n\n\n/*\n *\n *   PUBLIC API \n *\n*/\n\nInputs.prototype.initEvents = function () {\n    // keys\n    window.addEventListener('keydown', onKeyEvent.bind(undefined, this, true), false)\n    window.addEventListener('keyup', onKeyEvent.bind(undefined, this, false), false)\n    // mouse buttons\n    this.element.addEventListener(\"mousedown\", onMouseEvent.bind(undefined, this, true), false)\n    this.element.addEventListener(\"mouseup\", onMouseEvent.bind(undefined, this, false), false)\n    this.element.oncontextmenu = onContextMenu.bind(undefined, this)\n    // treat dragstart like mouseup - idiotically, mouseup doesn't fire after a drag starts (!)\n    this.element.addEventListener(\"dragstart\", onMouseEvent.bind(undefined, this, false), false)\n    // touch/mouse movement\n    this.element.addEventListener(\"mousemove\", onMouseMove.bind(undefined, this), false)\n    this.element.addEventListener(\"touchmove\", onMouseMove.bind(undefined, this), false)\n    this.element.addEventListener(\"touchstart\", onTouchStart.bind(undefined, this), false)\n    // scroll/mousewheel\n    addMouseWheel(this.element, onMouseWheel.bind(undefined, this), false)\n    // temp bug workaround, see above\n    document.addEventListener(\"pointerlockchange\", onLockChange.bind(undefined, this), false)\n    document.addEventListener(\"mozpointerlockchange\", onLockChange.bind(undefined, this), false)\n}\n\n\n// Usage:  bind( bindingName, vkeyCode, vkeyCode.. )\n//    Note that inputs._keybindmap maps vkey codes to binding names\n//    e.g. this._keybindmap['a'] = 'move-left'\nInputs.prototype.bind = function (binding) {\n    for (var i = 1; i < arguments.length; ++i) {\n        var vkeyCode = arguments[i]\n        var arr = this._keybindmap[vkeyCode] || []\n        if (arr.indexOf(binding) == -1) {\n            arr.push(binding)\n        }\n        this._keybindmap[vkeyCode] = arr\n    }\n    this.state[binding] = !!this.state[binding]\n}\n\n// search out and remove all keycodes bound to a given binding\nInputs.prototype.unbind = function (binding) {\n    for (var b in this._keybindmap) {\n        var arr = this._keybindmap[b]\n        var i = arr.indexOf(binding)\n        if (i > -1) { arr.splice(i, 1) }\n    }\n}\n\n// tick function - clears out cumulative mouse movement state variables\nInputs.prototype.tick = function () {\n    this.state.dx = this.state.dy = 0\n    this.state.scrollx = this.state.scrolly = this.state.scrollz = 0\n}\n\n\n\nInputs.prototype.getBoundKeys = function () {\n    var arr = []\n    for (var b in this._keybindmap) { arr.push(b) }\n    return arr\n}\n\n\n\n/*\n *\n *\n *      INTERNALS - DOM EVENT HANDLERS\n *\n *\n*/\n\n\nfunction onKeyEvent(inputs, wasDown, ev) {\n    handleKeyEvent(ev.keyCode, vkey[ev.keyCode], wasDown, inputs, ev)\n}\n\nfunction onMouseEvent(inputs, wasDown, ev) {\n    // simulate a code out of range of vkey\n    var keycode = -1 - ev.button\n    var vkeycode = '<mouse ' + (ev.button + 1) + '>'\n    handleKeyEvent(keycode, vkeycode, wasDown, inputs, ev)\n    return false\n}\n\nfunction onContextMenu(inputs) {\n    if (!inputs.allowContextMenu) return false\n}\n\nfunction onMouseMove(inputs, ev) {\n    // bug workaround, see top of file\n    if (inputs._ignoreMousemoveOnce) {\n        inputs._ignoreMousemoveOnce = false\n        return\n    }\n    // for now, just populate the state object with mouse movement\n    var dx = ev.movementX || ev.mozMovementX || 0,\n        dy = ev.movementY || ev.mozMovementY || 0\n    // ad-hoc experimental touch support\n    if (ev.touches && (dx | dy) === 0) {\n        var xy = getTouchMovement(ev)\n        dx = xy[0]\n        dy = xy[1]\n    }\n    inputs.state.dx += dx\n    inputs.state.dy += dy\n}\n\n// experimental - for touch events, extract useful dx/dy\nvar lastTouchX = 0\nvar lastTouchY = 0\nvar lastTouchID = null\n\nfunction onTouchStart(inputs, ev) {\n    var touch = ev.changedTouches[0]\n    lastTouchX = touch.clientX\n    lastTouchY = touch.clientY\n    lastTouchID = touch.identifier\n}\n\nfunction getTouchMovement(ev) {\n    var touch\n    var touches = ev.changedTouches\n    for (var i = 0; i < touches.length; ++i) {\n        if (touches[i].identifier == lastTouchID) touch = touches[i]\n    }\n    if (!touch) return [0, 0]\n    var res = [touch.clientX - lastTouchX, touch.clientY - lastTouchY]\n    lastTouchX = touch.clientX\n    lastTouchY = touch.clientY\n    return res\n}\n\nfunction onMouseWheel(inputs, ev) {\n    // basically borrowed from game-shell\n    var scale = 1\n    switch (ev.deltaMode) {\n        case 0: scale = 1; break  // Pixel\n        case 1: scale = 12; break  // Line\n        case 2:  // page\n            // TODO: investigate when this happens, what correct handling is\n            scale = inputs.element.clientHeight || window.innerHeight\n            break\n    }\n    // accumulate state\n    inputs.state.scrollx += ev.deltaX * scale\n    inputs.state.scrolly += ev.deltaY * scale\n    inputs.state.scrollz += (ev.deltaZ * scale) || 0\n    return false\n}\n\nfunction onLockChange(inputs, ev) {\n    var locked = document.pointerLockElement\n        || document.mozPointerLockElement\n        || null\n    if (locked) inputs._ignoreMousemoveOnce = true\n}\n\n\n\n\n/*\n *\n *\n *   KEY BIND HANDLING\n *\n *\n*/\n\n\nfunction handleKeyEvent(keycode, vcode, wasDown, inputs, ev) {\n    var arr = inputs._keybindmap[vcode]\n    // don't prevent defaults if there's no binding\n    if (!arr) { return }\n    if (inputs.preventDefaults) ev.preventDefault()\n    if (inputs.stopPropagation) ev.stopPropagation()\n\n    // if the key's state has changed, handle an event for all bindings\n    var currstate = inputs._keyStates[keycode]\n    if (XOR(currstate, wasDown)) {\n        // for each binding: emit an event, and update cached state information\n        for (var i = 0; i < arr.length; ++i) {\n            handleBindingEvent(arr[i], wasDown, inputs, ev)\n        }\n    }\n    inputs._keyStates[keycode] = wasDown\n}\n\n\nfunction handleBindingEvent(binding, wasDown, inputs, ev) {\n    // keep count of presses mapped by binding\n    // (to handle two keys with the same binding pressed at once)\n    var ct = inputs._bindPressCounts[binding] || 0\n    ct += wasDown ? 1 : -1\n    if (ct < 0) { ct = 0 } // shouldn't happen\n    inputs._bindPressCounts[binding] = ct\n\n    // emit event if binding's state has changed\n    var currstate = inputs.state[binding]\n    if (XOR(currstate, ct)) {\n        var emitter = wasDown ? inputs.down : inputs.up\n        if (!inputs.disabled) emitter.emit(binding, ev)\n    }\n    inputs.state[binding] = !!ct\n}\n\n\n\n\n/*\n *\n *\n *    HELPERS\n *\n *\n*/\n\n\n// how is this not part of Javascript?\nfunction XOR(a, b) {\n    return a ? !b : b\n}\n\n\n\n\n","'use strict'\n\nvar ua = typeof window !== 'undefined' ? window.navigator.userAgent : ''\n  , isOSX = /OS X/.test(ua)\n  , isOpera = /Opera/.test(ua)\n  , maybeFirefox = !/like Gecko/.test(ua) && !isOpera\n\nvar i, output = module.exports = {\n  0:  isOSX ? '<menu>' : '<UNK>'\n, 1:  '<mouse 1>'\n, 2:  '<mouse 2>'\n, 3:  '<break>'\n, 4:  '<mouse 3>'\n, 5:  '<mouse 4>'\n, 6:  '<mouse 5>'\n, 8:  '<backspace>'\n, 9:  '<tab>'\n, 12: '<clear>'\n, 13: '<enter>'\n, 16: '<shift>'\n, 17: '<control>'\n, 18: '<alt>'\n, 19: '<pause>'\n, 20: '<caps-lock>'\n, 21: '<ime-hangul>'\n, 23: '<ime-junja>'\n, 24: '<ime-final>'\n, 25: '<ime-kanji>'\n, 27: '<escape>'\n, 28: '<ime-convert>'\n, 29: '<ime-nonconvert>'\n, 30: '<ime-accept>'\n, 31: '<ime-mode-change>'\n, 32: '<space>'\n, 33: '<page-up>'\n, 34: '<page-down>'\n, 35: '<end>'\n, 36: '<home>'\n, 37: '<left>'\n, 38: '<up>'\n, 39: '<right>'\n, 40: '<down>'\n, 41: '<select>'\n, 42: '<print>'\n, 43: '<execute>'\n, 44: '<snapshot>'\n, 45: '<insert>'\n, 46: '<delete>'\n, 47: '<help>'\n, 91: '<meta>'  // meta-left -- no one handles left and right properly, so we coerce into one.\n, 92: '<meta>'  // meta-right\n, 93: isOSX ? '<meta>' : '<menu>'      // chrome,opera,safari all report this for meta-right (osx mbp).\n, 95: '<sleep>'\n, 106: '<num-*>'\n, 107: '<num-+>'\n, 108: '<num-enter>'\n, 109: '<num-->'\n, 110: '<num-.>'\n, 111: '<num-/>'\n, 144: '<num-lock>'\n, 145: '<scroll-lock>'\n, 160: '<shift-left>'\n, 161: '<shift-right>'\n, 162: '<control-left>'\n, 163: '<control-right>'\n, 164: '<alt-left>'\n, 165: '<alt-right>'\n, 166: '<browser-back>'\n, 167: '<browser-forward>'\n, 168: '<browser-refresh>'\n, 169: '<browser-stop>'\n, 170: '<browser-search>'\n, 171: '<browser-favorites>'\n, 172: '<browser-home>'\n\n  // ff/osx reports '<volume-mute>' for '-'\n, 173: isOSX && maybeFirefox ? '-' : '<volume-mute>'\n, 174: '<volume-down>'\n, 175: '<volume-up>'\n, 176: '<next-track>'\n, 177: '<prev-track>'\n, 178: '<stop>'\n, 179: '<play-pause>'\n, 180: '<launch-mail>'\n, 181: '<launch-media-select>'\n, 182: '<launch-app 1>'\n, 183: '<launch-app 2>'\n, 186: ';'\n, 187: '='\n, 188: ','\n, 189: '-'\n, 190: '.'\n, 191: '/'\n, 192: '`'\n, 219: '['\n, 220: '\\\\'\n, 221: ']'\n, 222: \"'\"\n, 223: '<meta>'\n, 224: '<meta>'       // firefox reports meta here.\n, 226: '<alt-gr>'\n, 229: '<ime-process>'\n, 231: isOpera ? '`' : '<unicode>'\n, 246: '<attention>'\n, 247: '<crsel>'\n, 248: '<exsel>'\n, 249: '<erase-eof>'\n, 250: '<play>'\n, 251: '<zoom>'\n, 252: '<no-name>'\n, 253: '<pa-1>'\n, 254: '<clear>'\n}\n\nfor(i = 58; i < 65; ++i) {\n  output[i] = String.fromCharCode(i)\n}\n\n// 0-9\nfor(i = 48; i < 58; ++i) {\n  output[i] = (i - 48)+''\n}\n\n// A-Z\nfor(i = 65; i < 91; ++i) {\n  output[i] = String.fromCharCode(i)\n}\n\n// num0-9\nfor(i = 96; i < 106; ++i) {\n  output[i] = '<num-'+(i - 96)+'>'\n}\n\n// F1-F24\nfor(i = 112; i < 136; ++i) {\n  output[i] = 'F'+(i-111)\n}\n","//Adapted from here: https://developer.mozilla.org/en-US/docs/Web/Reference/Events/wheel?redirectlocale=en-US&redirectslug=DOM%2FMozilla_event_reference%2Fwheel\n\nvar prefix = \"\", _addEventListener, onwheel, support;\n\n// detect event model\nif ( window.addEventListener ) {\n  _addEventListener = \"addEventListener\";\n} else {\n  _addEventListener = \"attachEvent\";\n  prefix = \"on\";\n}\n\n// detect available wheel event\nsupport = \"onwheel\" in document.createElement(\"div\") ? \"wheel\" : // Modern browsers support \"wheel\"\n          document.onmousewheel !== undefined ? \"mousewheel\" : // Webkit and IE support at least \"mousewheel\"\n          \"DOMMouseScroll\"; // let's assume that remaining browsers are older Firefox\n\nfunction _addWheelListener( elem, eventName, callback, useCapture ) {\n  elem[ _addEventListener ]( prefix + eventName, support == \"wheel\" ? callback : function( originalEvent ) {\n    !originalEvent && ( originalEvent = window.event );\n\n    // create a normalized event object\n    var event = {\n      // keep a ref to the original event object\n      originalEvent: originalEvent,\n      target: originalEvent.target || originalEvent.srcElement,\n      type: \"wheel\",\n      deltaMode: originalEvent.type == \"MozMousePixelScroll\" ? 0 : 1,\n      deltaX: 0,\n      delatZ: 0,\n      preventDefault: function() {\n        originalEvent.preventDefault ?\n          originalEvent.preventDefault() :\n          originalEvent.returnValue = false;\n      }\n    };\n    \n    // calculate deltaY (and deltaX) according to the event\n    if ( support == \"mousewheel\" ) {\n      event.deltaY = - 1/40 * originalEvent.wheelDelta;\n      // Webkit also support wheelDeltaX\n      originalEvent.wheelDeltaX && ( event.deltaX = - 1/40 * originalEvent.wheelDeltaX );\n    } else {\n      event.deltaY = originalEvent.detail;\n    }\n\n    // it's time to fire the callback\n    return callback( event );\n  }, useCapture || false );\n}\n\nmodule.exports = function( elem, callback, useCapture ) {\n  _addWheelListener( elem, support, callback, useCapture );\n\n  // handle MozMousePixelScroll in older Firefox\n  if( support == \"DOMMouseScroll\" ) {\n    _addWheelListener( elem, \"MozMousePixelScroll\", callback, useCapture );\n  }\n};","'use strict'\n\nvar aabb = require('aabb-3d')\nvar vec3 = require('gl-vec3')\nvar sweep = require('voxel-aabb-sweep')\nvar RigidBody = require('./rigidBody')\n\n\nvar DEBUG = 0\n\n\nmodule.exports = function (opts, testSolid, testFluid) {\n    return new Physics(opts, testSolid, testFluid)\n}\n\nvar defaults = {\n    gravity: [0, -10, 0],\n    minBounceImpulse: .5, // lowest collision impulse that bounces\n    airDrag: 0.1,\n    fluidDrag: 0.4,\n    fluidDensity: 2.0,\n}\n\n\n/* \n *    CONSTRUCTOR - represents a world of rigid bodies.\n * \n *  Takes testSolid(x,y,z) function to query block solidity\n *  Takes testFluid(x,y,z) function to query if a block is a fluid\n*/\nfunction Physics(opts, testSolid, testFluid) {\n    opts = Object.assign({}, defaults, opts)\n\n    this.gravity = opts.gravity\n    this.airDrag = opts.airDrag\n    this.fluidDensity = opts.fluidDensity\n    this.fluidDrag = opts.fluidDrag\n    this.minBounceImpulse = opts.minBounceImpulse\n    this.bodies = []\n\n    // collision function - TODO: abstract this into a setter?\n    this.testSolid = testSolid\n    this.testFluid = testFluid\n}\n\n\n/*\n *    ADDING AND REMOVING RIGID BODIES\n*/\n\nPhysics.prototype.addBody = function (_aabb, mass, friction,\n    restitution, gravMult, onCollide) {\n    _aabb = _aabb || new aabb([0, 0, 0], [1, 1, 1])\n    if (typeof mass == 'undefined') mass = 1\n    if (typeof friction == 'undefined') friction = 1\n    if (typeof restitution == 'undefined') restitution = 0\n    if (typeof gravMult == 'undefined') gravMult = 1\n    var b = new RigidBody(_aabb, mass, friction, restitution, gravMult, onCollide)\n    this.bodies.push(b)\n    return b\n}\n\nPhysics.prototype.removeBody = function (b) {\n    var i = this.bodies.indexOf(b)\n    if (i < 0) return undefined\n    this.bodies.splice(i, 1)\n    b.aabb = b.onCollide = null\n}\n\n\n\n\n/*\n *    PHYSICS AND COLLISIONS\n*/\n\nvar a = vec3.create()\nvar dv = vec3.create()\nvar dx = vec3.create()\nvar impacts = vec3.create()\nvar oldResting = vec3.create()\n\n\n/*\n *    TICK HANDLER\n*/\nPhysics.prototype.tick = function (dt) {\n    // convert dt to seconds\n    dt = dt / 1000\n    var noGravity = equals(0, vec3.squaredLength(this.gravity))\n\n    this.bodies.forEach(b => iterateBody(this, b, dt, noGravity))\n}\n\n\n\n/*\n *    PER-BODY MAIN PHYSICS ROUTINE\n*/\n\nfunction iterateBody(self, b, dt, noGravity) {\n    vec3.copy(oldResting, b.resting)\n\n    // treat bodies with <= mass as static\n    if (b.mass <= 0) {\n        vec3.set(b.velocity, 0, 0, 0)\n        vec3.set(b._forces, 0, 0, 0)\n        vec3.set(b._impulses, 0, 0, 0)\n        return\n    }\n\n    // skip bodies if static or no velocity/forces/impulses\n    var localNoGrav = noGravity || (b.gravityMultiplier === 0)\n    if (bodyAsleep(self, b, dt, localNoGrav)) return\n    b._sleepFrameCount--\n\n    // check if under water, if so apply buoyancy and drag forces\n    applyFluidForces(self, b)\n\n    // debug hooks\n    sanityCheck(b._forces)\n    sanityCheck(b._impulses)\n    sanityCheck(b.velocity)\n    sanityCheck(b.resting)\n\n    // semi-implicit Euler integration\n\n    // a = f/m + gravity*gravityMultiplier\n    vec3.scale(a, b._forces, 1 / b.mass)\n    vec3.scaleAndAdd(a, a, self.gravity, b.gravityMultiplier)\n\n    // dv = i/m + a*dt\n    // v1 = v0 + dv\n    vec3.scale(dv, b._impulses, 1 / b.mass)\n    vec3.scaleAndAdd(dv, dv, a, dt)\n    vec3.add(b.velocity, b.velocity, dv)\n\n    // apply friction based on change in velocity this frame\n    if (b.friction) {\n        applyFrictionByAxis(0, b, dv)\n        applyFrictionByAxis(1, b, dv)\n        applyFrictionByAxis(2, b, dv)\n    }\n\n    // linear air or fluid friction - effectively v *= drag\n    // body settings override global settings\n    var drag = (b.airDrag >= 0) ? b.airDrag : self.airDrag\n    if (b.inFluid) {\n        drag = (b.fluidDrag >= 0) ? b.fluidDrag : self.fluidDrag\n        drag *= 1 - (1 - b.ratioInFluid) ** 2\n    }\n    var mult = Math.max(1 - drag * dt / b.mass, 0)\n    vec3.scale(b.velocity, b.velocity, mult)\n\n    // x1-x0 = v1*dt\n    vec3.scale(dx, b.velocity, dt)\n\n    // clear forces and impulses for next timestep\n    vec3.set(b._forces, 0, 0, 0)\n    vec3.set(b._impulses, 0, 0, 0)\n\n    // cache old position for use in autostepping\n    if (b.autoStep) {\n        cloneAABB(tmpBox, b.aabb)\n    }\n\n    // sweeps aabb along dx and accounts for collisions\n    processCollisions(self, b.aabb, dx, b.resting)\n\n    // if autostep, and on ground, run collisions again with stepped up aabb\n    if (b.autoStep) {\n        tryAutoStepping(self, b, tmpBox, dx)\n    }\n\n    // Collision impacts. b.resting shows which axes had collisions:\n    for (var i = 0; i < 3; ++i) {\n        impacts[i] = 0\n        if (b.resting[i]) {\n            // count impact only if wasn't collided last frame\n            if (!oldResting[i]) impacts[i] = -b.velocity[i]\n            b.velocity[i] = 0\n        }\n    }\n    var mag = vec3.length(impacts)\n    if (mag > .001) { // epsilon\n        // send collision event - allows client to optionally change\n        // body's restitution depending on what terrain it hit\n        // event argument is impulse J = m * dv\n        vec3.scale(impacts, impacts, b.mass)\n        if (b.onCollide) b.onCollide(impacts)\n\n        // bounce depending on restitution and minBounceImpulse\n        if (b.restitution > 0 && mag > self.minBounceImpulse) {\n            vec3.scale(impacts, impacts, b.restitution)\n            b.applyImpulse(impacts)\n        }\n    }\n\n\n    // sleep check\n    var vsq = vec3.squaredLength(b.velocity)\n    if (vsq > 1e-5) b._markActive()\n}\n\n\n\n\n\n\n\n\n/*\n *    FLUIDS\n*/\n\nfunction applyFluidForces(self, body) {\n    // First pass at handling fluids. Assumes fluids are settled\n    //   thus, only check at corner of body, and only from bottom up\n    var box = body.aabb\n    var cx = Math.floor(box.base[0])\n    var cz = Math.floor(box.base[2])\n    var y0 = Math.floor(box.base[1])\n    var y1 = Math.floor(box.max[1])\n\n    if (!self.testFluid(cx, y0, cz)) {\n        body.inFluid = false\n        body.ratioInFluid = 0\n        return\n    }\n\n    // body is in a fluid - find out how much of body is submerged\n    var submerged = 1\n    var cy = y0 + 1\n    while (cy <= y1 && self.testFluid(cx, cy, cz)) {\n        submerged++\n        cy++\n    }\n    var fluidLevel = y0 + submerged\n    var heightInFluid = fluidLevel - box.base[1]\n    var ratioInFluid = heightInFluid / box.vec[1]\n    if (ratioInFluid > 1) ratioInFluid = 1\n    var vol = box.vec[0] * box.vec[1] * box.vec[2]\n    var displaced = vol * ratioInFluid\n    // bouyant force = -gravity * fluidDensity * volumeDisplaced\n    var f = _fluidVec\n    vec3.scale(f, self.gravity, -self.fluidDensity * displaced)\n    body.applyForce(f)\n\n    body.inFluid = true\n    body.ratioInFluid = ratioInFluid\n}\n\nvar _fluidVec = vec3.create()\n\n\n\n\n\n/*\n *    FRICTION\n*/\n\n\nfunction applyFrictionByAxis(axis, body, dvel) {\n    // friction applies only if moving into a touched surface\n    var restDir = body.resting[axis]\n    var vNormal = dvel[axis]\n    if (restDir === 0) return\n    if (restDir * vNormal <= 0) return\n\n    // current vel lateral to friction axis\n    vec3.copy(lateralVel, body.velocity)\n    lateralVel[axis] = 0\n    var vCurr = vec3.length(lateralVel)\n    if (equals(vCurr, 0)) return\n\n    // treat current change in velocity as the result of a pseudoforce\n    //        Fpseudo = m*dv/dt\n    // Base friction force on normal component of the pseudoforce\n    //        Ff = u * Fnormal\n    //        Ff = u * m * dvnormal / dt\n    // change in velocity due to friction force\n    //        dvF = dt * Ff / m\n    //            = dt * (u * m * dvnormal / dt) / m\n    //            = u * dvnormal\n    var dvMax = Math.abs(body.friction * vNormal)\n\n    // decrease lateral vel by dvMax (or clamp to zero)\n    var scaler = (vCurr > dvMax) ? (vCurr - dvMax) / vCurr : 0\n    body.velocity[(axis + 1) % 3] *= scaler\n    body.velocity[(axis + 2) % 3] *= scaler\n}\nvar lateralVel = vec3.create()\n\n\n\n\n\n\n/*\n *    COLLISION HANDLER\n*/\n\n// sweep aabb along velocity vector and set resting vector\nfunction processCollisions(self, box, velocity, resting) {\n    vec3.set(resting, 0, 0, 0)\n    return sweep(self.testSolid, box, velocity, function (dist, axis, dir, vec) {\n        resting[axis] = dir\n        vec[axis] = 0\n    })\n}\n\n\n\n\n\n/*\n *    AUTO-STEPPING\n*/\n\nvar tmpBox = new aabb([], [])\nvar tmpResting = vec3.create()\nvar targetPos = vec3.create()\nvar upvec = vec3.create()\nvar leftover = vec3.create()\n\nfunction tryAutoStepping(self, b, oldBox, dx) {\n    if (b.resting[1] >= 0 && !b.inFluid) return\n\n    // // direction movement was blocked before trying a step\n    var xBlocked = (b.resting[0] !== 0)\n    var zBlocked = (b.resting[2] !== 0)\n    if (!(xBlocked || zBlocked)) return\n\n    // continue autostepping only if headed sufficiently into obstruction\n    var ratio = Math.abs(dx[0] / dx[2])\n    var cutoff = 4\n    if (!xBlocked && ratio > cutoff) return\n    if (!zBlocked && ratio < 1 / cutoff) return\n\n    // original target position before being obstructed\n    vec3.add(targetPos, oldBox.base, dx)\n\n    // move towards the target until the first X/Z collision\n    var getVoxels = self.testSolid\n    sweep(getVoxels, oldBox, dx, function (dist, axis, dir, vec) {\n        if (axis === 1) vec[axis] = 0\n        else return true\n    })\n\n    var y = b.aabb.base[1]\n    var ydist = Math.floor(y + 1.001) - y\n    vec3.set(upvec, 0, ydist, 0)\n    var collided = false\n    // sweep up, bailing on any obstruction\n    sweep(getVoxels, oldBox, upvec, function (dist, axis, dir, vec) {\n        collided = true\n        return true\n    })\n    if (collided) return // could't move upwards\n\n    // now move in X/Z however far was left over before hitting the obstruction\n    vec3.subtract(leftover, targetPos, oldBox.base)\n    leftover[1] = 0\n    processCollisions(self, oldBox, leftover, tmpResting)\n\n    // bail if no movement happened in the originally blocked direction\n    if (xBlocked && !equals(oldBox.base[0], targetPos[0])) return\n    if (zBlocked && !equals(oldBox.base[2], targetPos[2])) return\n\n    // done - oldBox is now at the target autostepped position\n    cloneAABB(b.aabb, oldBox)\n    b.resting[0] = tmpResting[0]\n    b.resting[2] = tmpResting[2]\n    if (b.onStep) b.onStep()\n}\n\n\n\n\n\n/*\n *    SLEEP CHECK\n*/\n\nfunction bodyAsleep(self, body, dt, noGravity) {\n    if (body._sleepFrameCount > 0) return false\n    // without gravity bodies stay asleep until a force/impulse wakes them up\n    if (noGravity) return true\n    // otherwise check body is resting against something\n    // i.e. sweep along by distance d = 1/2 g*t^2\n    // and check there's still a collision\n    var isResting = false\n    var gmult = 0.5 * dt * dt * body.gravityMultiplier\n    vec3.scale(sleepVec, self.gravity, gmult)\n    sweep(self.testSolid, body.aabb, sleepVec, function () {\n        isResting = true\n        return true\n    }, true)\n    return isResting\n}\nvar sleepVec = vec3.create()\n\n\n\n\n\nfunction equals(a, b) { return Math.abs(a - b) < 1e-5 }\n\nfunction cloneAABB(tgt, src) {\n    for (var i = 0; i < 3; i++) {\n        tgt.base[i] = src.base[i]\n        tgt.max[i] = src.max[i]\n        tgt.vec[i] = src.vec[i]\n    }\n}\n\n\n\nvar sanityCheck = function () { }\nif (DEBUG) sanityCheck = function (v) {\n    if (isNaN(vec3.length(v))) throw 'Vector with NAN: ', v\n}\n","'use strict'\n\nvar aabb = require('aabb-3d')\nvar vec3 = require('gl-vec3')\n\n\nvar DEBUG = 0\n\n\nmodule.exports = RigidBody\n\n\n\n/*\n *    RIGID BODY - internal data structure\n *  Only AABB bodies right now. Someday will likely need spheres?\n*/\n\nfunction RigidBody(_aabb, mass, friction, restitution, gravMult, onCollide, autoStep) {\n    this.aabb = new aabb(_aabb.base, _aabb.vec) // clone\n    this.mass = mass\n    this.friction = friction\n    this.restitution = restitution\n    this.gravityMultiplier = gravMult\n    this.onCollide = onCollide\n    this.autoStep = !!autoStep\n    this.airDrag = -1   // overrides global airDrag when >= 0\n    this.fluidDrag = -1 // overrides global fluidDrag when >= 0\n    this.onStep = null\n    \n    // internals\n    this.velocity = vec3.create()\n    this.resting = [0, 0, 0]\n    this.inFluid = false\n    this._ratioInFluid = 0\n    this._forces = vec3.create()\n    this._impulses = vec3.create()\n    this._sleepFrameCount = 10 | 0\n}\n\nRigidBody.prototype.setPosition = function (p) {\n    sanityCheck(p)\n    vec3.subtract(p, p, this.aabb.base)\n    this.aabb.translate(p)\n    this._markActive()\n}\nRigidBody.prototype.getPosition = function () {\n    return vec3.clone(this.aabb.base)\n}\nRigidBody.prototype.applyForce = function (f) {\n    sanityCheck(f)\n    vec3.add(this._forces, this._forces, f)\n    this._markActive()\n}\nRigidBody.prototype.applyImpulse = function (i) {\n    sanityCheck(i)\n    vec3.add(this._impulses, this._impulses, i)\n    this._markActive()\n}\nRigidBody.prototype._markActive = function () {\n    this._sleepFrameCount = 10 | 0\n}\n\n\n\n// temp\nRigidBody.prototype.atRestX = function () { return this.resting[0] }\nRigidBody.prototype.atRestY = function () { return this.resting[1] }\nRigidBody.prototype.atRestZ = function () { return this.resting[2] }\n\n\n\n\n\nvar sanityCheck = function () { }\nif (DEBUG) sanityCheck = function (v) {\n    if (isNaN(vec3.length(v))) throw 'Vector with NAN: ', v\n}\n","'use strict'\n\nmodule.exports = ECS\nvar DataStore = require('./dataStore')\n\n\n\n/*!\n * ent-comp: a light, *fast* Entity Component System in JS\n * @url      github.com/andyhall/ent-comp\n * @author   Andy Hall <andy@fenomas.com>\n * @license  MIT\n*/\n\n\n\n/**\n * Constructor for a new entity-component-system manager.\n * \n * ```js\n * var ECS = require('ent-comp')\n * var ecs = new ECS()\n * ```\n * @class\n * @constructor\n * @exports ECS\n * @typicalname ecs\n*/\n\nfunction ECS() {\n\tvar self = this\n\n\t/** \n\t * Hash of component definitions. Also aliased to `comps`.\n\t * \n\t * ```js\n\t * var comp = { name: 'foo' }\n\t * ecs.createComponent(comp)\n\t * ecs.components['foo'] === comp // true\n\t * ecs.comps['foo']               // same\n\t * ```\n\t*/\n\tthis.components = {}\n\tthis.comps = this.components\n\n\n\n\t/*\n\t * \n\t * \t\tinternal properties:\n\t * \n\t*/\n\n\tvar components = this.components\n\n\t// counter for entity IDs\n\tvar UID = 1\n\n\t// Storage for all component state data:\n\t// storage['component-name'] = { hash:{}, list:[] }\n\tvar storage = {}\n\n\t// flat arrays of names of components with systems\n\tvar systems = []\n\tvar renderSystems = []\n\n\t// queues for deferred operations\n\tvar deferredEntityRemovals = []\n\tvar deferredCompRemovals = []\n\tvar deferredMultiCompRemovals = []\n\n\n\t// add references to internals, for debugging/hacking\n\tthis._storage = storage\n\tthis._systems = systems\n\tthis._renderSystems = renderSystems\n\n\n\t/*\n\t * \n\t * \n\t * \t\t\t\tPublic API\n\t * \n\t * \n\t*/\n\n\n\n\n\t/**\n\t * Creates a new entity id (currently just an incrementing integer).\n\t * \n\t * Optionally takes a list of component names to add to the entity (with default state data).\n\t * \n\t * ```js\n\t * var id1 = ecs.createEntity()\n\t * var id2 = ecs.createEntity([ 'some-component', 'other-component' ])\n\t * ```\n\t*/\n\tthis.createEntity = function (compList) {\n\t\tvar id = UID++\n\t\tif (compList && compList.length) {\n\t\t\tcompList.forEach(compName => self.addComponent(id, compName))\n\t\t}\n\t\treturn id\n\t}\n\n\n\n\t/**\n\t * Deletes an entity, which in practice just means removing all its components.\n\t * By default the actual removal is deferred (since entities often\n\t * delete themselves from their system function, etc).\n\t * Pass a truthy second parameter to force immediate removal.\n\t * \n\t * ```js\n\t * ecs.deleteEntity(id)\n\t * ecs.deleteEntity(id2, true) // deletes immediately\n\t * ```\n\t*/\n\tthis.deleteEntity = function (entID, immediately) {\n\t\tif (immediately) {\n\t\t\tdeleteEntityNow(entID)\n\t\t} else {\n\t\t\tdeferredEntityRemovals.push(entID)\n\t\t\tmakeDeferralTimeout()\n\t\t}\n\t\treturn self\n\t}\n\n\n\n\n\n\n\n\t/**\n\t * Creates a new component from a definition object. \n\t * The definition must have a `name`; all other properties are optional.\n\t * \n\t * Returns the component name, to make it easy to grab when the component\n\t * is being `require`d from a module.\n\t * \n\t * ```js\n\t * var comp = {\n\t * \t name: 'some-unique-string',\n\t * \t state: {},\n\t * \t order: 99,\n\t * \t onAdd:        function(id, state){ },\n\t * \t onRemove:     function(id, state){ },\n\t * \t system:       function(dt, states){ },\n\t * \t renderSystem: function(dt, states){ },\n\t * \t multi: false,\n\t * }\n\t * \n\t * var name = ecs.createComponent( comp )\n\t * // name == 'some-unique-string'\n\t * ```\n\t * \n\t * Note the `multi` flag - for components where this is true, a given \n\t * entity can have multiple state objects for that component.\n\t * For multi-components, APIs that would normally return a state object \n\t * (like `getState`) will instead return an array of them.\n\t*/\n\tthis.createComponent = function (compDefn) {\n\t\tif (!compDefn) throw 'Missing component definition'\n\t\tvar name = compDefn.name\n\t\tif (!name) throw 'Component definition must have a name property.'\n\t\tif (typeof name !== 'string') throw 'Component name must be a string.'\n\t\tif (name === '') throw 'Component name must be a non-empty string.'\n\t\tif (storage[name]) throw `Component ${name} already exists.`\n\n\t\t// rebuild definition object for monomorphism\n\t\tvar internalDef = {}\n\t\tinternalDef.name = name\n\t\tinternalDef.order = isNaN(compDefn.order) ? 99 : compDefn.order\n\t\tinternalDef.state = compDefn.state || {}\n\t\tinternalDef.onAdd = compDefn.onAdd || null\n\t\tinternalDef.onRemove = compDefn.onRemove || null\n\t\tinternalDef.system = compDefn.system || null\n\t\tinternalDef.renderSystem = compDefn.renderSystem || null\n\t\tinternalDef.multi = !!compDefn.multi\n\n\t\tcomponents[name] = internalDef\n\t\tstorage[name] = DataStore.create()\n\n\t\tif (internalDef.system) {\n\t\t\tsystems.push(name)\n\t\t\tsystems.sort((a, b) => components[a].order - components[b].order)\n\t\t}\n\t\tif (internalDef.renderSystem) {\n\t\t\trenderSystems.push(name)\n\t\t\trenderSystems.sort((a, b) => components[a].order - components[b].order)\n\t\t}\n\n\t\treturn name\n\t}\n\n\n\n\n\n\t/**\n\t * Deletes the component definition with the given name. \n\t * First removes the component from all entities that have it.\n\t * \n\t * (This probably shouldn't be called in real-world usage - \n\t * better to define all components when you begin and leave them be - \n\t * but it's here if you need it.)\n\t * \n\t * ```js\n\t * ecs.deleteComponent( comp.name )\n\t * ```\n\t*/\n\tthis.deleteComponent = function (compName) {\n\t\tvar data = storage[compName]\n\t\tif (!data) throw `Unknown component: ${compName}`\n\n\t\tdata.list.forEach(obj => {\n\t\t\tvar id = obj.__id || obj[0].__id\n\t\t\tself.removeComponent(id, compName, true)\n\t\t})\n\n\t\tvar i = systems.indexOf(compName)\n\t\tvar j = renderSystems.indexOf(compName)\n\t\tif (i > -1) systems.splice(i, 1)\n\t\tif (j > -1) renderSystems.splice(j, 1)\n\n\t\tdelete components[compName]\n\t\tdelete storage[compName]\n\n\t\treturn self\n\t}\n\n\n\n\n\t/**\n\t * Adds a component to an entity, optionally initializing the state object.\n\t * \n\t * ```js\n\t * ecs.createComponent({\n\t * \tname: 'foo',\n\t * \tstate: { val: 0 }\n\t * })\n\t * ecs.addComponent(id, 'foo', {val:20})\n\t * ecs.getState(id, 'foo').val // 20\n\t * ```\n\t*/\n\tthis.addComponent = function (entID, compName, state) {\n\t\tvar def = components[compName]\n\t\tvar data = storage[compName]\n\t\tif (!data) throw `Unknown component: ${compName}.`\n\n\t\t// if the component is pending removal, remove it so it can be readded\n\t\tvar pendingRemoval = false\n\t\tdeferredCompRemovals.forEach(obj => {\n\t\t\tif (obj.id === entID && obj.compName === compName) pendingRemoval = true\n\t\t})\n\t\tif (pendingRemoval) doDeferredComponentRemovals()\n\n\t\tif (data.hash[entID] && !def.multi) throw `Entity ${entID} already has component: ${compName}.`\n\n\t\t// create new component state object for this entity\n\t\tvar newState = Object.assign({}, { __id: entID }, def.state, state)\n\n\t\t// just in case passed-in state object had an __id property\n\t\tnewState.__id = entID\n\n\t\t// add to dataStore - for multi components, may already be present\n\t\tif (def.multi) {\n\t\t\tvar statesArr = data.hash[entID]\n\t\t\tif (!statesArr) {\n\t\t\t\tstatesArr = []\n\t\t\t\tDataStore.add(data, entID, statesArr)\n\t\t\t}\n\t\t\tstatesArr.push(newState)\n\t\t} else {\n\t\t\tDataStore.add(data, entID, newState)\n\t\t}\n\n\t\t// call handler and return\n\t\tif (def.onAdd) def.onAdd(entID, newState)\n\n\t\treturn this\n\t}\n\n\n\n\t/**\n\t * Checks if an entity has a component.\n\t * \n\t * ```js\n\t * ecs.addComponent(id, 'comp-name')\n\t * ecs.hasComponent(id, 'comp-name') // true\n\t * ```\n\t*/\n\n\tthis.hasComponent = function (entID, compName) {\n\t\tvar data = storage[compName]\n\t\tif (!data) throw `Unknown component: ${compName}.`\n\t\treturn (data.hash[entID] !== undefined)\n\t}\n\n\n\n\n\n\t/**\n\t * Removes a component from an entity, deleting any state data.\n\t * \n\t * ```js\n\t * ecs.removeComponent(id, 'foo', true) // final arg means \"immediately\"\n\t * ecs.hasComponent(id, 'foo')          // false\n\t * ecs.removeComponent(id, 'bar')\n\t * ecs.hasComponent(id, 'bar')          // true, removal is deferred by default\n\t * ```\n\t*/\n\tthis.removeComponent = function (entID, compName, immediately) {\n\t\tvar def = components[compName]\n\t\tvar data = storage[compName]\n\t\tif (!data) throw `Unknown component: ${compName}.`\n\n\t\t// if comp isn't present, fail silently for multi or throw otherwise\n\t\tif (!data.hash[entID]) {\n\t\t\tif (def.multi) return self\n\t\t\telse throw `Entity ${entID} does not have component: ${compName} to remove.`\n\t\t}\n\n\t\t// defer or remove\n\t\tif (immediately) {\n\t\t\tremoveComponentNow(entID, compName)\n\t\t} else {\n\t\t\tdeferredCompRemovals.push({\n\t\t\t\tid: entID,\n\t\t\t\tcompName: compName,\n\t\t\t})\n\t\t\tmakeDeferralTimeout()\n\t\t}\n\n\t\treturn self\n\t}\n\n\n\n\n\n\t/**\n\t * Get the component state for a given entity.\n\t * It will automatically have an `__id` property for the entity id.\n\t * \n\t * ```js\n\t * ecs.createComponent({\n\t * \tname: 'foo',\n\t * \tstate: { val: 0 }\n\t * })\n\t * ecs.addComponent(id, 'foo')\n\t * ecs.getState(id, 'foo').val   // 0\n\t * ecs.getState(id, 'foo').__id  // equals id\n\t * ```\n\t*/\n\n\tthis.getState = function (entID, compName) {\n\t\tvar data = storage[compName]\n\t\tif (!data) throw `Unknown component: ${compName}.`\n\t\treturn data.hash[entID]\n\t}\n\n\n\n\n\t/**\n\t * Get an array of state objects for every entity with the given component. \n\t * Each one will have an `__id` property for the entity id it refers to.\n\t * Don't add or remove elements from the returned list!\n\t * \n\t * ```js\n\t * var arr = ecs.getStatesList('foo')\n\t * // returns something shaped like:\n\t * //   [ {__id:0, x:1}, \n\t * //     {__id:7, x:2}  ]\n\t * ```  \n\t*/\n\n\tECS.prototype.getStatesList = function (compName) {\n\t\tvar data = storage[compName]\n\t\tif (!data) throw `Unknown component: ${compName}.`\n\t\treturn data.list\n\t}\n\n\n\n\n\t/**\n\t * Returns a `getState`-like accessor bound to a given component name. \n\t * The accessor is faster than `getState`, so you may want to create \n\t * an accessor for any component you'll be accessing a lot.\n\t * \n\t * ```js\n\t * ecs.createComponent({\n\t * \tname: 'size',\n\t * \tstate: { val: 0 }\n\t * })\n\t * ecs.addComponent(id, 'size')\n\t * var getSize = ecs.getStateAccessor('size')\n\t * getSize(id).val // 0\n\t * ```  \n\t*/\n\n\tthis.getStateAccessor = function (compName) {\n\t\tif (!storage[compName]) throw `Unknown component: ${compName}.`\n\t\tvar hash = storage[compName].hash\n\t\treturn function (entID) {\n\t\t\treturn hash[entID]\n\t\t}\n\t}\n\n\n\n\n\t/**\n\t * Returns a `hasComponent`-like accessor function bound to a given component name. \n\t * The accessor is much faster than `hasComponent`.\n\t * \n\t * ```js\n\t * ecs.createComponent({\n\t * \tname: 'foo',\n\t * })\n\t * ecs.addComponent(id, 'foo')\n\t * var hasFoo = ecs.getComponentAccessor('foo')\n\t * hasFoo(id) // true\n\t * ```  \n\t*/\n\n\tthis.getComponentAccessor = function (compName) {\n\t\tif (!storage[compName]) throw `Unknown component: ${compName}.`\n\t\tvar hash = storage[compName].hash\n\t\treturn function (entID) {\n\t\t\treturn (hash[entID] !== undefined) // TODO\n\t\t}\n\t}\n\n\n\n\n\n\t/**\n\t * Tells the ECS that a game tick has occurred, causing component \n\t * `system` functions to get called.\n\t * \n\t * The optional parameter simply gets passed to the system functions. \n\t * It's meant to be a timestep, but can be used (or not used) as you like.    \n\t * \n\t * If components have an `order` property, they'll get called in that order\n\t * (lowest to highest). Component order defaults to `99`.\n\t * ```js\n\t * ecs.createComponent({\n\t * \tname: foo,\n\t * \torder: 1,\n\t * \tsystem: function(dt, states) {\n\t * \t\t// states is the same array you'd get from #getStatesList()\n\t * \t\tstates.forEach(state => {\n\t * \t\t\tconsole.log('Entity ID: ', state.__id)\n\t * \t\t})\n\t * \t}\n\t * })\n\t * ecs.tick(30) // triggers log statements\n\t * ```\n\t*/\n\n\tthis.tick = function (dt) {\n\t\trunAllDeferredRemovals()\n\t\tsystems.forEach(compName => {\n\t\t\tvar list = storage[compName].list\n\t\t\tvar comp = components[compName]\n\t\t\tcomp.system(dt, list)\n\t\t})\n\t\trunAllDeferredRemovals()\n\t\treturn self\n\t}\n\n\n\n\t/**\n\t * Functions exactly like `tick`, but calls `renderSystem` functions.\n\t * this effectively gives you a second set of systems that are \n\t * called with separate timing, in case you want to \n\t * [tick and render in separate loops](http://gafferongames.com/game-physics/fix-your-timestep/)\n\t * (which you should!).\n\t * \n\t * ```js\n\t * ecs.createComponent({\n\t * \tname: foo,\n\t * \torder: 5,\n\t * \trenderSystem: function(dt, states) {\n\t * \t\t// states is the same array you'd get from #getStatesList()\n\t * \t}\n\t * })\n\t * ecs.render(1000/60)\n\t * ```\n\t*/\n\n\tthis.render = function (dt) {\n\t\trunAllDeferredRemovals()\n\t\trenderSystems.forEach(compName => {\n\t\t\tvar list = storage[compName].list\n\t\t\tvar comp = components[compName]\n\t\t\tcomp.renderSystem(dt, list)\n\t\t})\n\t\trunAllDeferredRemovals()\n\t\treturn self\n\t}\n\n\n\n\n\t/**\n\t * Removes a particular state instance of a multi-component.\n\t * Pass a final truthy argument to make this happen synchronously - \n\t * but be careful, that will splice an element out of the multi-component array,\n\t * changing the indexes of subsequent elements.\n\t * \n\t * ```js\n\t * ecs.getState(id, 'foo')   // [ state1, state2, state3 ]\n\t * ecs.removeMultiComponent(id, 'foo', 1, true)  // true means: immediately\n\t * ecs.getState(id, 'foo')   // [ state1, state3 ]\n\t * ```\n\t */\n\tthis.removeMultiComponent = function (entID, compName, index, immediately) {\n\t\tvar def = components[compName]\n\t\tvar data = storage[compName]\n\t\tif (!data) throw `Unknown component: ${compName}.`\n\t\tif (!def.multi) throw 'removeMultiComponent called on non-multi component'\n\n\t\t// throw if comp isn't present, or multicomp isn't present at index\n\t\tvar statesArr = data.hash[entID]\n\t\tif (!statesArr || !statesArr[index]) {\n\t\t\tthrow `Multicomponent ${compName} instance not found at index ${index}`\n\t\t}\n\n\t\t// index removals by object, in case indexes change later\n\t\tvar stateToRemove = statesArr[index]\n\t\tif (immediately) {\n\t\t\tremoveMultiCompNow(entID, compName, stateToRemove)\n\t\t} else {\n\t\t\tdeferredMultiCompRemovals.push({\n\t\t\t\tid: entID,\n\t\t\t\tcompName: compName,\n\t\t\t\tstate: stateToRemove,\n\t\t\t})\n\t\t}\n\n\t\treturn self\n\t}\n\n\n\n\n\n\n\n\n\t/*\n\t * \n\t * \n\t *\t\tinternal implementation of various delete operations\n\t * \n\t * \n\t*/\n\n\n\t// delete entity - meaning simply remove all its components\n\tfunction deleteEntityNow(entID) {\n\t\t// For now loop over all components\n\t\t// Could speed this up by keeping a hash of components held by each entity?\n\t\tObject.keys(storage).forEach(compName => {\n\t\t\tvar data = storage[compName]\n\t\t\tif (data.hash[entID]) removeComponentNow(entID, compName)\n\t\t})\n\t}\n\n\n\t// remove given component from an entity\n\tfunction removeComponentNow(entID, compName) {\n\t\tvar def = components[compName]\n\t\tvar data = storage[compName]\n\t\tif (!data) return\n\t\tif (!data.hash[entID]) return // probably got removed twice during deferral\n\n\t\t// call onRemove handler - on each instance for multi components\n\t\tif (def.onRemove) {\n\t\t\tif (def.multi) {\n\t\t\t\tdata.hash[entID].forEach(state => {\n\t\t\t\t\tdef.onRemove(entID, state)\n\t\t\t\t})\n\t\t\t} else {\n\t\t\t\tdef.onRemove(entID, data.hash[entID])\n\t\t\t}\n\t\t}\n\n\t\t// if multi, kill the states array to hopefully free the objects\n\t\tif (def.multi) data.hash[entID].length = 0\n\n\t\t// actual removal from data store\n\t\tDataStore.remove(data, entID)\n\t}\n\n\n\n\t// remove one state from a multi component\n\tfunction removeMultiCompNow(entID, compName, stateObj) {\n\t\tvar def = components[compName]\n\t\tvar data = storage[compName]\n\t\tvar statesArr = data.hash[entID]\n\t\tif (!statesArr) return\n\n\t\tvar i = statesArr.indexOf(stateObj)\n\t\tif (i < 0) return\n\t\tif (def.onRemove) {\n\t\t\tdef.onRemove(entID, stateObj)\n\t\t}\n\t\tstatesArr.splice(i, 1)\n\n\t\t// if this leaves the states list empty, remove the whole component\n\t\tif (statesArr.length === 0) {\n\t\t\tremoveComponentNow(entID, compName)\n\t\t}\n\t}\n\n\n\n\n\n\n\t/*\n\t * \n\t * \n\t *\t\tinternals for handling deferrals\n\t * \n\t * \n\t*/\n\n\n\n\t// debouncer - called whenever a deferral is queued\n\tfunction makeDeferralTimeout() {\n\t\tif (deferralTimeoutPending) return\n\t\tdeferralTimeoutPending = true\n\t\tsetTimeout(function () {\n\t\t\tdeferralTimeoutPending = false\n\t\t\trunAllDeferredRemovals()\n\t\t}, 1)\n\t}\n\tvar deferralTimeoutPending = false\n\n\n\t// Ping all removal queues. \n\t// called before and after tick/render, and after deferrals are queued\n\tfunction runAllDeferredRemovals() {\n\t\tdoDeferredComponentRemovals()\n\t\tdoDeferredMultiComponentRemovals()\n\t\tdoDeferredEntityRemovals()\n\t}\n\n\n\t// entities - queue of entity IDs\n\tfunction doDeferredEntityRemovals() {\n\t\twhile (deferredEntityRemovals.length) {\n\t\t\tvar entID = deferredEntityRemovals.pop()\n\t\t\tdeleteEntityNow(entID)\n\t\t}\n\t}\n\n\n\t// components - queue of { id, compName }\n\tfunction doDeferredComponentRemovals() {\n\t\twhile (deferredCompRemovals.length) {\n\t\t\tvar obj = deferredCompRemovals.pop()\n\t\t\tremoveComponentNow(obj.id, obj.compName)\n\t\t}\n\t}\n\n\n\t// multi components - queue of { id, compName, state }\n\tfunction doDeferredMultiComponentRemovals(ecs) {\n\t\twhile (deferredMultiCompRemovals.length) {\n\t\t\tvar obj = deferredMultiCompRemovals.pop()\n\t\t\tremoveMultiCompNow(obj.id, obj.compName, obj.state)\n\t\t\tobj.state = null\n\t\t}\n\t}\n\n\n\n}\n\n","'use strict'\n\n\n/*\n * \n *      Encapsulates (mostly) a collection of objects, \n *      exposed both as a hash and as an array\n *      _map maps hash id to list index\n * \n *      Note this is a dumb store, it doesn't check any inputs at all.\n *      It also assumes every stored data object is stored like:\n *          DataStore.add(data, 37, {__id:37} )\n * \n*/\n\n\nmodule.exports = {\n\n    create: function () {\n        return {\n            list: [],\n            hash: {},\n            _map: {},\n        }\n    },\n\n\n    add: function (data, id, object) {\n        data.list.push(object)\n        data.hash[id] = object\n        data._map[id] = data.list.length - 1\n    },\n\n\n    remove: function (data, id) {\n        // splice out of list\n        var index = data._map[id]\n        if (index === data.list.length - 1) {\n            data.list.pop()\n        } else {\n            // replace element to be spliced with element from end\n            var movedItem = data.list.pop()\n            data.list[index] = movedItem\n            // watch out, this bit breaks encapsulation by assuming object's contents\n            // alternative would be to look through map for movedID's index\n            var movedID = movedItem.__id || movedItem[0].__id\n            data._map[movedID] = index\n        }\n        // finish\n        delete data.hash[id]\n        delete data._map[id]\n    },\n\n\n}\n\n\n","var map = {\n\t\"./collideEntities.js\": 165,\n\t\"./collideTerrain.js\": 176,\n\t\"./fadeOnZoom.js\": 177,\n\t\"./followsEntity.js\": 178,\n\t\"./mesh.js\": 179,\n\t\"./movement.js\": 180,\n\t\"./physics.js\": 78,\n\t\"./position.js\": 77,\n\t\"./receivesInputs.js\": 181,\n\t\"./shadow.js\": 182,\n\t\"./smoothCamera.js\": 183\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 164;","\nvar boxIntersect = require('box-intersect')\n\n\n/*\n * \tEvery frame, entities with this component will get mutually checked for colliions\n * \n *   * cylinder: flag for checking collisions as a vertical cylindar (rather than AABB)\n *   * collideBits: category for this entity\n *   * collideMask: categories this entity collides with\n *   * callback: function(other_id) - called when `own.collideBits & other.collideMask` is true\n * \n * \n * \t\tNotes:\n * \tSet collideBits=0 for entities like bullets, which can collide with things \n * \t\tbut are never the target of a collision.\n * \tSet collideMask=0 for things with no callback - things that get collided with,\n * \t\tbut don't themselves instigate collisions.\n * \n */\n\n\n\nexport default function (noa) {\n\n    var intervals = []\n\n    return {\n\n        name: 'collideEntities',\n\n        order: 70,\n\n        state: {\n            cylinder: false,\n            collideBits: 1 | 0,\n            collideMask: 1 | 0,\n            callback: null,\n        },\n\n        onAdd: null,\n\n        onRemove: null,\n\n\n        system: function entityCollider(dt, states) {\n            var ents = noa.ents\n\n            // data struct that boxIntersect looks for\n            // - array of [lo, lo, lo, hi, hi, hi] extents\n            for (var i = 0; i < states.length; i++) {\n                var id = states[i].__id\n                var dat = ents.getPositionData(id)\n                intervals[i] = dat._extents\n            }\n            intervals.length = states.length\n\n            // run the intersect library\n            boxIntersect(intervals, function (a, b) {\n                var stateA = states[a]\n                var stateB = states[b]\n                var intervalA = intervals[a]\n                var intervalB = intervals[b]\n                if (cylindricalHitTest(stateA, stateB, intervalA, intervalB)) {\n                    handleCollision(noa, stateA, stateB)\n                }\n            })\n\n        }\n    }\n\n\n\n    /*\n     * \n     * \t\tIMPLEMENTATION\n     * \n     */\n\n\n    function handleCollision(noa, stateA, stateB) {\n        var idA = stateA.__id\n        var idB = stateB.__id\n\n        // entities really do overlap, so check masks and call event handlers\n        if (stateA.collideMask & stateB.collideBits) {\n            if (stateA.callback) stateA.callback(idB)\n        }\n        if (stateB.collideMask & stateA.collideBits) {\n            if (stateB.callback) stateB.callback(idA)\n        }\n\n        // general pairwise handler\n        noa.ents.onPairwiseEntityCollision(idA, idB)\n    }\n\n\n\n    // For entities whose extents overlap, \n    // test if collision still happens when taking cylinder flags into account\n\n    function cylindricalHitTest(stateA, stateB, intervalA, intervalB) {\n        if (stateA.cylinder) {\n            if (stateB.cylinder) {\n                return cylinderCylinderTest(intervalA, intervalB)\n            } else {\n                return cylinderBoxTest(intervalA, intervalB)\n            }\n        } else if (stateB.cylinder) {\n            return cylinderBoxTest(intervalB, intervalA)\n        }\n        return true\n    }\n\n\n\n\n    // Cylinder-cylinder hit test (AABBs are known to overlap)\n    // given their extent arrays [lo, lo, lo, hi, hi, hi]\n\n    function cylinderCylinderTest(a, b) {\n        // distance between cylinder centers\n        var rada = (a[3] - a[0]) / 2\n        var radb = (b[3] - b[0]) / 2\n        var dx = a[0] + rada - (b[0] + radb)\n        var dz = a[2] + rada - (b[2] + radb)\n        // collide if dist <= sum of radii\n        var distsq = dx * dx + dz * dz\n        var radsum = rada + radb\n        return (distsq <= radsum * radsum)\n    }\n\n\n\n\n    // Cylinder-Box hit test (AABBs are known to overlap)\n    // given their extent arrays [lo, lo, lo, hi, hi, hi]\n\n    function cylinderBoxTest(cyl, cube) {\n        // X-z center of cylinder\n        var rad = (cyl[3] - cyl[0]) / 2\n        var cx = cyl[0] + rad\n        var cz = cyl[2] + rad\n        // point in X-Z square closest to cylinder\n        var px = clamp(cx, cube[0], cube[3])\n        var pz = clamp(cz, cube[2], cube[5])\n        // collision if distance from that point to circle <= cylinder radius\n        var dx = px - cx\n        var dz = pz - cz\n        var distsq = dx * dx + dz * dz\n        return (distsq <= rad * rad)\n    }\n\n    function clamp(val, lo, hi) {\n        return (val < lo) ? lo : (val > hi) ? hi : val\n    }\n\n\n\n\n}\n","'use strict'\n\nmodule.exports = boxIntersectWrapper\n\nvar pool = require('typedarray-pool')\nvar sweep = require('./lib/sweep')\nvar boxIntersectIter = require('./lib/intersect')\n\nfunction boxEmpty(d, box) {\n  for(var j=0; j<d; ++j) {\n    if(!(box[j] <= box[j+d])) {\n      return true\n    }\n  }\n  return false\n}\n\n//Unpack boxes into a flat typed array, remove empty boxes\nfunction convertBoxes(boxes, d, data, ids) {\n  var ptr = 0\n  var count = 0\n  for(var i=0, n=boxes.length; i<n; ++i) {\n    var b = boxes[i]\n    if(boxEmpty(d, b)) {\n      continue\n    }\n    for(var j=0; j<2*d; ++j) {\n      data[ptr++] = b[j]\n    }\n    ids[count++] = i\n  }\n  return count\n}\n\n//Perform type conversions, check bounds\nfunction boxIntersect(red, blue, visit, full) {\n  var n = red.length\n  var m = blue.length\n\n  //If either array is empty, then we can skip this whole thing\n  if(n <= 0 || m <= 0) {\n    return\n  }\n\n  //Compute dimension, if it is 0 then we skip\n  var d = (red[0].length)>>>1\n  if(d <= 0) {\n    return\n  }\n\n  var retval\n\n  //Convert red boxes\n  var redList  = pool.mallocDouble(2*d*n)\n  var redIds   = pool.mallocInt32(n)\n  n = convertBoxes(red, d, redList, redIds)\n\n  if(n > 0) {\n    if(d === 1 && full) {\n      //Special case: 1d complete\n      sweep.init(n)\n      retval = sweep.sweepComplete(\n        d, visit, \n        0, n, redList, redIds,\n        0, n, redList, redIds)\n    } else {\n\n      //Convert blue boxes\n      var blueList = pool.mallocDouble(2*d*m)\n      var blueIds  = pool.mallocInt32(m)\n      m = convertBoxes(blue, d, blueList, blueIds)\n\n      if(m > 0) {\n        sweep.init(n+m)\n\n        if(d === 1) {\n          //Special case: 1d bipartite\n          retval = sweep.sweepBipartite(\n            d, visit, \n            0, n, redList,  redIds,\n            0, m, blueList, blueIds)\n        } else {\n          //General case:  d>1\n          retval = boxIntersectIter(\n            d, visit,    full,\n            n, redList,  redIds,\n            m, blueList, blueIds)\n        }\n\n        pool.free(blueList)\n        pool.free(blueIds)\n      }\n    }\n\n    pool.free(redList)\n    pool.free(redIds)\n  }\n\n  return retval\n}\n\n\nvar RESULT\n\nfunction appendItem(i,j) {\n  RESULT.push([i,j])\n}\n\nfunction intersectFullArray(x) {\n  RESULT = []\n  boxIntersect(x, x, appendItem, true)\n  return RESULT\n}\n\nfunction intersectBipartiteArray(x, y) {\n  RESULT = []\n  boxIntersect(x, y, appendItem, false)\n  return RESULT\n}\n\n//User-friendly wrapper, handle full input and no-visitor cases\nfunction boxIntersectWrapper(arg0, arg1, arg2) {\n  var result\n  switch(arguments.length) {\n    case 1:\n      return intersectFullArray(arg0)\n    case 2:\n      if(typeof arg1 === 'function') {\n        return boxIntersect(arg0, arg0, arg1, true)\n      } else {\n        return intersectBipartiteArray(arg0, arg1)\n      }\n    case 3:\n      return boxIntersect(arg0, arg1, arg2, false)\n    default:\n      throw new Error('box-intersect: Invalid arguments')\n  }\n}","\"use strict\"\n\nfunction dupe_array(count, value, i) {\n  var c = count[i]|0\n  if(c <= 0) {\n    return []\n  }\n  var result = new Array(c), j\n  if(i === count.length-1) {\n    for(j=0; j<c; ++j) {\n      result[j] = value\n    }\n  } else {\n    for(j=0; j<c; ++j) {\n      result[j] = dupe_array(count, value, i+1)\n    }\n  }\n  return result\n}\n\nfunction dupe_number(count, value) {\n  var result, i\n  result = new Array(count)\n  for(i=0; i<count; ++i) {\n    result[i] = value\n  }\n  return result\n}\n\nfunction dupe(count, value) {\n  if(typeof value === \"undefined\") {\n    value = 0\n  }\n  switch(typeof count) {\n    case \"number\":\n      if(count > 0) {\n        return dupe_number(count|0, value)\n      }\n    break\n    case \"object\":\n      if(typeof (count.length) === \"number\") {\n        return dupe_array(count, value, 0)\n      }\n    break\n  }\n  return []\n}\n\nmodule.exports = dupe","/*!\n * The buffer module from node.js, for the browser.\n *\n * @author   Feross Aboukhadijeh <http://feross.org>\n * @license  MIT\n */\n/* eslint-disable no-proto */\n\n'use strict'\n\nvar base64 = require('base64-js')\nvar ieee754 = require('ieee754')\nvar isArray = require('isarray')\n\nexports.Buffer = Buffer\nexports.SlowBuffer = SlowBuffer\nexports.INSPECT_MAX_BYTES = 50\n\n/**\n * If `Buffer.TYPED_ARRAY_SUPPORT`:\n *   === true    Use Uint8Array implementation (fastest)\n *   === false   Use Object implementation (most compatible, even IE6)\n *\n * Browsers that support typed arrays are IE 10+, Firefox 4+, Chrome 7+, Safari 5.1+,\n * Opera 11.6+, iOS 4.2+.\n *\n * Due to various browser bugs, sometimes the Object implementation will be used even\n * when the browser supports typed arrays.\n *\n * Note:\n *\n *   - Firefox 4-29 lacks support for adding new properties to `Uint8Array` instances,\n *     See: https://bugzilla.mozilla.org/show_bug.cgi?id=695438.\n *\n *   - Chrome 9-10 is missing the `TypedArray.prototype.subarray` function.\n *\n *   - IE10 has a broken `TypedArray.prototype.subarray` function which returns arrays of\n *     incorrect length in some situations.\n\n * We detect these buggy browsers and set `Buffer.TYPED_ARRAY_SUPPORT` to `false` so they\n * get the Object implementation, which is slower but behaves correctly.\n */\nBuffer.TYPED_ARRAY_SUPPORT = global.TYPED_ARRAY_SUPPORT !== undefined\n  ? global.TYPED_ARRAY_SUPPORT\n  : typedArraySupport()\n\n/*\n * Export kMaxLength after typed array support is determined.\n */\nexports.kMaxLength = kMaxLength()\n\nfunction typedArraySupport () {\n  try {\n    var arr = new Uint8Array(1)\n    arr.__proto__ = {__proto__: Uint8Array.prototype, foo: function () { return 42 }}\n    return arr.foo() === 42 && // typed array instances can be augmented\n        typeof arr.subarray === 'function' && // chrome 9-10 lack `subarray`\n        arr.subarray(1, 1).byteLength === 0 // ie10 has broken `subarray`\n  } catch (e) {\n    return false\n  }\n}\n\nfunction kMaxLength () {\n  return Buffer.TYPED_ARRAY_SUPPORT\n    ? 0x7fffffff\n    : 0x3fffffff\n}\n\nfunction createBuffer (that, length) {\n  if (kMaxLength() < length) {\n    throw new RangeError('Invalid typed array length')\n  }\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    // Return an augmented `Uint8Array` instance, for best performance\n    that = new Uint8Array(length)\n    that.__proto__ = Buffer.prototype\n  } else {\n    // Fallback: Return an object instance of the Buffer class\n    if (that === null) {\n      that = new Buffer(length)\n    }\n    that.length = length\n  }\n\n  return that\n}\n\n/**\n * The Buffer constructor returns instances of `Uint8Array` that have their\n * prototype changed to `Buffer.prototype`. Furthermore, `Buffer` is a subclass of\n * `Uint8Array`, so the returned instances will have all the node `Buffer` methods\n * and the `Uint8Array` methods. Square bracket notation works as expected -- it\n * returns a single octet.\n *\n * The `Uint8Array` prototype remains unmodified.\n */\n\nfunction Buffer (arg, encodingOrOffset, length) {\n  if (!Buffer.TYPED_ARRAY_SUPPORT && !(this instanceof Buffer)) {\n    return new Buffer(arg, encodingOrOffset, length)\n  }\n\n  // Common case.\n  if (typeof arg === 'number') {\n    if (typeof encodingOrOffset === 'string') {\n      throw new Error(\n        'If encoding is specified then the first argument must be a string'\n      )\n    }\n    return allocUnsafe(this, arg)\n  }\n  return from(this, arg, encodingOrOffset, length)\n}\n\nBuffer.poolSize = 8192 // not used by this implementation\n\n// TODO: Legacy, not needed anymore. Remove in next major version.\nBuffer._augment = function (arr) {\n  arr.__proto__ = Buffer.prototype\n  return arr\n}\n\nfunction from (that, value, encodingOrOffset, length) {\n  if (typeof value === 'number') {\n    throw new TypeError('\"value\" argument must not be a number')\n  }\n\n  if (typeof ArrayBuffer !== 'undefined' && value instanceof ArrayBuffer) {\n    return fromArrayBuffer(that, value, encodingOrOffset, length)\n  }\n\n  if (typeof value === 'string') {\n    return fromString(that, value, encodingOrOffset)\n  }\n\n  return fromObject(that, value)\n}\n\n/**\n * Functionally equivalent to Buffer(arg, encoding) but throws a TypeError\n * if value is a number.\n * Buffer.from(str[, encoding])\n * Buffer.from(array)\n * Buffer.from(buffer)\n * Buffer.from(arrayBuffer[, byteOffset[, length]])\n **/\nBuffer.from = function (value, encodingOrOffset, length) {\n  return from(null, value, encodingOrOffset, length)\n}\n\nif (Buffer.TYPED_ARRAY_SUPPORT) {\n  Buffer.prototype.__proto__ = Uint8Array.prototype\n  Buffer.__proto__ = Uint8Array\n  if (typeof Symbol !== 'undefined' && Symbol.species &&\n      Buffer[Symbol.species] === Buffer) {\n    // Fix subarray() in ES2016. See: https://github.com/feross/buffer/pull/97\n    Object.defineProperty(Buffer, Symbol.species, {\n      value: null,\n      configurable: true\n    })\n  }\n}\n\nfunction assertSize (size) {\n  if (typeof size !== 'number') {\n    throw new TypeError('\"size\" argument must be a number')\n  } else if (size < 0) {\n    throw new RangeError('\"size\" argument must not be negative')\n  }\n}\n\nfunction alloc (that, size, fill, encoding) {\n  assertSize(size)\n  if (size <= 0) {\n    return createBuffer(that, size)\n  }\n  if (fill !== undefined) {\n    // Only pay attention to encoding if it's a string. This\n    // prevents accidentally sending in a number that would\n    // be interpretted as a start offset.\n    return typeof encoding === 'string'\n      ? createBuffer(that, size).fill(fill, encoding)\n      : createBuffer(that, size).fill(fill)\n  }\n  return createBuffer(that, size)\n}\n\n/**\n * Creates a new filled Buffer instance.\n * alloc(size[, fill[, encoding]])\n **/\nBuffer.alloc = function (size, fill, encoding) {\n  return alloc(null, size, fill, encoding)\n}\n\nfunction allocUnsafe (that, size) {\n  assertSize(size)\n  that = createBuffer(that, size < 0 ? 0 : checked(size) | 0)\n  if (!Buffer.TYPED_ARRAY_SUPPORT) {\n    for (var i = 0; i < size; ++i) {\n      that[i] = 0\n    }\n  }\n  return that\n}\n\n/**\n * Equivalent to Buffer(num), by default creates a non-zero-filled Buffer instance.\n * */\nBuffer.allocUnsafe = function (size) {\n  return allocUnsafe(null, size)\n}\n/**\n * Equivalent to SlowBuffer(num), by default creates a non-zero-filled Buffer instance.\n */\nBuffer.allocUnsafeSlow = function (size) {\n  return allocUnsafe(null, size)\n}\n\nfunction fromString (that, string, encoding) {\n  if (typeof encoding !== 'string' || encoding === '') {\n    encoding = 'utf8'\n  }\n\n  if (!Buffer.isEncoding(encoding)) {\n    throw new TypeError('\"encoding\" must be a valid string encoding')\n  }\n\n  var length = byteLength(string, encoding) | 0\n  that = createBuffer(that, length)\n\n  var actual = that.write(string, encoding)\n\n  if (actual !== length) {\n    // Writing a hex string, for example, that contains invalid characters will\n    // cause everything after the first invalid character to be ignored. (e.g.\n    // 'abxxcd' will be treated as 'ab')\n    that = that.slice(0, actual)\n  }\n\n  return that\n}\n\nfunction fromArrayLike (that, array) {\n  var length = array.length < 0 ? 0 : checked(array.length) | 0\n  that = createBuffer(that, length)\n  for (var i = 0; i < length; i += 1) {\n    that[i] = array[i] & 255\n  }\n  return that\n}\n\nfunction fromArrayBuffer (that, array, byteOffset, length) {\n  array.byteLength // this throws if `array` is not a valid ArrayBuffer\n\n  if (byteOffset < 0 || array.byteLength < byteOffset) {\n    throw new RangeError('\\'offset\\' is out of bounds')\n  }\n\n  if (array.byteLength < byteOffset + (length || 0)) {\n    throw new RangeError('\\'length\\' is out of bounds')\n  }\n\n  if (byteOffset === undefined && length === undefined) {\n    array = new Uint8Array(array)\n  } else if (length === undefined) {\n    array = new Uint8Array(array, byteOffset)\n  } else {\n    array = new Uint8Array(array, byteOffset, length)\n  }\n\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    // Return an augmented `Uint8Array` instance, for best performance\n    that = array\n    that.__proto__ = Buffer.prototype\n  } else {\n    // Fallback: Return an object instance of the Buffer class\n    that = fromArrayLike(that, array)\n  }\n  return that\n}\n\nfunction fromObject (that, obj) {\n  if (Buffer.isBuffer(obj)) {\n    var len = checked(obj.length) | 0\n    that = createBuffer(that, len)\n\n    if (that.length === 0) {\n      return that\n    }\n\n    obj.copy(that, 0, 0, len)\n    return that\n  }\n\n  if (obj) {\n    if ((typeof ArrayBuffer !== 'undefined' &&\n        obj.buffer instanceof ArrayBuffer) || 'length' in obj) {\n      if (typeof obj.length !== 'number' || isnan(obj.length)) {\n        return createBuffer(that, 0)\n      }\n      return fromArrayLike(that, obj)\n    }\n\n    if (obj.type === 'Buffer' && isArray(obj.data)) {\n      return fromArrayLike(that, obj.data)\n    }\n  }\n\n  throw new TypeError('First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.')\n}\n\nfunction checked (length) {\n  // Note: cannot use `length < kMaxLength()` here because that fails when\n  // length is NaN (which is otherwise coerced to zero.)\n  if (length >= kMaxLength()) {\n    throw new RangeError('Attempt to allocate Buffer larger than maximum ' +\n                         'size: 0x' + kMaxLength().toString(16) + ' bytes')\n  }\n  return length | 0\n}\n\nfunction SlowBuffer (length) {\n  if (+length != length) { // eslint-disable-line eqeqeq\n    length = 0\n  }\n  return Buffer.alloc(+length)\n}\n\nBuffer.isBuffer = function isBuffer (b) {\n  return !!(b != null && b._isBuffer)\n}\n\nBuffer.compare = function compare (a, b) {\n  if (!Buffer.isBuffer(a) || !Buffer.isBuffer(b)) {\n    throw new TypeError('Arguments must be Buffers')\n  }\n\n  if (a === b) return 0\n\n  var x = a.length\n  var y = b.length\n\n  for (var i = 0, len = Math.min(x, y); i < len; ++i) {\n    if (a[i] !== b[i]) {\n      x = a[i]\n      y = b[i]\n      break\n    }\n  }\n\n  if (x < y) return -1\n  if (y < x) return 1\n  return 0\n}\n\nBuffer.isEncoding = function isEncoding (encoding) {\n  switch (String(encoding).toLowerCase()) {\n    case 'hex':\n    case 'utf8':\n    case 'utf-8':\n    case 'ascii':\n    case 'latin1':\n    case 'binary':\n    case 'base64':\n    case 'ucs2':\n    case 'ucs-2':\n    case 'utf16le':\n    case 'utf-16le':\n      return true\n    default:\n      return false\n  }\n}\n\nBuffer.concat = function concat (list, length) {\n  if (!isArray(list)) {\n    throw new TypeError('\"list\" argument must be an Array of Buffers')\n  }\n\n  if (list.length === 0) {\n    return Buffer.alloc(0)\n  }\n\n  var i\n  if (length === undefined) {\n    length = 0\n    for (i = 0; i < list.length; ++i) {\n      length += list[i].length\n    }\n  }\n\n  var buffer = Buffer.allocUnsafe(length)\n  var pos = 0\n  for (i = 0; i < list.length; ++i) {\n    var buf = list[i]\n    if (!Buffer.isBuffer(buf)) {\n      throw new TypeError('\"list\" argument must be an Array of Buffers')\n    }\n    buf.copy(buffer, pos)\n    pos += buf.length\n  }\n  return buffer\n}\n\nfunction byteLength (string, encoding) {\n  if (Buffer.isBuffer(string)) {\n    return string.length\n  }\n  if (typeof ArrayBuffer !== 'undefined' && typeof ArrayBuffer.isView === 'function' &&\n      (ArrayBuffer.isView(string) || string instanceof ArrayBuffer)) {\n    return string.byteLength\n  }\n  if (typeof string !== 'string') {\n    string = '' + string\n  }\n\n  var len = string.length\n  if (len === 0) return 0\n\n  // Use a for loop to avoid recursion\n  var loweredCase = false\n  for (;;) {\n    switch (encoding) {\n      case 'ascii':\n      case 'latin1':\n      case 'binary':\n        return len\n      case 'utf8':\n      case 'utf-8':\n      case undefined:\n        return utf8ToBytes(string).length\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return len * 2\n      case 'hex':\n        return len >>> 1\n      case 'base64':\n        return base64ToBytes(string).length\n      default:\n        if (loweredCase) return utf8ToBytes(string).length // assume utf8\n        encoding = ('' + encoding).toLowerCase()\n        loweredCase = true\n    }\n  }\n}\nBuffer.byteLength = byteLength\n\nfunction slowToString (encoding, start, end) {\n  var loweredCase = false\n\n  // No need to verify that \"this.length <= MAX_UINT32\" since it's a read-only\n  // property of a typed array.\n\n  // This behaves neither like String nor Uint8Array in that we set start/end\n  // to their upper/lower bounds if the value passed is out of range.\n  // undefined is handled specially as per ECMA-262 6th Edition,\n  // Section 13.3.3.7 Runtime Semantics: KeyedBindingInitialization.\n  if (start === undefined || start < 0) {\n    start = 0\n  }\n  // Return early if start > this.length. Done here to prevent potential uint32\n  // coercion fail below.\n  if (start > this.length) {\n    return ''\n  }\n\n  if (end === undefined || end > this.length) {\n    end = this.length\n  }\n\n  if (end <= 0) {\n    return ''\n  }\n\n  // Force coersion to uint32. This will also coerce falsey/NaN values to 0.\n  end >>>= 0\n  start >>>= 0\n\n  if (end <= start) {\n    return ''\n  }\n\n  if (!encoding) encoding = 'utf8'\n\n  while (true) {\n    switch (encoding) {\n      case 'hex':\n        return hexSlice(this, start, end)\n\n      case 'utf8':\n      case 'utf-8':\n        return utf8Slice(this, start, end)\n\n      case 'ascii':\n        return asciiSlice(this, start, end)\n\n      case 'latin1':\n      case 'binary':\n        return latin1Slice(this, start, end)\n\n      case 'base64':\n        return base64Slice(this, start, end)\n\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return utf16leSlice(this, start, end)\n\n      default:\n        if (loweredCase) throw new TypeError('Unknown encoding: ' + encoding)\n        encoding = (encoding + '').toLowerCase()\n        loweredCase = true\n    }\n  }\n}\n\n// The property is used by `Buffer.isBuffer` and `is-buffer` (in Safari 5-7) to detect\n// Buffer instances.\nBuffer.prototype._isBuffer = true\n\nfunction swap (b, n, m) {\n  var i = b[n]\n  b[n] = b[m]\n  b[m] = i\n}\n\nBuffer.prototype.swap16 = function swap16 () {\n  var len = this.length\n  if (len % 2 !== 0) {\n    throw new RangeError('Buffer size must be a multiple of 16-bits')\n  }\n  for (var i = 0; i < len; i += 2) {\n    swap(this, i, i + 1)\n  }\n  return this\n}\n\nBuffer.prototype.swap32 = function swap32 () {\n  var len = this.length\n  if (len % 4 !== 0) {\n    throw new RangeError('Buffer size must be a multiple of 32-bits')\n  }\n  for (var i = 0; i < len; i += 4) {\n    swap(this, i, i + 3)\n    swap(this, i + 1, i + 2)\n  }\n  return this\n}\n\nBuffer.prototype.swap64 = function swap64 () {\n  var len = this.length\n  if (len % 8 !== 0) {\n    throw new RangeError('Buffer size must be a multiple of 64-bits')\n  }\n  for (var i = 0; i < len; i += 8) {\n    swap(this, i, i + 7)\n    swap(this, i + 1, i + 6)\n    swap(this, i + 2, i + 5)\n    swap(this, i + 3, i + 4)\n  }\n  return this\n}\n\nBuffer.prototype.toString = function toString () {\n  var length = this.length | 0\n  if (length === 0) return ''\n  if (arguments.length === 0) return utf8Slice(this, 0, length)\n  return slowToString.apply(this, arguments)\n}\n\nBuffer.prototype.equals = function equals (b) {\n  if (!Buffer.isBuffer(b)) throw new TypeError('Argument must be a Buffer')\n  if (this === b) return true\n  return Buffer.compare(this, b) === 0\n}\n\nBuffer.prototype.inspect = function inspect () {\n  var str = ''\n  var max = exports.INSPECT_MAX_BYTES\n  if (this.length > 0) {\n    str = this.toString('hex', 0, max).match(/.{2}/g).join(' ')\n    if (this.length > max) str += ' ... '\n  }\n  return '<Buffer ' + str + '>'\n}\n\nBuffer.prototype.compare = function compare (target, start, end, thisStart, thisEnd) {\n  if (!Buffer.isBuffer(target)) {\n    throw new TypeError('Argument must be a Buffer')\n  }\n\n  if (start === undefined) {\n    start = 0\n  }\n  if (end === undefined) {\n    end = target ? target.length : 0\n  }\n  if (thisStart === undefined) {\n    thisStart = 0\n  }\n  if (thisEnd === undefined) {\n    thisEnd = this.length\n  }\n\n  if (start < 0 || end > target.length || thisStart < 0 || thisEnd > this.length) {\n    throw new RangeError('out of range index')\n  }\n\n  if (thisStart >= thisEnd && start >= end) {\n    return 0\n  }\n  if (thisStart >= thisEnd) {\n    return -1\n  }\n  if (start >= end) {\n    return 1\n  }\n\n  start >>>= 0\n  end >>>= 0\n  thisStart >>>= 0\n  thisEnd >>>= 0\n\n  if (this === target) return 0\n\n  var x = thisEnd - thisStart\n  var y = end - start\n  var len = Math.min(x, y)\n\n  var thisCopy = this.slice(thisStart, thisEnd)\n  var targetCopy = target.slice(start, end)\n\n  for (var i = 0; i < len; ++i) {\n    if (thisCopy[i] !== targetCopy[i]) {\n      x = thisCopy[i]\n      y = targetCopy[i]\n      break\n    }\n  }\n\n  if (x < y) return -1\n  if (y < x) return 1\n  return 0\n}\n\n// Finds either the first index of `val` in `buffer` at offset >= `byteOffset`,\n// OR the last index of `val` in `buffer` at offset <= `byteOffset`.\n//\n// Arguments:\n// - buffer - a Buffer to search\n// - val - a string, Buffer, or number\n// - byteOffset - an index into `buffer`; will be clamped to an int32\n// - encoding - an optional encoding, relevant is val is a string\n// - dir - true for indexOf, false for lastIndexOf\nfunction bidirectionalIndexOf (buffer, val, byteOffset, encoding, dir) {\n  // Empty buffer means no match\n  if (buffer.length === 0) return -1\n\n  // Normalize byteOffset\n  if (typeof byteOffset === 'string') {\n    encoding = byteOffset\n    byteOffset = 0\n  } else if (byteOffset > 0x7fffffff) {\n    byteOffset = 0x7fffffff\n  } else if (byteOffset < -0x80000000) {\n    byteOffset = -0x80000000\n  }\n  byteOffset = +byteOffset  // Coerce to Number.\n  if (isNaN(byteOffset)) {\n    // byteOffset: it it's undefined, null, NaN, \"foo\", etc, search whole buffer\n    byteOffset = dir ? 0 : (buffer.length - 1)\n  }\n\n  // Normalize byteOffset: negative offsets start from the end of the buffer\n  if (byteOffset < 0) byteOffset = buffer.length + byteOffset\n  if (byteOffset >= buffer.length) {\n    if (dir) return -1\n    else byteOffset = buffer.length - 1\n  } else if (byteOffset < 0) {\n    if (dir) byteOffset = 0\n    else return -1\n  }\n\n  // Normalize val\n  if (typeof val === 'string') {\n    val = Buffer.from(val, encoding)\n  }\n\n  // Finally, search either indexOf (if dir is true) or lastIndexOf\n  if (Buffer.isBuffer(val)) {\n    // Special case: looking for empty string/buffer always fails\n    if (val.length === 0) {\n      return -1\n    }\n    return arrayIndexOf(buffer, val, byteOffset, encoding, dir)\n  } else if (typeof val === 'number') {\n    val = val & 0xFF // Search for a byte value [0-255]\n    if (Buffer.TYPED_ARRAY_SUPPORT &&\n        typeof Uint8Array.prototype.indexOf === 'function') {\n      if (dir) {\n        return Uint8Array.prototype.indexOf.call(buffer, val, byteOffset)\n      } else {\n        return Uint8Array.prototype.lastIndexOf.call(buffer, val, byteOffset)\n      }\n    }\n    return arrayIndexOf(buffer, [ val ], byteOffset, encoding, dir)\n  }\n\n  throw new TypeError('val must be string, number or Buffer')\n}\n\nfunction arrayIndexOf (arr, val, byteOffset, encoding, dir) {\n  var indexSize = 1\n  var arrLength = arr.length\n  var valLength = val.length\n\n  if (encoding !== undefined) {\n    encoding = String(encoding).toLowerCase()\n    if (encoding === 'ucs2' || encoding === 'ucs-2' ||\n        encoding === 'utf16le' || encoding === 'utf-16le') {\n      if (arr.length < 2 || val.length < 2) {\n        return -1\n      }\n      indexSize = 2\n      arrLength /= 2\n      valLength /= 2\n      byteOffset /= 2\n    }\n  }\n\n  function read (buf, i) {\n    if (indexSize === 1) {\n      return buf[i]\n    } else {\n      return buf.readUInt16BE(i * indexSize)\n    }\n  }\n\n  var i\n  if (dir) {\n    var foundIndex = -1\n    for (i = byteOffset; i < arrLength; i++) {\n      if (read(arr, i) === read(val, foundIndex === -1 ? 0 : i - foundIndex)) {\n        if (foundIndex === -1) foundIndex = i\n        if (i - foundIndex + 1 === valLength) return foundIndex * indexSize\n      } else {\n        if (foundIndex !== -1) i -= i - foundIndex\n        foundIndex = -1\n      }\n    }\n  } else {\n    if (byteOffset + valLength > arrLength) byteOffset = arrLength - valLength\n    for (i = byteOffset; i >= 0; i--) {\n      var found = true\n      for (var j = 0; j < valLength; j++) {\n        if (read(arr, i + j) !== read(val, j)) {\n          found = false\n          break\n        }\n      }\n      if (found) return i\n    }\n  }\n\n  return -1\n}\n\nBuffer.prototype.includes = function includes (val, byteOffset, encoding) {\n  return this.indexOf(val, byteOffset, encoding) !== -1\n}\n\nBuffer.prototype.indexOf = function indexOf (val, byteOffset, encoding) {\n  return bidirectionalIndexOf(this, val, byteOffset, encoding, true)\n}\n\nBuffer.prototype.lastIndexOf = function lastIndexOf (val, byteOffset, encoding) {\n  return bidirectionalIndexOf(this, val, byteOffset, encoding, false)\n}\n\nfunction hexWrite (buf, string, offset, length) {\n  offset = Number(offset) || 0\n  var remaining = buf.length - offset\n  if (!length) {\n    length = remaining\n  } else {\n    length = Number(length)\n    if (length > remaining) {\n      length = remaining\n    }\n  }\n\n  // must be an even number of digits\n  var strLen = string.length\n  if (strLen % 2 !== 0) throw new TypeError('Invalid hex string')\n\n  if (length > strLen / 2) {\n    length = strLen / 2\n  }\n  for (var i = 0; i < length; ++i) {\n    var parsed = parseInt(string.substr(i * 2, 2), 16)\n    if (isNaN(parsed)) return i\n    buf[offset + i] = parsed\n  }\n  return i\n}\n\nfunction utf8Write (buf, string, offset, length) {\n  return blitBuffer(utf8ToBytes(string, buf.length - offset), buf, offset, length)\n}\n\nfunction asciiWrite (buf, string, offset, length) {\n  return blitBuffer(asciiToBytes(string), buf, offset, length)\n}\n\nfunction latin1Write (buf, string, offset, length) {\n  return asciiWrite(buf, string, offset, length)\n}\n\nfunction base64Write (buf, string, offset, length) {\n  return blitBuffer(base64ToBytes(string), buf, offset, length)\n}\n\nfunction ucs2Write (buf, string, offset, length) {\n  return blitBuffer(utf16leToBytes(string, buf.length - offset), buf, offset, length)\n}\n\nBuffer.prototype.write = function write (string, offset, length, encoding) {\n  // Buffer#write(string)\n  if (offset === undefined) {\n    encoding = 'utf8'\n    length = this.length\n    offset = 0\n  // Buffer#write(string, encoding)\n  } else if (length === undefined && typeof offset === 'string') {\n    encoding = offset\n    length = this.length\n    offset = 0\n  // Buffer#write(string, offset[, length][, encoding])\n  } else if (isFinite(offset)) {\n    offset = offset | 0\n    if (isFinite(length)) {\n      length = length | 0\n      if (encoding === undefined) encoding = 'utf8'\n    } else {\n      encoding = length\n      length = undefined\n    }\n  // legacy write(string, encoding, offset, length) - remove in v0.13\n  } else {\n    throw new Error(\n      'Buffer.write(string, encoding, offset[, length]) is no longer supported'\n    )\n  }\n\n  var remaining = this.length - offset\n  if (length === undefined || length > remaining) length = remaining\n\n  if ((string.length > 0 && (length < 0 || offset < 0)) || offset > this.length) {\n    throw new RangeError('Attempt to write outside buffer bounds')\n  }\n\n  if (!encoding) encoding = 'utf8'\n\n  var loweredCase = false\n  for (;;) {\n    switch (encoding) {\n      case 'hex':\n        return hexWrite(this, string, offset, length)\n\n      case 'utf8':\n      case 'utf-8':\n        return utf8Write(this, string, offset, length)\n\n      case 'ascii':\n        return asciiWrite(this, string, offset, length)\n\n      case 'latin1':\n      case 'binary':\n        return latin1Write(this, string, offset, length)\n\n      case 'base64':\n        // Warning: maxLength not taken into account in base64Write\n        return base64Write(this, string, offset, length)\n\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return ucs2Write(this, string, offset, length)\n\n      default:\n        if (loweredCase) throw new TypeError('Unknown encoding: ' + encoding)\n        encoding = ('' + encoding).toLowerCase()\n        loweredCase = true\n    }\n  }\n}\n\nBuffer.prototype.toJSON = function toJSON () {\n  return {\n    type: 'Buffer',\n    data: Array.prototype.slice.call(this._arr || this, 0)\n  }\n}\n\nfunction base64Slice (buf, start, end) {\n  if (start === 0 && end === buf.length) {\n    return base64.fromByteArray(buf)\n  } else {\n    return base64.fromByteArray(buf.slice(start, end))\n  }\n}\n\nfunction utf8Slice (buf, start, end) {\n  end = Math.min(buf.length, end)\n  var res = []\n\n  var i = start\n  while (i < end) {\n    var firstByte = buf[i]\n    var codePoint = null\n    var bytesPerSequence = (firstByte > 0xEF) ? 4\n      : (firstByte > 0xDF) ? 3\n      : (firstByte > 0xBF) ? 2\n      : 1\n\n    if (i + bytesPerSequence <= end) {\n      var secondByte, thirdByte, fourthByte, tempCodePoint\n\n      switch (bytesPerSequence) {\n        case 1:\n          if (firstByte < 0x80) {\n            codePoint = firstByte\n          }\n          break\n        case 2:\n          secondByte = buf[i + 1]\n          if ((secondByte & 0xC0) === 0x80) {\n            tempCodePoint = (firstByte & 0x1F) << 0x6 | (secondByte & 0x3F)\n            if (tempCodePoint > 0x7F) {\n              codePoint = tempCodePoint\n            }\n          }\n          break\n        case 3:\n          secondByte = buf[i + 1]\n          thirdByte = buf[i + 2]\n          if ((secondByte & 0xC0) === 0x80 && (thirdByte & 0xC0) === 0x80) {\n            tempCodePoint = (firstByte & 0xF) << 0xC | (secondByte & 0x3F) << 0x6 | (thirdByte & 0x3F)\n            if (tempCodePoint > 0x7FF && (tempCodePoint < 0xD800 || tempCodePoint > 0xDFFF)) {\n              codePoint = tempCodePoint\n            }\n          }\n          break\n        case 4:\n          secondByte = buf[i + 1]\n          thirdByte = buf[i + 2]\n          fourthByte = buf[i + 3]\n          if ((secondByte & 0xC0) === 0x80 && (thirdByte & 0xC0) === 0x80 && (fourthByte & 0xC0) === 0x80) {\n            tempCodePoint = (firstByte & 0xF) << 0x12 | (secondByte & 0x3F) << 0xC | (thirdByte & 0x3F) << 0x6 | (fourthByte & 0x3F)\n            if (tempCodePoint > 0xFFFF && tempCodePoint < 0x110000) {\n              codePoint = tempCodePoint\n            }\n          }\n      }\n    }\n\n    if (codePoint === null) {\n      // we did not generate a valid codePoint so insert a\n      // replacement char (U+FFFD) and advance only 1 byte\n      codePoint = 0xFFFD\n      bytesPerSequence = 1\n    } else if (codePoint > 0xFFFF) {\n      // encode to utf16 (surrogate pair dance)\n      codePoint -= 0x10000\n      res.push(codePoint >>> 10 & 0x3FF | 0xD800)\n      codePoint = 0xDC00 | codePoint & 0x3FF\n    }\n\n    res.push(codePoint)\n    i += bytesPerSequence\n  }\n\n  return decodeCodePointsArray(res)\n}\n\n// Based on http://stackoverflow.com/a/22747272/680742, the browser with\n// the lowest limit is Chrome, with 0x10000 args.\n// We go 1 magnitude less, for safety\nvar MAX_ARGUMENTS_LENGTH = 0x1000\n\nfunction decodeCodePointsArray (codePoints) {\n  var len = codePoints.length\n  if (len <= MAX_ARGUMENTS_LENGTH) {\n    return String.fromCharCode.apply(String, codePoints) // avoid extra slice()\n  }\n\n  // Decode in chunks to avoid \"call stack size exceeded\".\n  var res = ''\n  var i = 0\n  while (i < len) {\n    res += String.fromCharCode.apply(\n      String,\n      codePoints.slice(i, i += MAX_ARGUMENTS_LENGTH)\n    )\n  }\n  return res\n}\n\nfunction asciiSlice (buf, start, end) {\n  var ret = ''\n  end = Math.min(buf.length, end)\n\n  for (var i = start; i < end; ++i) {\n    ret += String.fromCharCode(buf[i] & 0x7F)\n  }\n  return ret\n}\n\nfunction latin1Slice (buf, start, end) {\n  var ret = ''\n  end = Math.min(buf.length, end)\n\n  for (var i = start; i < end; ++i) {\n    ret += String.fromCharCode(buf[i])\n  }\n  return ret\n}\n\nfunction hexSlice (buf, start, end) {\n  var len = buf.length\n\n  if (!start || start < 0) start = 0\n  if (!end || end < 0 || end > len) end = len\n\n  var out = ''\n  for (var i = start; i < end; ++i) {\n    out += toHex(buf[i])\n  }\n  return out\n}\n\nfunction utf16leSlice (buf, start, end) {\n  var bytes = buf.slice(start, end)\n  var res = ''\n  for (var i = 0; i < bytes.length; i += 2) {\n    res += String.fromCharCode(bytes[i] + bytes[i + 1] * 256)\n  }\n  return res\n}\n\nBuffer.prototype.slice = function slice (start, end) {\n  var len = this.length\n  start = ~~start\n  end = end === undefined ? len : ~~end\n\n  if (start < 0) {\n    start += len\n    if (start < 0) start = 0\n  } else if (start > len) {\n    start = len\n  }\n\n  if (end < 0) {\n    end += len\n    if (end < 0) end = 0\n  } else if (end > len) {\n    end = len\n  }\n\n  if (end < start) end = start\n\n  var newBuf\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    newBuf = this.subarray(start, end)\n    newBuf.__proto__ = Buffer.prototype\n  } else {\n    var sliceLen = end - start\n    newBuf = new Buffer(sliceLen, undefined)\n    for (var i = 0; i < sliceLen; ++i) {\n      newBuf[i] = this[i + start]\n    }\n  }\n\n  return newBuf\n}\n\n/*\n * Need to make sure that buffer isn't trying to write out of bounds.\n */\nfunction checkOffset (offset, ext, length) {\n  if ((offset % 1) !== 0 || offset < 0) throw new RangeError('offset is not uint')\n  if (offset + ext > length) throw new RangeError('Trying to access beyond buffer length')\n}\n\nBuffer.prototype.readUIntLE = function readUIntLE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) checkOffset(offset, byteLength, this.length)\n\n  var val = this[offset]\n  var mul = 1\n  var i = 0\n  while (++i < byteLength && (mul *= 0x100)) {\n    val += this[offset + i] * mul\n  }\n\n  return val\n}\n\nBuffer.prototype.readUIntBE = function readUIntBE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) {\n    checkOffset(offset, byteLength, this.length)\n  }\n\n  var val = this[offset + --byteLength]\n  var mul = 1\n  while (byteLength > 0 && (mul *= 0x100)) {\n    val += this[offset + --byteLength] * mul\n  }\n\n  return val\n}\n\nBuffer.prototype.readUInt8 = function readUInt8 (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 1, this.length)\n  return this[offset]\n}\n\nBuffer.prototype.readUInt16LE = function readUInt16LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  return this[offset] | (this[offset + 1] << 8)\n}\n\nBuffer.prototype.readUInt16BE = function readUInt16BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  return (this[offset] << 8) | this[offset + 1]\n}\n\nBuffer.prototype.readUInt32LE = function readUInt32LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return ((this[offset]) |\n      (this[offset + 1] << 8) |\n      (this[offset + 2] << 16)) +\n      (this[offset + 3] * 0x1000000)\n}\n\nBuffer.prototype.readUInt32BE = function readUInt32BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return (this[offset] * 0x1000000) +\n    ((this[offset + 1] << 16) |\n    (this[offset + 2] << 8) |\n    this[offset + 3])\n}\n\nBuffer.prototype.readIntLE = function readIntLE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) checkOffset(offset, byteLength, this.length)\n\n  var val = this[offset]\n  var mul = 1\n  var i = 0\n  while (++i < byteLength && (mul *= 0x100)) {\n    val += this[offset + i] * mul\n  }\n  mul *= 0x80\n\n  if (val >= mul) val -= Math.pow(2, 8 * byteLength)\n\n  return val\n}\n\nBuffer.prototype.readIntBE = function readIntBE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) checkOffset(offset, byteLength, this.length)\n\n  var i = byteLength\n  var mul = 1\n  var val = this[offset + --i]\n  while (i > 0 && (mul *= 0x100)) {\n    val += this[offset + --i] * mul\n  }\n  mul *= 0x80\n\n  if (val >= mul) val -= Math.pow(2, 8 * byteLength)\n\n  return val\n}\n\nBuffer.prototype.readInt8 = function readInt8 (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 1, this.length)\n  if (!(this[offset] & 0x80)) return (this[offset])\n  return ((0xff - this[offset] + 1) * -1)\n}\n\nBuffer.prototype.readInt16LE = function readInt16LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  var val = this[offset] | (this[offset + 1] << 8)\n  return (val & 0x8000) ? val | 0xFFFF0000 : val\n}\n\nBuffer.prototype.readInt16BE = function readInt16BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  var val = this[offset + 1] | (this[offset] << 8)\n  return (val & 0x8000) ? val | 0xFFFF0000 : val\n}\n\nBuffer.prototype.readInt32LE = function readInt32LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return (this[offset]) |\n    (this[offset + 1] << 8) |\n    (this[offset + 2] << 16) |\n    (this[offset + 3] << 24)\n}\n\nBuffer.prototype.readInt32BE = function readInt32BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return (this[offset] << 24) |\n    (this[offset + 1] << 16) |\n    (this[offset + 2] << 8) |\n    (this[offset + 3])\n}\n\nBuffer.prototype.readFloatLE = function readFloatLE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n  return ieee754.read(this, offset, true, 23, 4)\n}\n\nBuffer.prototype.readFloatBE = function readFloatBE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n  return ieee754.read(this, offset, false, 23, 4)\n}\n\nBuffer.prototype.readDoubleLE = function readDoubleLE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 8, this.length)\n  return ieee754.read(this, offset, true, 52, 8)\n}\n\nBuffer.prototype.readDoubleBE = function readDoubleBE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 8, this.length)\n  return ieee754.read(this, offset, false, 52, 8)\n}\n\nfunction checkInt (buf, value, offset, ext, max, min) {\n  if (!Buffer.isBuffer(buf)) throw new TypeError('\"buffer\" argument must be a Buffer instance')\n  if (value > max || value < min) throw new RangeError('\"value\" argument is out of bounds')\n  if (offset + ext > buf.length) throw new RangeError('Index out of range')\n}\n\nBuffer.prototype.writeUIntLE = function writeUIntLE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) {\n    var maxBytes = Math.pow(2, 8 * byteLength) - 1\n    checkInt(this, value, offset, byteLength, maxBytes, 0)\n  }\n\n  var mul = 1\n  var i = 0\n  this[offset] = value & 0xFF\n  while (++i < byteLength && (mul *= 0x100)) {\n    this[offset + i] = (value / mul) & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeUIntBE = function writeUIntBE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) {\n    var maxBytes = Math.pow(2, 8 * byteLength) - 1\n    checkInt(this, value, offset, byteLength, maxBytes, 0)\n  }\n\n  var i = byteLength - 1\n  var mul = 1\n  this[offset + i] = value & 0xFF\n  while (--i >= 0 && (mul *= 0x100)) {\n    this[offset + i] = (value / mul) & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeUInt8 = function writeUInt8 (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 1, 0xff, 0)\n  if (!Buffer.TYPED_ARRAY_SUPPORT) value = Math.floor(value)\n  this[offset] = (value & 0xff)\n  return offset + 1\n}\n\nfunction objectWriteUInt16 (buf, value, offset, littleEndian) {\n  if (value < 0) value = 0xffff + value + 1\n  for (var i = 0, j = Math.min(buf.length - offset, 2); i < j; ++i) {\n    buf[offset + i] = (value & (0xff << (8 * (littleEndian ? i : 1 - i)))) >>>\n      (littleEndian ? i : 1 - i) * 8\n  }\n}\n\nBuffer.prototype.writeUInt16LE = function writeUInt16LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0xffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value & 0xff)\n    this[offset + 1] = (value >>> 8)\n  } else {\n    objectWriteUInt16(this, value, offset, true)\n  }\n  return offset + 2\n}\n\nBuffer.prototype.writeUInt16BE = function writeUInt16BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0xffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 8)\n    this[offset + 1] = (value & 0xff)\n  } else {\n    objectWriteUInt16(this, value, offset, false)\n  }\n  return offset + 2\n}\n\nfunction objectWriteUInt32 (buf, value, offset, littleEndian) {\n  if (value < 0) value = 0xffffffff + value + 1\n  for (var i = 0, j = Math.min(buf.length - offset, 4); i < j; ++i) {\n    buf[offset + i] = (value >>> (littleEndian ? i : 3 - i) * 8) & 0xff\n  }\n}\n\nBuffer.prototype.writeUInt32LE = function writeUInt32LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0xffffffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset + 3] = (value >>> 24)\n    this[offset + 2] = (value >>> 16)\n    this[offset + 1] = (value >>> 8)\n    this[offset] = (value & 0xff)\n  } else {\n    objectWriteUInt32(this, value, offset, true)\n  }\n  return offset + 4\n}\n\nBuffer.prototype.writeUInt32BE = function writeUInt32BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0xffffffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 24)\n    this[offset + 1] = (value >>> 16)\n    this[offset + 2] = (value >>> 8)\n    this[offset + 3] = (value & 0xff)\n  } else {\n    objectWriteUInt32(this, value, offset, false)\n  }\n  return offset + 4\n}\n\nBuffer.prototype.writeIntLE = function writeIntLE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) {\n    var limit = Math.pow(2, 8 * byteLength - 1)\n\n    checkInt(this, value, offset, byteLength, limit - 1, -limit)\n  }\n\n  var i = 0\n  var mul = 1\n  var sub = 0\n  this[offset] = value & 0xFF\n  while (++i < byteLength && (mul *= 0x100)) {\n    if (value < 0 && sub === 0 && this[offset + i - 1] !== 0) {\n      sub = 1\n    }\n    this[offset + i] = ((value / mul) >> 0) - sub & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeIntBE = function writeIntBE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) {\n    var limit = Math.pow(2, 8 * byteLength - 1)\n\n    checkInt(this, value, offset, byteLength, limit - 1, -limit)\n  }\n\n  var i = byteLength - 1\n  var mul = 1\n  var sub = 0\n  this[offset + i] = value & 0xFF\n  while (--i >= 0 && (mul *= 0x100)) {\n    if (value < 0 && sub === 0 && this[offset + i + 1] !== 0) {\n      sub = 1\n    }\n    this[offset + i] = ((value / mul) >> 0) - sub & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeInt8 = function writeInt8 (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 1, 0x7f, -0x80)\n  if (!Buffer.TYPED_ARRAY_SUPPORT) value = Math.floor(value)\n  if (value < 0) value = 0xff + value + 1\n  this[offset] = (value & 0xff)\n  return offset + 1\n}\n\nBuffer.prototype.writeInt16LE = function writeInt16LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0x7fff, -0x8000)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value & 0xff)\n    this[offset + 1] = (value >>> 8)\n  } else {\n    objectWriteUInt16(this, value, offset, true)\n  }\n  return offset + 2\n}\n\nBuffer.prototype.writeInt16BE = function writeInt16BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0x7fff, -0x8000)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 8)\n    this[offset + 1] = (value & 0xff)\n  } else {\n    objectWriteUInt16(this, value, offset, false)\n  }\n  return offset + 2\n}\n\nBuffer.prototype.writeInt32LE = function writeInt32LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0x7fffffff, -0x80000000)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value & 0xff)\n    this[offset + 1] = (value >>> 8)\n    this[offset + 2] = (value >>> 16)\n    this[offset + 3] = (value >>> 24)\n  } else {\n    objectWriteUInt32(this, value, offset, true)\n  }\n  return offset + 4\n}\n\nBuffer.prototype.writeInt32BE = function writeInt32BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0x7fffffff, -0x80000000)\n  if (value < 0) value = 0xffffffff + value + 1\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 24)\n    this[offset + 1] = (value >>> 16)\n    this[offset + 2] = (value >>> 8)\n    this[offset + 3] = (value & 0xff)\n  } else {\n    objectWriteUInt32(this, value, offset, false)\n  }\n  return offset + 4\n}\n\nfunction checkIEEE754 (buf, value, offset, ext, max, min) {\n  if (offset + ext > buf.length) throw new RangeError('Index out of range')\n  if (offset < 0) throw new RangeError('Index out of range')\n}\n\nfunction writeFloat (buf, value, offset, littleEndian, noAssert) {\n  if (!noAssert) {\n    checkIEEE754(buf, value, offset, 4, 3.4028234663852886e+38, -3.4028234663852886e+38)\n  }\n  ieee754.write(buf, value, offset, littleEndian, 23, 4)\n  return offset + 4\n}\n\nBuffer.prototype.writeFloatLE = function writeFloatLE (value, offset, noAssert) {\n  return writeFloat(this, value, offset, true, noAssert)\n}\n\nBuffer.prototype.writeFloatBE = function writeFloatBE (value, offset, noAssert) {\n  return writeFloat(this, value, offset, false, noAssert)\n}\n\nfunction writeDouble (buf, value, offset, littleEndian, noAssert) {\n  if (!noAssert) {\n    checkIEEE754(buf, value, offset, 8, 1.7976931348623157E+308, -1.7976931348623157E+308)\n  }\n  ieee754.write(buf, value, offset, littleEndian, 52, 8)\n  return offset + 8\n}\n\nBuffer.prototype.writeDoubleLE = function writeDoubleLE (value, offset, noAssert) {\n  return writeDouble(this, value, offset, true, noAssert)\n}\n\nBuffer.prototype.writeDoubleBE = function writeDoubleBE (value, offset, noAssert) {\n  return writeDouble(this, value, offset, false, noAssert)\n}\n\n// copy(targetBuffer, targetStart=0, sourceStart=0, sourceEnd=buffer.length)\nBuffer.prototype.copy = function copy (target, targetStart, start, end) {\n  if (!start) start = 0\n  if (!end && end !== 0) end = this.length\n  if (targetStart >= target.length) targetStart = target.length\n  if (!targetStart) targetStart = 0\n  if (end > 0 && end < start) end = start\n\n  // Copy 0 bytes; we're done\n  if (end === start) return 0\n  if (target.length === 0 || this.length === 0) return 0\n\n  // Fatal error conditions\n  if (targetStart < 0) {\n    throw new RangeError('targetStart out of bounds')\n  }\n  if (start < 0 || start >= this.length) throw new RangeError('sourceStart out of bounds')\n  if (end < 0) throw new RangeError('sourceEnd out of bounds')\n\n  // Are we oob?\n  if (end > this.length) end = this.length\n  if (target.length - targetStart < end - start) {\n    end = target.length - targetStart + start\n  }\n\n  var len = end - start\n  var i\n\n  if (this === target && start < targetStart && targetStart < end) {\n    // descending copy from end\n    for (i = len - 1; i >= 0; --i) {\n      target[i + targetStart] = this[i + start]\n    }\n  } else if (len < 1000 || !Buffer.TYPED_ARRAY_SUPPORT) {\n    // ascending copy from start\n    for (i = 0; i < len; ++i) {\n      target[i + targetStart] = this[i + start]\n    }\n  } else {\n    Uint8Array.prototype.set.call(\n      target,\n      this.subarray(start, start + len),\n      targetStart\n    )\n  }\n\n  return len\n}\n\n// Usage:\n//    buffer.fill(number[, offset[, end]])\n//    buffer.fill(buffer[, offset[, end]])\n//    buffer.fill(string[, offset[, end]][, encoding])\nBuffer.prototype.fill = function fill (val, start, end, encoding) {\n  // Handle string cases:\n  if (typeof val === 'string') {\n    if (typeof start === 'string') {\n      encoding = start\n      start = 0\n      end = this.length\n    } else if (typeof end === 'string') {\n      encoding = end\n      end = this.length\n    }\n    if (val.length === 1) {\n      var code = val.charCodeAt(0)\n      if (code < 256) {\n        val = code\n      }\n    }\n    if (encoding !== undefined && typeof encoding !== 'string') {\n      throw new TypeError('encoding must be a string')\n    }\n    if (typeof encoding === 'string' && !Buffer.isEncoding(encoding)) {\n      throw new TypeError('Unknown encoding: ' + encoding)\n    }\n  } else if (typeof val === 'number') {\n    val = val & 255\n  }\n\n  // Invalid ranges are not set to a default, so can range check early.\n  if (start < 0 || this.length < start || this.length < end) {\n    throw new RangeError('Out of range index')\n  }\n\n  if (end <= start) {\n    return this\n  }\n\n  start = start >>> 0\n  end = end === undefined ? this.length : end >>> 0\n\n  if (!val) val = 0\n\n  var i\n  if (typeof val === 'number') {\n    for (i = start; i < end; ++i) {\n      this[i] = val\n    }\n  } else {\n    var bytes = Buffer.isBuffer(val)\n      ? val\n      : utf8ToBytes(new Buffer(val, encoding).toString())\n    var len = bytes.length\n    for (i = 0; i < end - start; ++i) {\n      this[i + start] = bytes[i % len]\n    }\n  }\n\n  return this\n}\n\n// HELPER FUNCTIONS\n// ================\n\nvar INVALID_BASE64_RE = /[^+\\/0-9A-Za-z-_]/g\n\nfunction base64clean (str) {\n  // Node strips out invalid characters like \\n and \\t from the string, base64-js does not\n  str = stringtrim(str).replace(INVALID_BASE64_RE, '')\n  // Node converts strings with length < 2 to ''\n  if (str.length < 2) return ''\n  // Node allows for non-padded base64 strings (missing trailing ===), base64-js does not\n  while (str.length % 4 !== 0) {\n    str = str + '='\n  }\n  return str\n}\n\nfunction stringtrim (str) {\n  if (str.trim) return str.trim()\n  return str.replace(/^\\s+|\\s+$/g, '')\n}\n\nfunction toHex (n) {\n  if (n < 16) return '0' + n.toString(16)\n  return n.toString(16)\n}\n\nfunction utf8ToBytes (string, units) {\n  units = units || Infinity\n  var codePoint\n  var length = string.length\n  var leadSurrogate = null\n  var bytes = []\n\n  for (var i = 0; i < length; ++i) {\n    codePoint = string.charCodeAt(i)\n\n    // is surrogate component\n    if (codePoint > 0xD7FF && codePoint < 0xE000) {\n      // last char was a lead\n      if (!leadSurrogate) {\n        // no lead yet\n        if (codePoint > 0xDBFF) {\n          // unexpected trail\n          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n          continue\n        } else if (i + 1 === length) {\n          // unpaired lead\n          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n          continue\n        }\n\n        // valid lead\n        leadSurrogate = codePoint\n\n        continue\n      }\n\n      // 2 leads in a row\n      if (codePoint < 0xDC00) {\n        if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n        leadSurrogate = codePoint\n        continue\n      }\n\n      // valid surrogate pair\n      codePoint = (leadSurrogate - 0xD800 << 10 | codePoint - 0xDC00) + 0x10000\n    } else if (leadSurrogate) {\n      // valid bmp char, but last char was a lead\n      if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n    }\n\n    leadSurrogate = null\n\n    // encode utf8\n    if (codePoint < 0x80) {\n      if ((units -= 1) < 0) break\n      bytes.push(codePoint)\n    } else if (codePoint < 0x800) {\n      if ((units -= 2) < 0) break\n      bytes.push(\n        codePoint >> 0x6 | 0xC0,\n        codePoint & 0x3F | 0x80\n      )\n    } else if (codePoint < 0x10000) {\n      if ((units -= 3) < 0) break\n      bytes.push(\n        codePoint >> 0xC | 0xE0,\n        codePoint >> 0x6 & 0x3F | 0x80,\n        codePoint & 0x3F | 0x80\n      )\n    } else if (codePoint < 0x110000) {\n      if ((units -= 4) < 0) break\n      bytes.push(\n        codePoint >> 0x12 | 0xF0,\n        codePoint >> 0xC & 0x3F | 0x80,\n        codePoint >> 0x6 & 0x3F | 0x80,\n        codePoint & 0x3F | 0x80\n      )\n    } else {\n      throw new Error('Invalid code point')\n    }\n  }\n\n  return bytes\n}\n\nfunction asciiToBytes (str) {\n  var byteArray = []\n  for (var i = 0; i < str.length; ++i) {\n    // Node's code seems to be doing this and not & 0x7F..\n    byteArray.push(str.charCodeAt(i) & 0xFF)\n  }\n  return byteArray\n}\n\nfunction utf16leToBytes (str, units) {\n  var c, hi, lo\n  var byteArray = []\n  for (var i = 0; i < str.length; ++i) {\n    if ((units -= 2) < 0) break\n\n    c = str.charCodeAt(i)\n    hi = c >> 8\n    lo = c % 256\n    byteArray.push(lo)\n    byteArray.push(hi)\n  }\n\n  return byteArray\n}\n\nfunction base64ToBytes (str) {\n  return base64.toByteArray(base64clean(str))\n}\n\nfunction blitBuffer (src, dst, offset, length) {\n  for (var i = 0; i < length; ++i) {\n    if ((i + offset >= dst.length) || (i >= src.length)) break\n    dst[i + offset] = src[i]\n  }\n  return i\n}\n\nfunction isnan (val) {\n  return val !== val // eslint-disable-line no-self-compare\n}\n","'use strict'\n\nexports.byteLength = byteLength\nexports.toByteArray = toByteArray\nexports.fromByteArray = fromByteArray\n\nvar lookup = []\nvar revLookup = []\nvar Arr = typeof Uint8Array !== 'undefined' ? Uint8Array : Array\n\nvar code = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'\nfor (var i = 0, len = code.length; i < len; ++i) {\n  lookup[i] = code[i]\n  revLookup[code.charCodeAt(i)] = i\n}\n\n// Support decoding URL-safe base64 strings, as Node.js does.\n// See: https://en.wikipedia.org/wiki/Base64#URL_applications\nrevLookup['-'.charCodeAt(0)] = 62\nrevLookup['_'.charCodeAt(0)] = 63\n\nfunction getLens (b64) {\n  var len = b64.length\n\n  if (len % 4 > 0) {\n    throw new Error('Invalid string. Length must be a multiple of 4')\n  }\n\n  // Trim off extra bytes after placeholder bytes are found\n  // See: https://github.com/beatgammit/base64-js/issues/42\n  var validLen = b64.indexOf('=')\n  if (validLen === -1) validLen = len\n\n  var placeHoldersLen = validLen === len\n    ? 0\n    : 4 - (validLen % 4)\n\n  return [validLen, placeHoldersLen]\n}\n\n// base64 is 4/3 + up to two characters of the original data\nfunction byteLength (b64) {\n  var lens = getLens(b64)\n  var validLen = lens[0]\n  var placeHoldersLen = lens[1]\n  return ((validLen + placeHoldersLen) * 3 / 4) - placeHoldersLen\n}\n\nfunction _byteLength (b64, validLen, placeHoldersLen) {\n  return ((validLen + placeHoldersLen) * 3 / 4) - placeHoldersLen\n}\n\nfunction toByteArray (b64) {\n  var tmp\n  var lens = getLens(b64)\n  var validLen = lens[0]\n  var placeHoldersLen = lens[1]\n\n  var arr = new Arr(_byteLength(b64, validLen, placeHoldersLen))\n\n  var curByte = 0\n\n  // if there are placeholders, only get up to the last complete 4 chars\n  var len = placeHoldersLen > 0\n    ? validLen - 4\n    : validLen\n\n  var i\n  for (i = 0; i < len; i += 4) {\n    tmp =\n      (revLookup[b64.charCodeAt(i)] << 18) |\n      (revLookup[b64.charCodeAt(i + 1)] << 12) |\n      (revLookup[b64.charCodeAt(i + 2)] << 6) |\n      revLookup[b64.charCodeAt(i + 3)]\n    arr[curByte++] = (tmp >> 16) & 0xFF\n    arr[curByte++] = (tmp >> 8) & 0xFF\n    arr[curByte++] = tmp & 0xFF\n  }\n\n  if (placeHoldersLen === 2) {\n    tmp =\n      (revLookup[b64.charCodeAt(i)] << 2) |\n      (revLookup[b64.charCodeAt(i + 1)] >> 4)\n    arr[curByte++] = tmp & 0xFF\n  }\n\n  if (placeHoldersLen === 1) {\n    tmp =\n      (revLookup[b64.charCodeAt(i)] << 10) |\n      (revLookup[b64.charCodeAt(i + 1)] << 4) |\n      (revLookup[b64.charCodeAt(i + 2)] >> 2)\n    arr[curByte++] = (tmp >> 8) & 0xFF\n    arr[curByte++] = tmp & 0xFF\n  }\n\n  return arr\n}\n\nfunction tripletToBase64 (num) {\n  return lookup[num >> 18 & 0x3F] +\n    lookup[num >> 12 & 0x3F] +\n    lookup[num >> 6 & 0x3F] +\n    lookup[num & 0x3F]\n}\n\nfunction encodeChunk (uint8, start, end) {\n  var tmp\n  var output = []\n  for (var i = start; i < end; i += 3) {\n    tmp =\n      ((uint8[i] << 16) & 0xFF0000) +\n      ((uint8[i + 1] << 8) & 0xFF00) +\n      (uint8[i + 2] & 0xFF)\n    output.push(tripletToBase64(tmp))\n  }\n  return output.join('')\n}\n\nfunction fromByteArray (uint8) {\n  var tmp\n  var len = uint8.length\n  var extraBytes = len % 3 // if we have 1 byte left, pad 2 bytes\n  var parts = []\n  var maxChunkLength = 16383 // must be multiple of 3\n\n  // go through the array every three bytes, we'll deal with trailing stuff later\n  for (var i = 0, len2 = len - extraBytes; i < len2; i += maxChunkLength) {\n    parts.push(encodeChunk(uint8, i, (i + maxChunkLength) > len2 ? len2 : (i + maxChunkLength)))\n  }\n\n  // pad the end with zeros, but make sure to not forget the extra bytes\n  if (extraBytes === 1) {\n    tmp = uint8[len - 1]\n    parts.push(\n      lookup[tmp >> 2] +\n      lookup[(tmp << 4) & 0x3F] +\n      '=='\n    )\n  } else if (extraBytes === 2) {\n    tmp = (uint8[len - 2] << 8) + uint8[len - 1]\n    parts.push(\n      lookup[tmp >> 10] +\n      lookup[(tmp >> 4) & 0x3F] +\n      lookup[(tmp << 2) & 0x3F] +\n      '='\n    )\n  }\n\n  return parts.join('')\n}\n","/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */\nexports.read = function (buffer, offset, isLE, mLen, nBytes) {\n  var e, m\n  var eLen = (nBytes * 8) - mLen - 1\n  var eMax = (1 << eLen) - 1\n  var eBias = eMax >> 1\n  var nBits = -7\n  var i = isLE ? (nBytes - 1) : 0\n  var d = isLE ? -1 : 1\n  var s = buffer[offset + i]\n\n  i += d\n\n  e = s & ((1 << (-nBits)) - 1)\n  s >>= (-nBits)\n  nBits += eLen\n  for (; nBits > 0; e = (e * 256) + buffer[offset + i], i += d, nBits -= 8) {}\n\n  m = e & ((1 << (-nBits)) - 1)\n  e >>= (-nBits)\n  nBits += mLen\n  for (; nBits > 0; m = (m * 256) + buffer[offset + i], i += d, nBits -= 8) {}\n\n  if (e === 0) {\n    e = 1 - eBias\n  } else if (e === eMax) {\n    return m ? NaN : ((s ? -1 : 1) * Infinity)\n  } else {\n    m = m + Math.pow(2, mLen)\n    e = e - eBias\n  }\n  return (s ? -1 : 1) * m * Math.pow(2, e - mLen)\n}\n\nexports.write = function (buffer, value, offset, isLE, mLen, nBytes) {\n  var e, m, c\n  var eLen = (nBytes * 8) - mLen - 1\n  var eMax = (1 << eLen) - 1\n  var eBias = eMax >> 1\n  var rt = (mLen === 23 ? Math.pow(2, -24) - Math.pow(2, -77) : 0)\n  var i = isLE ? 0 : (nBytes - 1)\n  var d = isLE ? 1 : -1\n  var s = value < 0 || (value === 0 && 1 / value < 0) ? 1 : 0\n\n  value = Math.abs(value)\n\n  if (isNaN(value) || value === Infinity) {\n    m = isNaN(value) ? 1 : 0\n    e = eMax\n  } else {\n    e = Math.floor(Math.log(value) / Math.LN2)\n    if (value * (c = Math.pow(2, -e)) < 1) {\n      e--\n      c *= 2\n    }\n    if (e + eBias >= 1) {\n      value += rt / c\n    } else {\n      value += rt * Math.pow(2, 1 - eBias)\n    }\n    if (value * c >= 2) {\n      e++\n      c /= 2\n    }\n\n    if (e + eBias >= eMax) {\n      m = 0\n      e = eMax\n    } else if (e + eBias >= 1) {\n      m = ((value * c) - 1) * Math.pow(2, mLen)\n      e = e + eBias\n    } else {\n      m = value * Math.pow(2, eBias - 1) * Math.pow(2, mLen)\n      e = 0\n    }\n  }\n\n  for (; mLen >= 8; buffer[offset + i] = m & 0xff, i += d, m /= 256, mLen -= 8) {}\n\n  e = (e << mLen) | m\n  eLen += mLen\n  for (; eLen > 0; buffer[offset + i] = e & 0xff, i += d, e /= 256, eLen -= 8) {}\n\n  buffer[offset + i - d] |= s * 128\n}\n","var toString = {}.toString;\n\nmodule.exports = Array.isArray || function (arr) {\n  return toString.call(arr) == '[object Array]';\n};\n","'use strict';\n\n//This code is extracted from ndarray-sort\n//It is inlined here as a temporary workaround\n\nmodule.exports = wrapper;\n\nvar INSERT_SORT_CUTOFF = 32\n\nfunction wrapper(data, n0) {\n  if (n0 <= 4*INSERT_SORT_CUTOFF) {\n    insertionSort(0, n0 - 1, data);\n  } else {\n    quickSort(0, n0 - 1, data);\n  }\n}\n\nfunction insertionSort(left, right, data) {\n  var ptr = 2*(left+1)\n  for(var i=left+1; i<=right; ++i) {\n    var a = data[ptr++]\n    var b = data[ptr++]\n    var j = i\n    var jptr = ptr-2\n    while(j-- > left) {\n      var x = data[jptr-2]\n      var y = data[jptr-1]\n      if(x < a) {\n        break\n      } else if(x === a && y < b) {\n        break\n      }\n      data[jptr]   = x\n      data[jptr+1] = y\n      jptr -= 2\n    }\n    data[jptr]   = a\n    data[jptr+1] = b\n  }\n}\n\nfunction swap(i, j, data) {\n  i *= 2\n  j *= 2\n  var x = data[i]\n  var y = data[i+1]\n  data[i] = data[j]\n  data[i+1] = data[j+1]\n  data[j] = x\n  data[j+1] = y\n}\n\nfunction move(i, j, data) {\n  i *= 2\n  j *= 2\n  data[i] = data[j]\n  data[i+1] = data[j+1]\n}\n\nfunction rotate(i, j, k, data) {\n  i *= 2\n  j *= 2\n  k *= 2\n  var x = data[i]\n  var y = data[i+1]\n  data[i] = data[j]\n  data[i+1] = data[j+1]\n  data[j] = data[k]\n  data[j+1] = data[k+1]\n  data[k] = x\n  data[k+1] = y\n}\n\nfunction shufflePivot(i, j, px, py, data) {\n  i *= 2\n  j *= 2\n  data[i] = data[j]\n  data[j] = px\n  data[i+1] = data[j+1]\n  data[j+1] = py\n}\n\nfunction compare(i, j, data) {\n  i *= 2\n  j *= 2\n  var x = data[i],\n      y = data[j]\n  if(x < y) {\n    return false\n  } else if(x === y) {\n    return data[i+1] > data[j+1]\n  }\n  return true\n}\n\nfunction comparePivot(i, y, b, data) {\n  i *= 2\n  var x = data[i]\n  if(x < y) {\n    return true\n  } else if(x === y) {\n    return data[i+1] < b\n  }\n  return false\n}\n\nfunction quickSort(left, right, data) {\n  var sixth = (right - left + 1) / 6 | 0, \n      index1 = left + sixth, \n      index5 = right - sixth, \n      index3 = left + right >> 1, \n      index2 = index3 - sixth, \n      index4 = index3 + sixth, \n      el1 = index1, \n      el2 = index2, \n      el3 = index3, \n      el4 = index4, \n      el5 = index5, \n      less = left + 1, \n      great = right - 1, \n      tmp = 0\n  if(compare(el1, el2, data)) {\n    tmp = el1\n    el1 = el2\n    el2 = tmp\n  }\n  if(compare(el4, el5, data)) {\n    tmp = el4\n    el4 = el5\n    el5 = tmp\n  }\n  if(compare(el1, el3, data)) {\n    tmp = el1\n    el1 = el3\n    el3 = tmp\n  }\n  if(compare(el2, el3, data)) {\n    tmp = el2\n    el2 = el3\n    el3 = tmp\n  }\n  if(compare(el1, el4, data)) {\n    tmp = el1\n    el1 = el4\n    el4 = tmp\n  }\n  if(compare(el3, el4, data)) {\n    tmp = el3\n    el3 = el4\n    el4 = tmp\n  }\n  if(compare(el2, el5, data)) {\n    tmp = el2\n    el2 = el5\n    el5 = tmp\n  }\n  if(compare(el2, el3, data)) {\n    tmp = el2\n    el2 = el3\n    el3 = tmp\n  }\n  if(compare(el4, el5, data)) {\n    tmp = el4\n    el4 = el5\n    el5 = tmp\n  }\n\n  var pivot1X = data[2*el2]\n  var pivot1Y = data[2*el2+1]\n  var pivot2X = data[2*el4]\n  var pivot2Y = data[2*el4+1]\n\n  var ptr0 = 2 * el1;\n  var ptr2 = 2 * el3;\n  var ptr4 = 2 * el5;\n  var ptr5 = 2 * index1;\n  var ptr6 = 2 * index3;\n  var ptr7 = 2 * index5;\n  for (var i1 = 0; i1 < 2; ++i1) {\n    var x = data[ptr0+i1];\n    var y = data[ptr2+i1];\n    var z = data[ptr4+i1];\n    data[ptr5+i1] = x;\n    data[ptr6+i1] = y;\n    data[ptr7+i1] = z;\n  }\n\n  move(index2, left, data)\n  move(index4, right, data)\n  for (var k = less; k <= great; ++k) {\n    if (comparePivot(k, pivot1X, pivot1Y, data)) {\n      if (k !== less) {\n        swap(k, less, data)\n      }\n      ++less;\n    } else {\n      if (!comparePivot(k, pivot2X, pivot2Y, data)) {\n        while (true) {\n          if (!comparePivot(great, pivot2X, pivot2Y, data)) {\n            if (--great < k) {\n              break;\n            }\n            continue;\n          } else {\n            if (comparePivot(great, pivot1X, pivot1Y, data)) {\n              rotate(k, less, great, data)\n              ++less;\n              --great;\n            } else {\n              swap(k, great, data)\n              --great;\n            }\n            break;\n          }\n        }\n      }\n    }\n  }\n  shufflePivot(left, less-1, pivot1X, pivot1Y, data)\n  shufflePivot(right, great+1, pivot2X, pivot2Y, data)\n  if (less - 2 - left <= INSERT_SORT_CUTOFF) {\n    insertionSort(left, less - 2, data);\n  } else {\n    quickSort(left, less - 2, data);\n  }\n  if (right - (great + 2) <= INSERT_SORT_CUTOFF) {\n    insertionSort(great + 2, right, data);\n  } else {\n    quickSort(great + 2, right, data);\n  }\n  if (great - less <= INSERT_SORT_CUTOFF) {\n    insertionSort(less, great, data);\n  } else {\n    quickSort(less, great, data);\n  }\n}","'use strict'\n\nmodule.exports = boxIntersectIter\n\nvar pool = require('typedarray-pool')\nvar bits = require('bit-twiddle')\nvar bruteForce = require('./brute')\nvar bruteForcePartial = bruteForce.partial\nvar bruteForceFull = bruteForce.full\nvar sweep = require('./sweep')\nvar findMedian = require('./median')\nvar genPartition = require('./partition')\n\n//Twiddle parameters\nvar BRUTE_FORCE_CUTOFF    = 128       //Cut off for brute force search\nvar SCAN_CUTOFF           = (1<<22)   //Cut off for two way scan\nvar SCAN_COMPLETE_CUTOFF  = (1<<22)  \n\n//Partition functions\nvar partitionInteriorContainsInterval = genPartition(\n  '!(lo>=p0)&&!(p1>=hi)', \n  ['p0', 'p1'])\n\nvar partitionStartEqual = genPartition(\n  'lo===p0',\n  ['p0'])\n\nvar partitionStartLessThan = genPartition(\n  'lo<p0',\n  ['p0'])\n\nvar partitionEndLessThanEqual = genPartition(\n  'hi<=p0',\n  ['p0'])\n\nvar partitionContainsPoint = genPartition(\n  'lo<=p0&&p0<=hi',\n  ['p0'])\n\nvar partitionContainsPointProper = genPartition(\n  'lo<p0&&p0<=hi',\n  ['p0'])\n\n//Frame size for iterative loop\nvar IFRAME_SIZE = 6\nvar DFRAME_SIZE = 2\n\n//Data for box statck\nvar INIT_CAPACITY = 1024\nvar BOX_ISTACK  = pool.mallocInt32(INIT_CAPACITY)\nvar BOX_DSTACK  = pool.mallocDouble(INIT_CAPACITY)\n\n//Initialize iterative loop queue\nfunction iterInit(d, count) {\n  var levels = (8 * bits.log2(count+1) * (d+1))|0\n  var maxInts = bits.nextPow2(IFRAME_SIZE*levels)\n  if(BOX_ISTACK.length < maxInts) {\n    pool.free(BOX_ISTACK)\n    BOX_ISTACK = pool.mallocInt32(maxInts)\n  }\n  var maxDoubles = bits.nextPow2(DFRAME_SIZE*levels)\n  if(BOX_DSTACK.length < maxDoubles) {\n    pool.free(BOX_DSTACK)\n    BOX_DSTACK = pool.mallocDouble(maxDoubles)\n  }\n}\n\n//Append item to queue\nfunction iterPush(ptr,\n  axis, \n  redStart, redEnd, \n  blueStart, blueEnd, \n  state, \n  lo, hi) {\n\n  var iptr = IFRAME_SIZE * ptr\n  BOX_ISTACK[iptr]   = axis\n  BOX_ISTACK[iptr+1] = redStart\n  BOX_ISTACK[iptr+2] = redEnd\n  BOX_ISTACK[iptr+3] = blueStart\n  BOX_ISTACK[iptr+4] = blueEnd\n  BOX_ISTACK[iptr+5] = state\n\n  var dptr = DFRAME_SIZE * ptr\n  BOX_DSTACK[dptr]   = lo\n  BOX_DSTACK[dptr+1] = hi\n}\n\n//Special case:  Intersect single point with list of intervals\nfunction onePointPartial(\n  d, axis, visit, flip,\n  redStart, redEnd, red, redIndex,\n  blueOffset, blue, blueId) {\n\n  var elemSize = 2 * d\n  var bluePtr  = blueOffset * elemSize\n  var blueX    = blue[bluePtr + axis]\n\nred_loop:\n  for(var i=redStart, redPtr=redStart*elemSize; i<redEnd; ++i, redPtr+=elemSize) {\n    var r0 = red[redPtr+axis]\n    var r1 = red[redPtr+axis+d]\n    if(blueX < r0 || r1 < blueX) {\n      continue\n    }\n    if(flip && blueX === r0) {\n      continue\n    }\n    var redId = redIndex[i]\n    for(var j=axis+1; j<d; ++j) {\n      var r0 = red[redPtr+j]\n      var r1 = red[redPtr+j+d]\n      var b0 = blue[bluePtr+j]\n      var b1 = blue[bluePtr+j+d]\n      if(r1 < b0 || b1 < r0) {\n        continue red_loop\n      }\n    }\n    var retval\n    if(flip) {\n      retval = visit(blueId, redId)\n    } else {\n      retval = visit(redId, blueId)\n    }\n    if(retval !== void 0) {\n      return retval\n    }\n  }\n}\n\n//Special case:  Intersect one point with list of intervals\nfunction onePointFull(\n  d, axis, visit,\n  redStart, redEnd, red, redIndex,\n  blueOffset, blue, blueId) {\n\n  var elemSize = 2 * d\n  var bluePtr  = blueOffset * elemSize\n  var blueX    = blue[bluePtr + axis]\n\nred_loop:\n  for(var i=redStart, redPtr=redStart*elemSize; i<redEnd; ++i, redPtr+=elemSize) {\n    var redId = redIndex[i]\n    if(redId === blueId) {\n      continue\n    }\n    var r0 = red[redPtr+axis]\n    var r1 = red[redPtr+axis+d]\n    if(blueX < r0 || r1 < blueX) {\n      continue\n    }\n    for(var j=axis+1; j<d; ++j) {\n      var r0 = red[redPtr+j]\n      var r1 = red[redPtr+j+d]\n      var b0 = blue[bluePtr+j]\n      var b1 = blue[bluePtr+j+d]\n      if(r1 < b0 || b1 < r0) {\n        continue red_loop\n      }\n    }\n    var retval = visit(redId, blueId)\n    if(retval !== void 0) {\n      return retval\n    }\n  }\n}\n\n//The main box intersection routine\nfunction boxIntersectIter(\n  d, visit, initFull,\n  xSize, xBoxes, xIndex,\n  ySize, yBoxes, yIndex) {\n\n  //Reserve memory for stack\n  iterInit(d, xSize + ySize)\n\n  var top  = 0\n  var elemSize = 2 * d\n  var retval\n\n  iterPush(top++,\n      0,\n      0, xSize,\n      0, ySize,\n      initFull ? 16 : 0, \n      -Infinity, Infinity)\n  if(!initFull) {\n    iterPush(top++,\n      0,\n      0, ySize,\n      0, xSize,\n      1, \n      -Infinity, Infinity)\n  }\n\n  while(top > 0) {\n    top  -= 1\n\n    var iptr = top * IFRAME_SIZE\n    var axis      = BOX_ISTACK[iptr]\n    var redStart  = BOX_ISTACK[iptr+1]\n    var redEnd    = BOX_ISTACK[iptr+2]\n    var blueStart = BOX_ISTACK[iptr+3]\n    var blueEnd   = BOX_ISTACK[iptr+4]\n    var state     = BOX_ISTACK[iptr+5]\n\n    var dptr = top * DFRAME_SIZE\n    var lo        = BOX_DSTACK[dptr]\n    var hi        = BOX_DSTACK[dptr+1]\n\n    //Unpack state info\n    var flip      = (state & 1)\n    var full      = !!(state & 16)\n\n    //Unpack indices\n    var red       = xBoxes\n    var redIndex  = xIndex\n    var blue      = yBoxes\n    var blueIndex = yIndex\n    if(flip) {\n      red         = yBoxes\n      redIndex    = yIndex\n      blue        = xBoxes\n      blueIndex   = xIndex\n    }\n\n    if(state & 2) {\n      redEnd = partitionStartLessThan(\n        d, axis,\n        redStart, redEnd, red, redIndex,\n        hi)\n      if(redStart >= redEnd) {\n        continue\n      }\n    }\n    if(state & 4) {\n      redStart = partitionEndLessThanEqual(\n        d, axis,\n        redStart, redEnd, red, redIndex,\n        lo)\n      if(redStart >= redEnd) {\n        continue\n      }\n    }\n    \n    var redCount  = redEnd  - redStart\n    var blueCount = blueEnd - blueStart\n\n    if(full) {\n      if(d * redCount * (redCount + blueCount) < SCAN_COMPLETE_CUTOFF) {\n        retval = sweep.scanComplete(\n          d, axis, visit, \n          redStart, redEnd, red, redIndex,\n          blueStart, blueEnd, blue, blueIndex)\n        if(retval !== void 0) {\n          return retval\n        }\n        continue\n      }\n    } else {\n      if(d * Math.min(redCount, blueCount) < BRUTE_FORCE_CUTOFF) {\n        //If input small, then use brute force\n        retval = bruteForcePartial(\n            d, axis, visit, flip,\n            redStart,  redEnd,  red,  redIndex,\n            blueStart, blueEnd, blue, blueIndex)\n        if(retval !== void 0) {\n          return retval\n        }\n        continue\n      } else if(d * redCount * blueCount < SCAN_CUTOFF) {\n        //If input medium sized, then use sweep and prune\n        retval = sweep.scanBipartite(\n          d, axis, visit, flip, \n          redStart, redEnd, red, redIndex,\n          blueStart, blueEnd, blue, blueIndex)\n        if(retval !== void 0) {\n          return retval\n        }\n        continue\n      }\n    }\n    \n    //First, find all red intervals whose interior contains (lo,hi)\n    var red0 = partitionInteriorContainsInterval(\n      d, axis, \n      redStart, redEnd, red, redIndex,\n      lo, hi)\n\n    //Lower dimensional case\n    if(redStart < red0) {\n\n      if(d * (red0 - redStart) < BRUTE_FORCE_CUTOFF) {\n        //Special case for small inputs: use brute force\n        retval = bruteForceFull(\n          d, axis+1, visit,\n          redStart, red0, red, redIndex,\n          blueStart, blueEnd, blue, blueIndex)\n        if(retval !== void 0) {\n          return retval\n        }\n      } else if(axis === d-2) {\n        if(flip) {\n          retval = sweep.sweepBipartite(\n            d, visit,\n            blueStart, blueEnd, blue, blueIndex,\n            redStart, red0, red, redIndex)\n        } else {\n          retval = sweep.sweepBipartite(\n            d, visit,\n            redStart, red0, red, redIndex,\n            blueStart, blueEnd, blue, blueIndex)\n        }\n        if(retval !== void 0) {\n          return retval\n        }\n      } else {\n        iterPush(top++,\n          axis+1,\n          redStart, red0,\n          blueStart, blueEnd,\n          flip,\n          -Infinity, Infinity)\n        iterPush(top++,\n          axis+1,\n          blueStart, blueEnd,\n          redStart, red0,\n          flip^1,\n          -Infinity, Infinity)\n      }\n    }\n\n    //Divide and conquer phase\n    if(red0 < redEnd) {\n\n      //Cut blue into 3 parts:\n      //\n      //  Points < mid point\n      //  Points = mid point\n      //  Points > mid point\n      //\n      var blue0 = findMedian(\n        d, axis, \n        blueStart, blueEnd, blue, blueIndex)\n      var mid = blue[elemSize * blue0 + axis]\n      var blue1 = partitionStartEqual(\n        d, axis,\n        blue0, blueEnd, blue, blueIndex,\n        mid)\n\n      //Right case\n      if(blue1 < blueEnd) {\n        iterPush(top++,\n          axis,\n          red0, redEnd,\n          blue1, blueEnd,\n          (flip|4) + (full ? 16 : 0),\n          mid, hi)\n      }\n\n      //Left case\n      if(blueStart < blue0) {\n        iterPush(top++,\n          axis,\n          red0, redEnd,\n          blueStart, blue0,\n          (flip|2) + (full ? 16 : 0),\n          lo, mid)\n      }\n\n      //Center case (the hard part)\n      if(blue0 + 1 === blue1) {\n        //Optimization: Range with exactly 1 point, use a brute force scan\n        if(full) {\n          retval = onePointFull(\n            d, axis, visit,\n            red0, redEnd, red, redIndex,\n            blue0, blue, blueIndex[blue0])\n        } else {\n          retval = onePointPartial(\n            d, axis, visit, flip,\n            red0, redEnd, red, redIndex,\n            blue0, blue, blueIndex[blue0])\n        }\n        if(retval !== void 0) {\n          return retval\n        }\n      } else if(blue0 < blue1) {\n        var red1\n        if(full) {\n          //If full intersection, need to handle special case\n          red1 = partitionContainsPoint(\n            d, axis,\n            red0, redEnd, red, redIndex,\n            mid)\n          if(red0 < red1) {\n            var redX = partitionStartEqual(\n              d, axis,\n              red0, red1, red, redIndex,\n              mid)\n            if(axis === d-2) {\n              //Degenerate sweep intersection:\n              //  [red0, redX] with [blue0, blue1]\n              if(red0 < redX) {\n                retval = sweep.sweepComplete(\n                  d, visit,\n                  red0, redX, red, redIndex,\n                  blue0, blue1, blue, blueIndex)\n                if(retval !== void 0) {\n                  return retval\n                }\n              }\n\n              //Normal sweep intersection:\n              //  [redX, red1] with [blue0, blue1]\n              if(redX < red1) {\n                retval = sweep.sweepBipartite(\n                  d, visit,\n                  redX, red1, red, redIndex,\n                  blue0, blue1, blue, blueIndex)\n                if(retval !== void 0) {\n                  return retval\n                }\n              }\n            } else {\n              if(red0 < redX) {\n                iterPush(top++,\n                  axis+1,\n                  red0, redX,\n                  blue0, blue1,\n                  16,\n                  -Infinity, Infinity)\n              }\n              if(redX < red1) {\n                iterPush(top++,\n                  axis+1,\n                  redX, red1,\n                  blue0, blue1,\n                  0,\n                  -Infinity, Infinity)\n                iterPush(top++,\n                  axis+1,\n                  blue0, blue1,\n                  redX, red1,\n                  1,\n                  -Infinity, Infinity)\n              }\n            }\n          }\n        } else {\n          if(flip) {\n            red1 = partitionContainsPointProper(\n              d, axis,\n              red0, redEnd, red, redIndex,\n              mid)\n          } else {\n            red1 = partitionContainsPoint(\n              d, axis,\n              red0, redEnd, red, redIndex,\n              mid)\n          }\n          if(red0 < red1) {\n            if(axis === d-2) {\n              if(flip) {\n                retval = sweep.sweepBipartite(\n                  d, visit,\n                  blue0, blue1, blue, blueIndex,\n                  red0, red1, red, redIndex)\n              } else {\n                retval = sweep.sweepBipartite(\n                  d, visit,\n                  red0, red1, red, redIndex,\n                  blue0, blue1, blue, blueIndex)\n              }\n            } else {\n              iterPush(top++,\n                axis+1,\n                red0, red1,\n                blue0, blue1,\n                flip,\n                -Infinity, Infinity)\n              iterPush(top++,\n                axis+1,\n                blue0, blue1,\n                red0, red1,\n                flip^1,\n                -Infinity, Infinity)\n            }\n          }\n        }\n      }\n    }\n  }\n}","'use strict'\n\nvar DIMENSION   = 'd'\nvar AXIS        = 'ax'\nvar VISIT       = 'vv'\nvar FLIP        = 'fp'\n\nvar ELEM_SIZE   = 'es'\n\nvar RED_START   = 'rs'\nvar RED_END     = 're'\nvar RED_BOXES   = 'rb'\nvar RED_INDEX   = 'ri'\nvar RED_PTR     = 'rp'\n\nvar BLUE_START  = 'bs'\nvar BLUE_END    = 'be'\nvar BLUE_BOXES  = 'bb'\nvar BLUE_INDEX  = 'bi'\nvar BLUE_PTR    = 'bp'\n\nvar RETVAL      = 'rv'\n\nvar INNER_LABEL = 'Q'\n\nvar ARGS = [\n  DIMENSION,\n  AXIS,\n  VISIT,\n  RED_START,\n  RED_END,\n  RED_BOXES,\n  RED_INDEX,\n  BLUE_START,\n  BLUE_END,\n  BLUE_BOXES,\n  BLUE_INDEX\n]\n\nfunction generateBruteForce(redMajor, flip, full) {\n  var funcName = 'bruteForce' + \n    (redMajor ? 'Red' : 'Blue') + \n    (flip ? 'Flip' : '') +\n    (full ? 'Full' : '')\n\n  var code = ['function ', funcName, '(', ARGS.join(), '){',\n    'var ', ELEM_SIZE, '=2*', DIMENSION, ';']\n\n  var redLoop = \n    'for(var i=' + RED_START + ',' + RED_PTR + '=' + ELEM_SIZE + '*' + RED_START + ';' +\n        'i<' + RED_END +';' +\n        '++i,' + RED_PTR + '+=' + ELEM_SIZE + '){' +\n        'var x0=' + RED_BOXES + '[' + AXIS + '+' + RED_PTR + '],' +\n            'x1=' + RED_BOXES + '[' + AXIS + '+' + RED_PTR + '+' + DIMENSION + '],' +\n            'xi=' + RED_INDEX + '[i];'\n\n  var blueLoop = \n    'for(var j=' + BLUE_START + ',' + BLUE_PTR + '=' + ELEM_SIZE + '*' + BLUE_START + ';' +\n        'j<' + BLUE_END + ';' +\n        '++j,' + BLUE_PTR + '+=' + ELEM_SIZE + '){' +\n        'var y0=' + BLUE_BOXES + '[' + AXIS + '+' + BLUE_PTR + '],' +\n            (full ? 'y1=' + BLUE_BOXES + '[' + AXIS + '+' + BLUE_PTR + '+' + DIMENSION + '],' : '') +\n            'yi=' + BLUE_INDEX + '[j];'\n\n  if(redMajor) {\n    code.push(redLoop, INNER_LABEL, ':', blueLoop)\n  } else {\n    code.push(blueLoop, INNER_LABEL, ':', redLoop)\n  }\n\n  if(full) {\n    code.push('if(y1<x0||x1<y0)continue;')\n  } else if(flip) {\n    code.push('if(y0<=x0||x1<y0)continue;')\n  } else {\n    code.push('if(y0<x0||x1<y0)continue;')\n  }\n\n  code.push('for(var k='+AXIS+'+1;k<'+DIMENSION+';++k){'+\n    'var r0='+RED_BOXES+'[k+'+RED_PTR+'],'+\n        'r1='+RED_BOXES+'[k+'+DIMENSION+'+'+RED_PTR+'],'+\n        'b0='+BLUE_BOXES+'[k+'+BLUE_PTR+'],'+\n        'b1='+BLUE_BOXES+'[k+'+DIMENSION+'+'+BLUE_PTR+'];'+\n      'if(r1<b0||b1<r0)continue ' + INNER_LABEL + ';}' +\n      'var ' + RETVAL + '=' + VISIT + '(')\n\n  if(flip) {\n    code.push('yi,xi')\n  } else {\n    code.push('xi,yi')\n  }\n\n  code.push(');if(' + RETVAL + '!==void 0)return ' + RETVAL + ';}}}')\n\n  return {\n    name: funcName, \n    code: code.join('')\n  }\n}\n\nfunction bruteForcePlanner(full) {\n  var funcName = 'bruteForce' + (full ? 'Full' : 'Partial')\n  var prefix = []\n  var fargs = ARGS.slice()\n  if(!full) {\n    fargs.splice(3, 0, FLIP)\n  }\n\n  var code = ['function ' + funcName + '(' + fargs.join() + '){']\n\n  function invoke(redMajor, flip) {\n    var res = generateBruteForce(redMajor, flip, full)\n    prefix.push(res.code)\n    code.push('return ' + res.name + '(' + ARGS.join() + ');')\n  }\n\n  code.push('if(' + RED_END + '-' + RED_START + '>' +\n                    BLUE_END + '-' + BLUE_START + '){')\n\n  if(full) {\n    invoke(true, false)\n    code.push('}else{')\n    invoke(false, false)\n  } else {\n    code.push('if(' + FLIP + '){')\n    invoke(true, true)\n    code.push('}else{')\n    invoke(true, false)\n    code.push('}}else{if(' + FLIP + '){')\n    invoke(false, true)\n    code.push('}else{')\n    invoke(false, false)\n    code.push('}')\n  }\n  code.push('}}return ' + funcName)\n\n  var codeStr = prefix.join('') + code.join('')\n  var proc = new Function(codeStr)\n  return proc()\n}\n\n\nexports.partial = bruteForcePlanner(false)\nexports.full    = bruteForcePlanner(true)","'use strict'\n\nmodule.exports = findMedian\n\nvar genPartition = require('./partition')\n\nvar partitionStartLessThan = genPartition('lo<p0', ['p0'])\n\nvar PARTITION_THRESHOLD = 8   //Cut off for using insertion sort in findMedian\n\n//Base case for median finding:  Use insertion sort\nfunction insertionSort(d, axis, start, end, boxes, ids) {\n  var elemSize = 2 * d\n  var boxPtr = elemSize * (start+1) + axis\n  for(var i=start+1; i<end; ++i, boxPtr+=elemSize) {\n    var x = boxes[boxPtr]\n    for(var j=i, ptr=elemSize*(i-1); \n        j>start && boxes[ptr+axis] > x; \n        --j, ptr-=elemSize) {\n      //Swap\n      var aPtr = ptr\n      var bPtr = ptr+elemSize\n      for(var k=0; k<elemSize; ++k, ++aPtr, ++bPtr) {\n        var y = boxes[aPtr]\n        boxes[aPtr] = boxes[bPtr]\n        boxes[bPtr] = y\n      }\n      var tmp = ids[j]\n      ids[j] = ids[j-1]\n      ids[j-1] = tmp\n    }\n  }\n}\n\n//Find median using quick select algorithm\n//  takes O(n) time with high probability\nfunction findMedian(d, axis, start, end, boxes, ids) {\n  if(end <= start+1) {\n    return start\n  }\n\n  var lo       = start\n  var hi       = end\n  var mid      = ((end + start) >>> 1)\n  var elemSize = 2*d\n  var pivot    = mid\n  var value    = boxes[elemSize*mid+axis]\n  \n  while(lo < hi) {\n    if(hi - lo < PARTITION_THRESHOLD) {\n      insertionSort(d, axis, lo, hi, boxes, ids)\n      value = boxes[elemSize*mid+axis]\n      break\n    }\n    \n    //Select pivot using median-of-3\n    var count  = hi - lo\n    var pivot0 = (Math.random()*count+lo)|0\n    var value0 = boxes[elemSize*pivot0 + axis]\n    var pivot1 = (Math.random()*count+lo)|0\n    var value1 = boxes[elemSize*pivot1 + axis]\n    var pivot2 = (Math.random()*count+lo)|0\n    var value2 = boxes[elemSize*pivot2 + axis]\n    if(value0 <= value1) {\n      if(value2 >= value1) {\n        pivot = pivot1\n        value = value1\n      } else if(value0 >= value2) {\n        pivot = pivot0\n        value = value0\n      } else {\n        pivot = pivot2\n        value = value2\n      }\n    } else {\n      if(value1 >= value2) {\n        pivot = pivot1\n        value = value1\n      } else if(value2 >= value0) {\n        pivot = pivot0\n        value = value0\n      } else {\n        pivot = pivot2\n        value = value2\n      }\n    }\n\n    //Swap pivot to end of array\n    var aPtr = elemSize * (hi-1)\n    var bPtr = elemSize * pivot\n    for(var i=0; i<elemSize; ++i, ++aPtr, ++bPtr) {\n      var x = boxes[aPtr]\n      boxes[aPtr] = boxes[bPtr]\n      boxes[bPtr] = x\n    }\n    var y = ids[hi-1]\n    ids[hi-1] = ids[pivot]\n    ids[pivot] = y\n\n    //Partition using pivot\n    pivot = partitionStartLessThan(\n      d, axis, \n      lo, hi-1, boxes, ids,\n      value)\n\n    //Swap pivot back\n    var aPtr = elemSize * (hi-1)\n    var bPtr = elemSize * pivot\n    for(var i=0; i<elemSize; ++i, ++aPtr, ++bPtr) {\n      var x = boxes[aPtr]\n      boxes[aPtr] = boxes[bPtr]\n      boxes[bPtr] = x\n    }\n    var y = ids[hi-1]\n    ids[hi-1] = ids[pivot]\n    ids[pivot] = y\n\n    //Swap pivot to last pivot\n    if(mid < pivot) {\n      hi = pivot-1\n      while(lo < hi && \n        boxes[elemSize*(hi-1)+axis] === value) {\n        hi -= 1\n      }\n      hi += 1\n    } else if(pivot < mid) {\n      lo = pivot + 1\n      while(lo < hi &&\n        boxes[elemSize*lo+axis] === value) {\n        lo += 1\n      }\n    } else {\n      break\n    }\n  }\n\n  //Make sure pivot is at start\n  return partitionStartLessThan(\n    d, axis, \n    start, mid, boxes, ids,\n    boxes[elemSize*mid+axis])\n}","\n\nexport default function (noa) {\n    return {\n\n        name: 'collideTerrain',\n\n        order: 0,\n\n        state: {\n            callback: null\n        },\n\n        onAdd: function (eid, state) {\n            // add collide handler for physics engine to call\n            var ents = noa.entities\n            if (ents.hasPhysics(eid)) {\n                var body = ents.getPhysicsBody(eid)\n                body.onCollide = function bodyOnCollide(impulse) {\n                    var cb = noa.ents.getCollideTerrain(eid).callback\n                    if (cb) cb(impulse, eid)\n                }\n            }\n        },\n\n        onRemove: function (eid, state) {\n            var ents = noa.entities\n            if (ents.hasPhysics(eid)) {\n                ents.getPhysicsBody(eid).onCollide = null\n            }\n        },\n\n\n\n    }\n}\n","\n/**\n * Component for the player entity, when active hides the player's mesh \n * when camera zoom is less than a certain amount\n */\n\nexport default function (noa) {\n    return {\n\n        name: 'fadeOnZoom',\n\n        order: 99,\n\n        state: {\n            cutoff: 1.5,\n            _showing: true\n        },\n\n        onAdd: null,\n\n        onRemove: null,\n\n        system: function fadeOnZoomProc(dt, states) {\n            var zoom = noa.camera.currentZoom\n            var ents = noa.entities\n            states.forEach(state => {\n                checkZoom(state, state.__id, zoom, ents)\n            })\n        }\n    }\n}\n\n\nfunction checkZoom(state, id, zoom, ents) {\n    if (!ents.hasMesh(id)) return\n\n    if (state._showing && zoom < state.cutoff || !state._showing && zoom > state.cutoff) {\n        var mesh = ents.getMeshData(id).mesh\n        mesh.visibility = state._showing = (zoom > state.cutoff)\n    }\n}\n","var vec3 = require('gl-vec3')\n\n\n/*\n * Indicates that an entity should be moved to another entity's position each tick,\n * possibly by a fixed offset, and the same for renderPositions each render\n */\n\nexport default function (noa) {\n\n    return {\n\n        name: 'followsEntity',\n\n        order: 50,\n\n        state: {\n            entity: 0 | 0,\n            offset: null,\n            onTargetMissing: null,\n        },\n\n        onAdd: function (eid, state) {\n            var off = vec3.create()\n            state.offset = (state.offset) ? vec3.copy(off, state.offset) : off\n            updatePosition(state)\n            updateRenderPosition(state)\n        },\n\n        onRemove: null,\n\n\n        // on tick, copy over regular positions\n        system: function followEntity(dt, states) {\n            states.forEach(state => updatePosition(state))\n        },\n\n\n        // on render, copy over render positions\n        renderSystem: function followEntityMesh(dt, states) {\n            states.forEach(state => updateRenderPosition(state))\n        }\n    }\n\n\n\n    function updatePosition(state) {\n        var id = state.__id\n        var self = noa.ents.getPositionData(id)\n        var other = noa.ents.getPositionData(state.entity)\n        if (!other) {\n            if (state.onTargetMissing) state.onTargetMissing(id)\n            noa.ents.removeComponent(id, noa.ents.names.followsEntity)\n        } else {\n            vec3.add(self._localPosition, other._localPosition, state.offset)\n        }\n    }\n\n    function updateRenderPosition(state) {\n        var id = state.__id\n        var self = noa.ents.getPositionData(id)\n        var other = noa.ents.getPositionData(state.entity)\n        if (other) {\n            vec3.add(self._renderPosition, other._renderPosition, state.offset)\n        }\n    }\n\n}\n","\nvar vec3 = require('gl-vec3')\n\n\nexport default function (noa) {\n    return {\n\n        name: 'mesh',\n\n        order: 100,\n\n        state: {\n            mesh: null,\n            offset: null\n        },\n\n\n        onAdd: function (eid, state) {\n            // implicitly assume there's already a position component\n            var posDat = noa.ents.getPositionData(eid)\n            if (state.mesh) {\n                noa.rendering.addMeshToScene(state.mesh, false, posDat.position)\n            } else {\n                throw new Error('Mesh component added without a mesh - probably a bug!')\n            }\n            if (!state.offset) state.offset = new vec3.create()\n\n            // set mesh to correct position\n            var rpos = posDat._renderPosition\n            state.mesh.position.copyFromFloats(\n                rpos[0] + state.offset[0],\n                rpos[1] + state.offset[1],\n                rpos[2] + state.offset[2])\n        },\n\n\n        onRemove: function (eid, state) {\n            state.mesh.dispose()\n        },\n\n\n\n        renderSystem: function (dt, states) {\n            // before render move each mesh to its render position, \n            // set by the physics engine or driving logic\n\n            states.forEach(state => {\n                var id = state.__id\n\n                var rpos = noa.ents.getPositionData(id)._renderPosition\n                state.mesh.position.copyFromFloats(\n                    rpos[0] + state.offset[0],\n                    rpos[1] + state.offset[1],\n                    rpos[2] + state.offset[2])\n            })\n        }\n\n\n    }\n}\n","var vec3 = require('gl-vec3')\n\n/**\n * \n * Movement component. State stores settings like jump height, etc.,\n * as well as current state (running, jumping, heading angle).\n * Processor checks state and applies movement/friction/jump forces\n * to the entity's physics body. \n * \n */\n\nexport default function (noa) {\n    return {\n\n        name: 'movement',\n\n        order: 30,\n\n        state: {\n            // current state\n            heading: 0, // radians\n            running: false,\n            jumping: false,\n\n            // options:\n            maxSpeed: 10,\n            moveForce: 30,\n            responsiveness: 15,\n            runningFriction: 0,\n            standingFriction: 2,\n\n            airMoveMult: 0.5,\n            jumpImpulse: 10,\n            jumpForce: 12,\n            jumpTime: 500, // ms\n            airJumps: 1,\n\n            // internal state\n            _jumpCount: 0,\n            _isJumping: 0,\n            _currjumptime: 0,\n        },\n\n        onAdd: null,\n\n        onRemove: null,\n\n\n        system: function movementProcessor(dt, states) {\n            var ents = noa.entities\n\n            states.forEach(state => {\n                var body = ents.getPhysicsBody(state.__id)\n                applyMovementPhysics(dt, state, body)\n            })\n\n        }\n\n\n    }\n}\n\n\nvar tempvec = vec3.create()\nvar tempvec2 = vec3.create()\nvar zeroVec = vec3.create()\n\n\nfunction applyMovementPhysics(dt, state, body) {\n    // move implementation originally written as external module\n    //   see https://github.com/andyhall/voxel-fps-controller\n    //   for original code\n\n    // jumping\n    var onGround = (body.atRestY() < 0)\n    var canjump = (onGround || state._jumpCount < state.airJumps)\n    if (onGround) {\n        state._isJumping = false\n        state._jumpCount = 0\n    }\n\n    // process jump input\n    if (state.jumping) {\n        if (state._isJumping) { // continue previous jump\n            if (state._currjumptime > 0) {\n                var jf = state.jumpForce\n                if (state._currjumptime < dt) jf *= state._currjumptime / dt\n                body.applyForce([0, jf, 0])\n                state._currjumptime -= dt\n            }\n        } else if (canjump) { // start new jump\n            state._isJumping = true\n            if (!onGround) state._jumpCount++\n            state._currjumptime = state.jumpTime\n            body.applyImpulse([0, state.jumpImpulse, 0])\n            // clear downward velocity on airjump\n            if (!onGround && body.velocity[1] < 0) body.velocity[1] = 0\n        }\n    } else {\n        state._isJumping = false\n    }\n\n    // apply movement forces if entity is moving, otherwise just friction\n    var m = tempvec\n    var push = tempvec2\n    if (state.running) {\n\n        var speed = state.maxSpeed\n        // todo: add crouch/sprint modifiers if needed\n        // if (state.sprint) speed *= state.sprintMoveMult\n        // if (state.crouch) speed *= state.crouchMoveMult\n        vec3.set(m, 0, 0, speed)\n\n        // rotate move vector to entity's heading\n        vec3.rotateY(m, m, zeroVec, state.heading)\n\n        // push vector to achieve desired speed & dir\n        // following code to adjust 2D velocity to desired amount is patterned on Quake: \n        // https://github.com/id-Software/Quake-III-Arena/blob/master/code/game/bg_pmove.c#L275\n        vec3.subtract(push, m, body.velocity)\n        push[1] = 0\n        var pushLen = vec3.length(push)\n        vec3.normalize(push, push)\n\n        if (pushLen > 0) {\n            // pushing force vector\n            var canPush = state.moveForce\n            if (!onGround) canPush *= state.airMoveMult\n\n            // apply final force\n            var pushAmt = state.responsiveness * pushLen\n            if (canPush > pushAmt) canPush = pushAmt\n\n            vec3.scale(push, push, canPush)\n            body.applyForce(push)\n        }\n\n        // different friction when not moving\n        // idea from Sonic: http://info.sonicretro.org/SPG:Running\n        body.friction = state.runningFriction\n    } else {\n        body.friction = state.standingFriction\n    }\n\n\n\n}\n","\n/**\n * \n * Input processing component - gets (key) input state and  \n * applies it to receiving entities by updating their movement \n * component state (heading, movespeed, jumping, etc.)\n * \n */\n\nexport default function (noa) {\n    return {\n\n        name: 'receivesInputs',\n\n        order: 20,\n\n        state: {},\n\n        onAdd: null,\n\n        onRemove: null,\n\n        system: function inputProcessor(dt, states) {\n            var ents = noa.entities\n            var inputState = noa.inputs.state\n            var camHeading = noa.camera.heading\n\n            states.forEach(state => {\n                var moveState = ents.getMovement(state.__id)\n                setMovementState(moveState, inputState, camHeading)\n            })\n        }\n\n    }\n}\n\n\n\nfunction setMovementState(state, inputs, camHeading) {\n    state.jumping = !!inputs.jump\n\n    var fb = inputs.forward ? (inputs.backward ? 0 : 1) : (inputs.backward ? -1 : 0)\n    var rl = inputs.right ? (inputs.left ? 0 : 1) : (inputs.left ? -1 : 0)\n\n    if ((fb | rl) === 0) {\n        state.running = false\n    } else {\n        state.running = true\n        if (fb) {\n            if (fb == -1) camHeading += Math.PI\n            if (rl) {\n                camHeading += Math.PI / 4 * fb * rl // didn't plan this but it works!\n            }\n        } else {\n            camHeading += rl * Math.PI / 2\n        }\n        state.heading = camHeading\n    }\n\n}\n","\nimport { Mesh } from '@babylonjs/core/Meshes/mesh'\nimport { Color3 } from '@babylonjs/core/Maths/math'\nvar vec3 = require('gl-vec3')\n\n\nexport default function (noa, dist) {\n\n    var shadowDist = dist\n\n    // create a mesh to re-use for shadows\n    var scene = noa.rendering.getScene()\n    var disc = Mesh.CreateDisc('shadow', 0.75, 30, scene)\n    disc.rotation.x = Math.PI / 2\n    disc.material = noa.rendering.makeStandardMaterial('shadowMat')\n    disc.material.diffuseColor = Color3.Black()\n    disc.material.ambientColor = Color3.Black()\n    disc.material.alpha = 0.5\n    disc.setEnabled(false)\n\n    // source mesh needn't be in the scene graph\n    scene.removeMesh(disc)\n\n\n    return {\n\n        name: 'shadow',\n\n        order: 80,\n\n        state: {\n            size: 0.5,\n            _mesh: null,\n        },\n\n\n        onAdd: function (eid, state) {\n            var mesh = disc.createInstance('shadow_instance')\n            noa.rendering.addMeshToScene(mesh)\n            mesh.setEnabled(false)\n            state._mesh = mesh\n        },\n\n\n        onRemove: function (eid, state) {\n            state._mesh.dispose()\n        },\n\n\n        system: function shadowSystem(dt, states) {\n            var cpos = noa.camera._localGetPosition()\n            var dist = shadowDist\n            states.forEach(state => {\n                var posState = noa.ents.getPositionData(state.__id)\n                var physState = noa.ents.getPhysics(state.__id)\n                updateShadowHeight(noa, posState, physState, state._mesh, state.size, dist, cpos)\n            })\n        },\n\n\n        renderSystem: function (dt, states) {\n            // before render adjust shadow x/z to render positions\n            states.forEach(state => {\n                var rpos = noa.ents.getPositionData(state.__id)._renderPosition\n                var spos = state._mesh.position\n                spos.x = rpos[0]\n                spos.z = rpos[2]\n            })\n        }\n\n\n\n\n    }\n}\n\nvar shadowPos = vec3.fromValues(0, 0, 0)\nvar down = vec3.fromValues(0, -1, 0)\n\nfunction updateShadowHeight(noa, posDat, physDat, mesh, size, shadowDist, camPos) {\n\n    // local Y ground position - from physics or raycast\n    var localY\n    if (physDat && physDat.body.resting[1] < 0) {\n        localY = posDat._localPosition[1]\n    } else {\n        var res = noa._localPick(posDat._localPosition, down, shadowDist)\n        if (!res) {\n            mesh.setEnabled(false)\n            return\n        }\n        localY = res.position[1] - noa.worldOriginOffset[1]\n    }\n\n    // round Y pos and offset upwards slightly to avoid z-fighting\n    localY = Math.round(localY) \n    vec3.copy(shadowPos, posDat._localPosition)\n    shadowPos[1] = localY\n    var sqdist = vec3.squaredDistance(camPos, shadowPos)\n    // offset ~ 0.01 for nearby shadows, up to 0.1 at distance of ~40\n    var offset = 0.01 + 0.1 * (sqdist / 1600)\n    if (offset > 0.1) offset = 0.1\n    mesh.position.y = localY + offset\n    // set shadow scale\n    var dist = posDat._localPosition[1] - localY\n    var scale = size * 0.7 * (1 - dist / shadowDist)\n    mesh.scaling.copyFromFloats(scale, scale, scale)\n    mesh.setEnabled(true)\n}\n","\n\nexport default function (noa) {\n    return {\n\n        name: 'smooth-camera',\n\n        order: 99,\n\n        state: {\n            time: 100.1\n        },\n\n        onAdd: null,\n\n        onRemove: null,\n\n        system: function (dt, states) {\n            // remove self after time elapses\n            states.forEach(state => {\n                state.time -= dt\n                if (state.time < 0) noa.ents.removeComponent(state.__id, 'smooth-camera')\n            })\n        },\n\n    }\n}\n","\nvar createGameShell = require('game-shell')\n// var createGameShell = require('../../../../npm-modules/game-shell')\nvar EventEmitter = require('events').EventEmitter\n\n\nexport default function (noa, opts) {\n    return new Container(noa, opts)\n}\n\n/**\n * @class\n * @typicalname noa.container\n * @emits DOMready\n * @classdesc Wraps `game-shell` module \n * and manages HTML container, canvas, etc.\n */\n\nfunction Container(noa, opts) {\n    opts = opts || {}\n    this._noa = noa\n    this._tickRate = opts.tickRate\n    this.element = opts.domElement || createContainerDiv()\n    this.canvas = getOrCreateCanvas(this.element)\n    this._shell = createShell(this.canvas, opts)\n\n    // mouse state/feature detection\n    this.hasPointerLock = false\n    this.supportsPointerLock = false\n    this.pointerInGame = false\n    this.isFocused = document.hasFocus()\n\n    // basic listeners\n    var self = this\n    var lockChange = function (ev) { onLockChange(self, ev) }\n    document.addEventListener(\"pointerlockchange\", lockChange, false)\n    document.addEventListener(\"mozpointerlockchange\", lockChange, false)\n    document.addEventListener(\"webkitpointerlockchange\", lockChange, false)\n    detectPointerLock(self)\n\n    self.element.addEventListener('mouseenter', function () { self.pointerInGame = true })\n    self.element.addEventListener('mouseleave', function () { self.pointerInGame = false })\n\n    window.addEventListener('focus', function () { self.isFocused = true })\n    window.addEventListener('blur', function () { self.isFocused = false })\n\n    // get shell events after it's initialized\n    this._shell.on('init', onShellInit.bind(null, this))\n}\n\nContainer.prototype = Object.create(EventEmitter.prototype)\n\n\n\n/*\n *   SHELL EVENTS\n */\n\nfunction onShellInit(self) {\n    // create shell listeners that drive engine functions\n    var noa = self._noa\n    var shell = self._shell\n    shell.on('resize', noa.rendering.resize.bind(noa.rendering))\n\n    // override shell's timing with simpler internal implementation\n    setupTimingEvents(self)\n\n    // let other components know DOM is ready\n    self.emit('DOMready')\n}\n\n\n\n\n\nfunction setupTimingEvents(self) {\n    var noa = self._noa\n    var tickRate = self._tickRate\n    var lastRAF = performance.now()\n    var tickAccum = 0\n    var onAnimationFrame = function () {\n        var t0 = performance.now()\n        var dt = t0 - lastRAF\n        tickAccum += dt\n        // do at most two ticks per render\n        var maxTicks = 2\n        while (tickAccum > tickRate && maxTicks-- > 0) {\n            noa.tick(tickRate)\n            tickAccum -= tickRate\n        }\n        // don't accrue deficit when running slow\n        if (tickAccum > tickRate) tickAccum = 0\n        var t1 = performance.now()\n        var renderPt = tickAccum + (t1 - t0)\n        var framePart = Math.min(1, renderPt / tickRate)\n        noa.render(framePart)\n        lastRAF = t0\n        requestAnimationFrame(onAnimationFrame)\n    }\n    requestAnimationFrame(onAnimationFrame)\n}\n\n\n\n\n\n\n/*\n *   PUBLIC API \n */\n\nContainer.prototype.appendTo = function (htmlElement) {\n    this.element.appendChild(htmlElement)\n}\n\n\n\nContainer.prototype.setPointerLock = function (lock) {\n    // not sure if this will work robustly\n    this._shell.pointerLock = !!lock\n}\n\n\n\n\n\n/*\n *   INTERNALS\n */\n\n\n\nfunction createContainerDiv() {\n    // based on github.com/mikolalysenko/game-shell - makeDefaultContainer()\n    var container = document.createElement(\"div\")\n    container.tabindex = 1\n    container.style.position = \"fixed\"\n    container.style.left = \"0px\"\n    container.style.right = \"0px\"\n    container.style.top = \"0px\"\n    container.style.bottom = \"0px\"\n    container.style.height = \"100%\"\n    container.style.overflow = \"hidden\"\n    document.body.appendChild(container)\n    document.body.style.overflow = \"hidden\" //Prevent bounce\n    document.body.style.height = \"100%\"\n    container.id = 'noa-container'\n    return container\n}\n\n\nfunction createShell(canvas, opts) {\n    var shellDefaults = {\n        pointerLock: true,\n        preventDefaults: false\n    }\n    opts = Object.assign(shellDefaults, opts)\n    opts.element = canvas\n    var shell = createGameShell(opts)\n    shell.preventDefaults = opts.preventDefaults\n    return shell\n}\n\nfunction getOrCreateCanvas(el) {\n    // based on github.com/stackgl/gl-now - default canvas\n    var canvas = el.querySelector('canvas')\n    if (!canvas) {\n        canvas = document.createElement('canvas')\n        canvas.style.position = \"absolute\"\n        canvas.style.left = \"0px\"\n        canvas.style.top = \"0px\"\n        canvas.style.height = \"100%\"\n        canvas.style.width = \"100%\"\n        canvas.id = 'noa-canvas'\n        el.insertBefore(canvas, el.firstChild)\n    }\n    return canvas\n}\n\n\n// track changes in Pointer Lock state\nfunction onLockChange(self, ev) {\n    var el = document.pointerLockElement ||\n        document.mozPointerLockElement ||\n        document.webkitPointerLockElement\n    if (el) {\n        self.hasPointerLock = true\n        self.emit('gainedPointerLock')\n    } else {\n        self.hasPointerLock = false\n        self.emit('lostPointerLock')\n    }\n    // this works around a Firefox bug where no mouse-in event \n    // gets issued after starting pointerlock\n    if (el) {\n        // act as if pointer is in game window while pointerLock is true\n        self.pointerInGame = true\n    }\n}\n\n\n// set up stuff to detect pointer lock support.\n// Needlessly complex because Chrome/Android claims to support but doesn't.\n// For now, just feature detect, but assume no support if a touch event occurs\n// TODO: see if this makes sense on hybrid touch/mouse devices\nfunction detectPointerLock(self) {\n    var lockElementExists =\n        ('pointerLockElement' in document) ||\n        ('mozPointerLockElement' in document) ||\n        ('webkitPointerLockElement' in document)\n    if (lockElementExists) {\n        self.supportsPointerLock = true\n        var listener = function (e) {\n            self.supportsPointerLock = false\n            document.removeEventListener(e.type, listener)\n        }\n        document.addEventListener('touchmove', listener)\n    }\n}\n","\n\n// helper to swap item to end and pop(), instead of splice()ing\nexport function removeUnorderedListItem(list, item) {\n    var i = list.indexOf(item)\n    if (i < 0) return\n    if (i === list.length - 1) {\n        list.pop()\n    } else {\n        list[i] = list.pop()\n    }\n}\n\n\n\n// loop over a function for a few ms, or until it returns true\nexport function loopForTime(maxTimeInMS, callback, startTime) {\n    var cutoff = (startTime || performance.now()) + maxTimeInMS\n    var maxIter = 1000 // sanity check\n    for (var i = 0; i < maxIter; i++) {\n        var res = callback()\n        if (res || performance.now() > cutoff) return\n    }\n}\n\n\n\n\n\n// ....\nexport function numberOfVoxelsInSphere(rad) {\n    if (rad === prevRad) return prevAnswer\n    var ext = Math.ceil(rad), ct = 0, rsq = rad * rad\n    for (var i = -ext; i <= ext; ++i) {\n        for (var j = -ext; j <= ext; ++j) {\n            for (var k = -ext; k <= ext; ++k) {\n                var dsq = i * i + j * j + k * k\n                if (dsq < rsq) ct++\n            }\n        }\n    }\n    prevRad = rad\n    prevAnswer = ct\n    return ct\n}\nvar prevRad = 0, prevAnswer = 0\n\n\n\n\n\n// partly \"unrolled\" loops to copy contents of ndarrays\n// when there's no source, zeroes out the array instead\nexport function copyNdarrayContents(src, tgt, pos, size, tgtPos) {\n    if (src) {\n        doNdarrayCopy(src, tgt, pos[0], pos[1], pos[2],\n            size[0], size[1], size[2], tgtPos[0], tgtPos[1], tgtPos[2])\n    } else {\n        doNdarrayZero(tgt, tgtPos[0], tgtPos[1], tgtPos[2],\n            size[0], size[1], size[2])\n    }\n}\nfunction doNdarrayCopy(src, tgt, i0, j0, k0, si, sj, sk, ti, tj, tk) {\n    for (var i = 0; i < si; i++) {\n        for (var j = 0; j < sj; j++) {\n            var six = src.index(i0 + i, j0 + j, k0)\n            var tix = tgt.index(ti + i, tj + j, tk)\n            for (var k = 0; k < sk; k++) {\n                tgt.data[tix] = src.data[six]\n                six += src.stride[2]\n                tix += tgt.stride[2]\n            }\n        }\n    }\n}\n\nfunction doNdarrayZero(tgt, i0, j0, k0, si, sj, sk) {\n    for (var i = 0; i < si; i++) {\n        for (var j = 0; j < sj; j++) {\n            var ix = tgt.index(i0 + i, j0 + j, k0)\n            for (var k = 0; k < sk; k++) {\n                tgt.data[ix] = 0\n                ix += tgt.stride[2]\n            }\n        }\n    }\n}\n\n\n\n\n\n\n\n/*\n * \n *      strList - internal data structure for lists of chunk IDs\n * \n*/\n\nexport function StringList() {\n    this.arr = []\n    this.hash = {}\n}\nStringList.prototype.includes = function (key) {\n    return this.hash[key]\n}\nStringList.prototype.add = function (key) {\n    if (this.hash[key]) return\n    this.arr.push(key)\n    this.hash[key] = true\n}\nStringList.prototype.remove = function (key) {\n    if (!this.hash[key]) return\n    this.arr.splice(this.arr.indexOf(key), 1)\n    delete this.hash[key]\n}\nStringList.prototype.count = function () { return this.arr.length }\nStringList.prototype.forEach = function (a, b) { return this.arr.forEach(a, b) }\nStringList.prototype.slice = function (a, b) { return this.arr.slice(a, b) }\nStringList.prototype.isEmpty = function () { return (this.arr.length === 0) }\nStringList.prototype.empty = function () {\n    this.arr.length = 0\n    this.hash = {}\n}\nStringList.prototype.pop = function () {\n    var key = this.arr.pop()\n    delete this.hash[key]\n    return key\n}\nStringList.prototype.sort = function (keyToDistanceFn) {\n    var mapping = {}\n    this.arr.forEach(key => { mapping[key] = keyToDistanceFn(key) })\n    this.arr.sort((a, b) => mapping[b] - mapping[a]) // DESCENDING!\n}\nStringList.prototype.copyFrom = function (list) {\n    this.arr = list.arr.slice()\n    this.hash = Object.assign({}, list.hash)\n}\n\n\n\n\n\n\n\n\n\n\n\n// simple thing for reporting time split up between several activities\nexport function makeProfileHook(_every, _title) {\n    var title = _title || ''\n    var every = _every || 1\n    var times = []\n    var names = []\n    var started = 0\n    var last = 0\n    var iter = 0\n    var total = 0\n    var clearNext = true\n\n    var start = function () {\n        if (clearNext) {\n            times.length = names.length = 0\n            clearNext = false\n        }\n        started = last = performance.now()\n        iter++\n    }\n    var add = function (name) {\n        var t = performance.now()\n        if (names.indexOf(name) < 0) names.push(name)\n        var i = names.indexOf(name)\n        if (!times[i]) times[i] = 0\n        times[i] += t - last\n        last = t\n    }\n    var report = function () {\n        total += performance.now() - started\n        if (iter === every) {\n            var head = title + ' total ' + (total / every).toFixed(2) + 'ms (avg, ' + every + ' runs)    '\n            console.log(head, names.map(function (name, i) {\n                return name + ': ' + (times[i] / every).toFixed(2) + 'ms    '\n            }).join(''))\n            clearNext = true\n            iter = 0\n            total = 0\n        }\n    }\n    return function profile_hook(state) {\n        if (state === 'start') start()\n        else if (state === 'end') report()\n        else add(state)\n    }\n}\n\n\n\n\n// simple thing for reporting time actions/sec\nexport function makeThroughputHook(_every, _title) {\n    var title = _title || ''\n    var every = _every || 1\n    var counts = {}\n    var started = performance.now()\n    var iter = 0\n    return function profile_hook(state) {\n        if (state === 'start') return\n        if (state === 'end') {\n            if (++iter < every) return\n            var t = performance.now()\n            console.log(title + '   ' + Object.keys(counts).map(k => {\n                var through = counts[k] / (t - started) * 1000\n                counts[k] = 0\n                return k + ':' + through.toFixed(2) + '   '\n            }).join(''))\n            started = t\n            iter = 0\n        } else {\n            if (!counts[state]) counts[state] = 0\n            counts[state]++\n        }\n    }\n}\n","var glvec3 = require('gl-vec3')\nimport { removeUnorderedListItem } from './util'\n\nimport { Scene } from '@babylonjs/core/scene'\nimport { FreeCamera } from '@babylonjs/core/Cameras/freeCamera'\nimport { Octree } from '@babylonjs/core/Culling/Octrees/octree'\nimport { OctreeBlock } from '@babylonjs/core/Culling/Octrees/octreeBlock'\nimport { Engine } from '@babylonjs/core/Engines/engine'\nimport { HemisphericLight } from '@babylonjs/core/Lights/hemisphericLight'\nimport { StandardMaterial } from '@babylonjs/core/Materials/standardMaterial'\nimport { Vector3, Color3 } from '@babylonjs/core/Maths/math'\nimport { Mesh } from '@babylonjs/core/Meshes/mesh'\nimport { OctreeSceneComponent } from '@babylonjs/core/Culling/Octrees/'\nimport '@babylonjs/core/Meshes/meshBuilder'\n\n\n\nexport default function (noa, opts, canvas) {\n    return new Rendering(noa, opts, canvas)\n}\n\n\n\n// profiling flag\nvar PROFILE = 0\n\n\n\nvar defaults = {\n    showFPS: false,\n    antiAlias: true,\n    clearColor: [0.8, 0.9, 1],\n    ambientColor: [1, 1, 1],\n    lightDiffuse: [1, 1, 1],\n    lightSpecular: [1, 1, 1],\n    groundLightColor: [0.5, 0.5, 0.5],\n    useAO: true,\n    AOmultipliers: [0.93, 0.8, 0.5],\n    reverseAOmultiplier: 1.0,\n    preserveDrawingBuffer: true,\n}\n\n\n\n/**\n * @class\n * @typicalname noa.rendering\n * @classdesc Manages all rendering, and the BABYLON scene, materials, etc.\n */\n\nfunction Rendering(noa, opts, canvas) {\n    this.noa = noa\n\n    /**\n     * `noa.rendering` uses the following options (from the root `noa(opts)` options):\n     * ```js\n     * {\n     *   showFPS: false,\n     *   antiAlias: true,\n     *   clearColor: [0.8, 0.9, 1],\n     *   ambientColor: [1, 1, 1],\n     *   lightDiffuse: [1, 1, 1],\n     *   lightSpecular: [1, 1, 1],\n     *   groundLightColor: [0.5, 0.5, 0.5],\n     *   useAO: true,\n     *   AOmultipliers: [0.93, 0.8, 0.5],\n     *   reverseAOmultiplier: 1.0,\n     *   preserveDrawingBuffer: true,\n     * }\n     * ```\n     */\n    opts = Object.assign({}, defaults, opts)\n\n    // internals\n    this.useAO = !!opts.useAO\n    this.aoVals = opts.AOmultipliers\n    this.revAoVal = opts.reverseAOmultiplier\n    this.meshingCutoffTime = 6 // ms\n    this._resizeDebounce = 250 // ms\n\n    // set up babylon scene\n    initScene(this, canvas, opts)\n\n    // for debugging\n    if (opts.showFPS) setUpFPS()\n}\n\n\n// Constructor helper - set up the Babylon.js scene and basic components\nfunction initScene(self, canvas, opts) {\n\n    // init internal properties\n    self._engine = new Engine(canvas, opts.antiAlias, {\n        preserveDrawingBuffer: opts.preserveDrawingBuffer,\n    })\n    self._scene = new Scene(self._engine)\n    var scene = self._scene\n    // remove built-in listeners\n    scene.detachControl()\n\n    // octree setup\n    scene._addComponent(new OctreeSceneComponent(scene))\n    self._octree = new Octree($ => { })\n    self._octree.blocks = []\n    scene._selectionOctree = self._octree\n\n    // camera, and empty mesh to hold it, and one to accumulate rotations\n    self._cameraHolder = new Mesh('camHolder', scene)\n    self._camera = new FreeCamera('camera', new Vector3(0, 0, 0), scene)\n    self._camera.parent = self._cameraHolder\n    self._camera.minZ = .01\n    self._cameraHolder.visibility = false\n\n    // plane obscuring the camera - for overlaying an effect on the whole view\n    self._camScreen = Mesh.CreatePlane('camScreen', 10, scene)\n    self.addMeshToScene(self._camScreen)\n    self._camScreen.position.z = .1\n    self._camScreen.parent = self._camera\n    self._camScreenMat = self.makeStandardMaterial('camscreenmat')\n    self._camScreen.material = self._camScreenMat\n    self._camScreen.setEnabled(false)\n    self._camLocBlock = 0\n\n    // apply some defaults\n    var lightVec = new Vector3(0.1, 1, 0.3)\n    self._light = new HemisphericLight('light', lightVec, scene)\n\n    function arrToColor(a) { return new Color3(a[0], a[1], a[2]) }\n    scene.clearColor = arrToColor(opts.clearColor)\n    scene.ambientColor = arrToColor(opts.ambientColor)\n    self._light.diffuse = arrToColor(opts.lightDiffuse)\n    self._light.specular = arrToColor(opts.lightSpecular)\n    self._light.groundColor = arrToColor(opts.groundLightColor)\n\n    // make a default flat material (used or clone by terrain, etc)\n    self.flatMaterial = self.makeStandardMaterial('flatmat')\n\n}\n\n\n\n/*\n *   PUBLIC API \n */\n\n\n/**\n * The Babylon `scene` object representing the game world.\n * @member\n */\nRendering.prototype.getScene = function () {\n    return this._scene\n}\n\n// per-tick listener for rendering-related stuff\nRendering.prototype.tick = function (dt) {\n    // nothing here at the moment\n}\n\n\n\n\n\nRendering.prototype.render = function (dt) {\n    profile_hook('start')\n    updateCameraForRender(this)\n    profile_hook('updateCamera')\n    this._engine.beginFrame()\n    profile_hook('beginFrame')\n    this._scene.render()\n    profile_hook('render')\n    fps_hook()\n    this._engine.endFrame()\n    profile_hook('endFrame')\n    profile_hook('end')\n}\n\n\n\nRendering.prototype.resize = function (e) {\n    if (!pendingResize) {\n        pendingResize = true\n        setTimeout(() => {\n            this._engine.resize()\n            pendingResize = false\n        }, this._resizeDebounce)\n    }\n}\nvar pendingResize = false\n\n\n\nRendering.prototype.highlightBlockFace = function (show, posArr, normArr) {\n    var m = getHighlightMesh(this)\n    if (show) {\n        // floored local coords for highlight mesh\n        this.noa.globalToLocal(posArr, null, hlpos)\n        // offset to avoid z-fighting, bigger when camera is far away\n        var dist = glvec3.dist(this.noa.camera._localGetPosition(), hlpos)\n        var slop = 0.001 + 0.001 * dist\n        for (var i = 0; i < 3; i++) {\n            if (normArr[i] === 0) {\n                hlpos[i] += 0.5\n            } else {\n                hlpos[i] += (normArr[i] > 0) ? 1 + slop : -slop\n            }\n        }\n        m.position.copyFromFloats(hlpos[0], hlpos[1], hlpos[2])\n        m.rotation.x = (normArr[1]) ? Math.PI / 2 : 0\n        m.rotation.y = (normArr[0]) ? Math.PI / 2 : 0\n    }\n    m.setEnabled(show)\n}\nvar hlpos = []\n\n\n\n\n/**\n * Add a mesh to the scene's octree setup so that it renders. \n * \n * @param mesh: the mesh to add to the scene\n * @param isStatic: pass in true if mesh never moves (i.e. change octree blocks)\n * @param position: (optional) global position where the mesh should be\n * @param chunk: (optional) chunk to which the mesh is statically bound\n * @method\n */\nRendering.prototype.addMeshToScene = function (mesh, isStatic, pos, _containingChunk) {\n    // exit silently if mesh has already been added and not removed\n    if (mesh._noaContainingChunk) return\n    if (this._octree.dynamicContent.includes(mesh)) return\n\n    // find local position for mesh and move it there (unless it's parented)\n    if (!mesh.parent) {\n        if (!pos) pos = [mesh.position.x, mesh.position.y, mesh.position.z]\n        var lpos = []\n        this.noa.globalToLocal(pos, null, lpos)\n        mesh.position.copyFromFloats(lpos[0], lpos[1], lpos[2])\n    }\n\n    // statically tie to a chunk's octree, or treat as dynamic?\n    var addToOctree = false\n    if (isStatic) {\n        var chunk = _containingChunk ||\n            this.noa.world._getChunkByCoords(pos[0], pos[1], pos[2])\n        addToOctree = !!(chunk && chunk.octreeBlock)\n    }\n\n    if (addToOctree) {\n        chunk.octreeBlock.entries.push(mesh)\n        mesh._noaContainingChunk = chunk\n    } else {\n        this._octree.dynamicContent.push(mesh)\n    }\n\n    if (isStatic) {\n        mesh.freezeWorldMatrix()\n        mesh.freezeNormals()\n    }\n\n    // add dispose event to undo everything done here\n    var remover = this.removeMeshFromScene.bind(this, mesh)\n    mesh.onDisposeObservable.add(remover)\n}\n\n\n\n/**  Undoes everything `addMeshToScene` does\n * @method\n */\nRendering.prototype.removeMeshFromScene = function (mesh) {\n    if (mesh._noaContainingChunk && mesh._noaContainingChunk.octreeBlock) {\n        removeUnorderedListItem(mesh._noaContainingChunk.octreeBlock.entries, mesh)\n    }\n    mesh._noaContainingChunk = null\n    removeUnorderedListItem(this._octree.dynamicContent, mesh)\n}\n\n\n\n\n\n\n\n\n\n// Create a default standardMaterial:\n//      flat, nonspecular, fully reflects diffuse and ambient light\nRendering.prototype.makeStandardMaterial = function (name) {\n    var mat = new StandardMaterial(name, this._scene)\n    mat.specularColor.copyFromFloats(0, 0, 0)\n    mat.ambientColor.copyFromFloats(1, 1, 1)\n    mat.diffuseColor.copyFromFloats(1, 1, 1)\n    return mat\n}\n\n\n\n\n\n\n\n/*\n *\n * \n *   ACCESSORS FOR CHUNK ADD/REMOVAL/MESHING\n *\n * \n */\n\nRendering.prototype.prepareChunkForRendering = function (chunk) {\n    var cs = chunk.size\n    var loc = []\n    this.noa.globalToLocal([chunk.x, chunk.y, chunk.z], null, loc)\n    var min = new Vector3(loc[0], loc[1], loc[2])\n    var max = new Vector3(loc[0] + cs, loc[1] + cs, loc[2] + cs)\n    chunk.octreeBlock = new OctreeBlock(min, max, undefined, undefined, undefined, $ => { })\n    this._octree.blocks.push(chunk.octreeBlock)\n}\n\nRendering.prototype.disposeChunkForRendering = function (chunk) {\n    if (!chunk.octreeBlock) return\n    removeUnorderedListItem(this._octree.blocks, chunk.octreeBlock)\n    chunk.octreeBlock.entries.length = 0\n    chunk.octreeBlock = null\n}\n\n\n\n\n\n\n\n\n\n/*\n *\n *   INTERNALS\n *\n */\n\n\n\n// change world origin offset, and rebase everything with a position\n\nRendering.prototype._rebaseOrigin = function (delta) {\n    var dvec = new Vector3(delta[0], delta[1], delta[2])\n\n    this._scene.meshes.forEach(mesh => {\n        // parented meshes don't live in the world coord system\n        if (mesh.parent) return\n\n        // move each mesh by delta (even though most are managed by components)\n        mesh.position.subtractInPlace(dvec)\n\n        if (mesh._isWorldMatrixFrozen) mesh.markAsDirty()\n    })\n\n    // update octree block extents\n    this._octree.blocks.forEach(octreeBlock => {\n        octreeBlock.minPoint.subtractInPlace(dvec)\n        octreeBlock.maxPoint.subtractInPlace(dvec)\n        octreeBlock._boundingVectors.forEach(v => {\n            v.subtractInPlace(dvec)\n        })\n    })\n}\n\n\n\n\n\n// updates camera position/rotation to match settings from noa.camera\n\nfunction updateCameraForRender(self) {\n    var cam = self.noa.camera\n    var tgtLoc = cam._localGetTargetPosition()\n    self._cameraHolder.position.copyFromFloats(tgtLoc[0], tgtLoc[1], tgtLoc[2])\n    self._cameraHolder.rotation.x = cam.pitch\n    self._cameraHolder.rotation.y = cam.heading\n    self._camera.position.z = -cam.currentZoom\n\n    // applies screen effect when camera is inside a transparent voxel\n    var cloc = cam._localGetPosition()\n    var off = self.noa.worldOriginOffset\n    var cx = Math.floor(cloc[0] + off[0])\n    var cy = Math.floor(cloc[1] + off[1])\n    var cz = Math.floor(cloc[2] + off[2])\n    var id = self.noa.getBlock(cx, cy, cz)\n    checkCameraEffect(self, id)\n}\n\n\n\n//  If camera's current location block id has alpha color (e.g. water), apply/remove an effect\n\nfunction checkCameraEffect(self, id) {\n    if (id === self._camLocBlock) return\n    if (id === 0) {\n        self._camScreen.setEnabled(false)\n    } else {\n        var matId = self.noa.registry.getBlockFaceMaterial(id, 0)\n        if (matId) {\n            var matData = self.noa.registry.getMaterialData(matId)\n            var col = matData.color\n            var alpha = matData.alpha\n            if (col && alpha && alpha < 1) {\n                self._camScreenMat.diffuseColor.set(0, 0, 0)\n                self._camScreenMat.ambientColor.set(col[0], col[1], col[2])\n                self._camScreenMat.alpha = alpha\n                self._camScreen.setEnabled(true)\n            }\n        }\n    }\n    self._camLocBlock = id\n}\n\n\n\n\n\n\n// make or get a mesh for highlighting active voxel\nfunction getHighlightMesh(rendering) {\n    var mesh = rendering._highlightMesh\n    if (!mesh) {\n        mesh = Mesh.CreatePlane(\"highlight\", 1.0, rendering._scene)\n        var hlm = rendering.makeStandardMaterial('highlightMat')\n        hlm.backFaceCulling = false\n        hlm.emissiveColor = new Color3(1, 1, 1)\n        hlm.alpha = 0.2\n        mesh.material = hlm\n\n        // outline\n        var s = 0.5\n        var lines = Mesh.CreateLines(\"hightlightLines\", [\n            new Vector3(s, s, 0),\n            new Vector3(s, -s, 0),\n            new Vector3(-s, -s, 0),\n            new Vector3(-s, s, 0),\n            new Vector3(s, s, 0)\n        ], rendering._scene)\n        lines.color = new Color3(1, 1, 1)\n        lines.parent = mesh\n\n        rendering.addMeshToScene(mesh)\n        rendering.addMeshToScene(lines)\n        rendering._highlightMesh = mesh\n    }\n    return mesh\n}\n\n\n\n\n\n\n\n\n\n/*\n * \n *      sanity checks:\n * \n */\n\nRendering.prototype.debug_SceneCheck = function () {\n    var meshes = this._scene.meshes\n    var dyns = this._octree.dynamicContent\n    var octs = []\n    var numOcts = 0\n    var numSubs = 0\n    var mats = this._scene.materials\n    var allmats = []\n    mats.forEach(mat => {\n        if (mat.subMaterials) mat.subMaterials.forEach(mat => allmats.push(mat))\n        else allmats.push(mat)\n    })\n    this._octree.blocks.forEach(function (block) {\n        numOcts++\n        block.entries.forEach(m => octs.push(m))\n    })\n    meshes.forEach(function (m) {\n        if (m._isDisposed) warn(m, 'disposed mesh in scene')\n        if (empty(m)) return\n        if (missing(m, dyns, octs)) warn(m, 'non-empty mesh missing from octree')\n        if (!m.material) { warn(m, 'non-empty scene mesh with no material'); return }\n        numSubs += (m.subMeshes) ? m.subMeshes.length : 1\n        var mats = m.material.subMaterials || [m.material]\n        mats.forEach(function (mat) {\n            if (missing(mat, mats)) warn(mat, 'mesh material not in scene')\n        })\n    })\n    var unusedMats = []\n    allmats.forEach(mat => {\n        var used = false\n        meshes.forEach(mesh => {\n            if (mesh.material === mat) used = true\n            if (!mesh.material || !mesh.material.subMaterials) return\n            if (mesh.material.subMaterials.includes(mat)) used = true\n        })\n        if (!used) unusedMats.push(mat.name)\n    })\n    if (unusedMats.length) {\n        console.warn('Materials unused by any mesh: ', unusedMats.join(', '))\n    }\n    dyns.forEach(function (m) {\n        if (missing(m, meshes)) warn(m, 'octree/dynamic mesh not in scene')\n    })\n    octs.forEach(function (m) {\n        if (missing(m, meshes)) warn(m, 'octree block mesh not in scene')\n    })\n    var avgPerOct = Math.round(10 * octs.length / numOcts) / 10\n    console.log('meshes - octree:', octs.length, '  dynamic:', dyns.length,\n        '   subMeshes:', numSubs,\n        '   avg meshes/octreeBlock:', avgPerOct)\n\n    function warn(obj, msg) { console.warn(obj.name + ' --- ' + msg) }\n\n    function empty(mesh) { return (mesh.getIndices().length === 0) }\n\n    function missing(obj, list1, list2) {\n        if (!obj) return false\n        if (list1.includes(obj)) return false\n        if (list2 && list2.includes(obj)) return false\n        return true\n    }\n    return 'done.'\n}\n\nRendering.prototype.debug_MeshCount = function () {\n    var ct = {}\n    this._scene.meshes.forEach(m => {\n        var n = m.name || ''\n        n = n.replace(/-\\d+.*/, '#')\n        n = n.replace(/\\d+.*/, '#')\n        n = n.replace(/(rotHolder|camHolder|camScreen)/, 'rendering use')\n        n = n.replace(/atlas sprite .*/, 'atlas sprites')\n        ct[n] = ct[n] || 0\n        ct[n]++\n    })\n    for (var s in ct) console.log('   ' + (ct[s] + '       ').substr(0, 7) + s)\n}\n\n\n\n\n\n\n\nimport { makeProfileHook } from './util'\nvar profile_hook = (PROFILE) ?\n    makeProfileHook(200, 'render internals') : () => { }\n\n\n\nvar fps_hook = function () { }\n\nfunction setUpFPS() {\n    var div = document.createElement('div')\n    div.id = 'noa_fps'\n    var style = 'position:absolute; top:0; right:0; z-index:0;'\n    style += 'color:white; background-color:rgba(0,0,0,0.5);'\n    style += 'font:14px monospace; text-align:center;'\n    style += 'min-width:2em; margin:4px;'\n    div.style = style\n    document.body.appendChild(div)\n    var every = 1000\n    var ct = 0\n    var longest = 0\n    var start = performance.now()\n    var last = start\n    fps_hook = function () {\n        ct++\n        var nt = performance.now()\n        if (nt - last > longest) longest = nt - last\n        last = nt\n        if (nt - start < every) return\n        var fps = Math.round(ct / (nt - start) * 1000)\n        var min = Math.round(1 / longest * 1000)\n        div.innerHTML = fps + '<br>' + min\n        ct = 0\n        longest = 0\n        start = nt\n    }\n}\n","\nimport ndarray from 'ndarray'\nimport { Mesh } from '@babylonjs/core/Meshes/mesh'\nimport { SubMesh } from '@babylonjs/core/Meshes/subMesh'\nimport { VertexData } from '@babylonjs/core/Meshes/mesh.vertexData'\nimport { MultiMaterial } from '@babylonjs/core/Materials/multiMaterial'\nimport { Texture } from '@babylonjs/core/Materials/Textures/texture'\nimport '@babylonjs/core/Meshes/meshBuilder'\n\nimport { copyNdarrayContents } from './util'\n\nexport default TerrainMesher\n\n\n\n\n// enable for profiling..\nvar PROFILE_EVERY = 0 // 100\n\n\n\n\n/*\n * \n *          TERRAIN MESHER!!\n * \n */\n\n\nfunction TerrainMesher(noa) {\n\n    var greedyMesher = new GreedyMesher(noa)\n    var meshBuilder = new MeshBuilder(noa)\n\n\n    /*\n     * \n     *      Entry point and high-level flow\n     * \n    */\n\n    this.meshChunk = function (chunk, matGetter, colGetter, ignoreMaterials, useAO, aoVals, revAoVal) {\n        profile_hook('start')\n\n        // args\n        var mats = matGetter || noa.registry.getBlockFaceMaterial\n        var cols = colGetter || noa.registry._getMaterialVertexColor\n        var ao = (useAO === undefined) ? noa.rendering.useAO : useAO\n        var vals = aoVals || noa.rendering.aoVals\n        var rev = isNaN(revAoVal) ? noa.rendering.revAoVal : revAoVal\n\n        // copy voxel data into array padded with neighbor values\n        var voxels = buildPaddedVoxelArray(chunk)\n        profile_hook('copy')\n\n        // greedy mesher creates an array of Submesh structs\n        var edgesOnly = chunk.isFull || chunk.isEmpty\n        var subMeshes = greedyMesher.mesh(voxels, mats, cols, ao, vals, rev, edgesOnly)\n\n        // builds the babylon mesh that will be added to the scene\n        var mesh\n        if (subMeshes.length) {\n            mesh = meshBuilder.build(chunk, subMeshes, ignoreMaterials)\n            profile_hook('terrain')\n        }\n\n        profile_hook('end')\n        return mesh || null\n    }\n}\n\n\n\n\n\n\n\n\n\n/*\n * \n *      Padded voxel data assembler\n * \n * Takes the chunk of size n, and copies its data into center of an (n+2) ndarray\n * Then copies in edge data from neighbors, or if not available zeroes it out\n * Actual mesher will then run on the padded ndarray\n * \n*/\n\nfunction buildPaddedVoxelArray(chunk) {\n    var src = chunk.voxels\n    var cs = src.shape[0]\n    var tgt = cachedPadded\n\n    // embiggen cached target array\n    if (cs + 2 !== tgt.shape[0]) {\n        var s2 = cs + 2\n        tgt = new ndarray(new Uint16Array(s2 * s2 * s2), [s2, s2, s2])\n        cachedPadded = tgt\n    }\n\n    // loop through neighbors (neighbor(0,0,0) is the chunk itself)\n    // copying or zeroing voxel body/edge data into padded target array\n    var loc = _vecs[0]\n    var pos = _vecs[1]\n    var size = _vecs[2]\n    var tgtPos = _vecs[3]\n    var posValues = _vecs[4]\n    var sizeValues = _vecs[5]\n    var tgtPosValues = _vecs[6]\n    if (cs !== _cachedVecSize) {\n        _cachedVecSize = cs\n        allocateVectors(cs, posValues, sizeValues, tgtPosValues)\n    }\n\n    for (var i = 0; i < 3; i++) {\n        loc[0] = i\n        for (var j = 0; j < 3; j++) {\n            loc[1] = j\n            for (var k = 0; k < 3; k++) {\n                loc[2] = k\n                for (var n = 0; n < 3; n++) {\n                    var coord = loc[n]\n                    pos[n] = posValues[coord]\n                    size[n] = sizeValues[coord]\n                    tgtPos[n] = tgtPosValues[coord]\n                }\n                var nab = chunk._neighbors.get(i - 1, j - 1, k - 1)\n                var nsrc = (nab) ? nab.voxels : null\n                copyNdarrayContents(nsrc, tgt, pos, size, tgtPos)\n            }\n        }\n    }\n    return tgt\n}\nvar cachedPadded = new ndarray(new Uint16Array(27), [3, 3, 3])\nvar _vecs = Array.from(Array(10)).map(n => [0, 0, 0])\nvar _cachedVecSize\nfunction allocateVectors(size, posValues, sizeValues, tgtPosValues) {\n    for (var i = 0; i < 3; i++) {\n        posValues[i] = [size - 1, 0, 0][i]\n        sizeValues[i] = [1, size, 1][i]\n        tgtPosValues[i] = [0, 1, size + 1][i]\n    }\n}\n\n\n\n\n\n\n\n\n/*\n * \n *  Submesh - holds one submesh worth of greedy-meshed data\n * \n *  Basically, the greedy mesher builds these and the mesh builder consumes them\n * \n */\n\nfunction Submesh(id) {\n    this.id = id | 0\n    this.positions = []\n    this.indices = []\n    this.normals = []\n    this.colors = []\n    this.uvs = []\n    this.mergeable = false      // flag used during terrain meshing\n}\n\nSubmesh.prototype.dispose = function () {\n    this.positions = null\n    this.indices = null\n    this.normals = null\n    this.colors = null\n    this.uvs = null\n}\n\n\n\n\n\n\n\n\n/*\n * \n *  Mesh Builder - turns an array of Submesh data into a \n *  Babylon.js mesh/submeshes, ready to be added to the scene\n * \n */\n\nfunction MeshBuilder(noa) {\n\n\n    // core\n    this.build = function (chunk, meshDataList, ignoreMaterials) {\n\n        // flag and merge submesh data that can share the default terrain material\n        var numMergeable = 0\n        for (var i = 0; i < meshDataList.length; i++) {\n            var mdat = meshDataList[i]\n            if (ignoreMaterials) {\n                mdat.mergeable = true\n            } else {\n                var url = noa.registry.getMaterialTexture(mdat.id)\n                var matData = noa.registry.getMaterialData(mdat.id)\n                mdat.mergeable = (!url)\n                    && (matData.alpha === 1)\n                    && (!matData.renderMat)\n            }\n            if (mdat.mergeable) numMergeable++\n        }\n        if (numMergeable > 1) mergeSubmeshes(meshDataList, false)\n\n        // now merge everything, keeping track of vertices/indices/materials\n        var results = mergeSubmeshes(meshDataList, true)\n\n        // merge sole remaining submesh instance into a babylon mesh\n        var merged = meshDataList[0]\n        var name = 'chunk_' + chunk.id\n        var mats = results.matIDs.map(id => getTerrainMaterial(id, ignoreMaterials))\n        var mesh = buildMeshFromSubmesh(merged, name, mats, results.vertices, results.indices)\n\n        // done, mesh will be positioned later when added to the scene\n        return mesh\n    }\n\n\n\n    // given a set of submesh objects, merge some or all of them\n    //      while tracking vertex/index offsets for each material ID\n    // Note: modifies meshDataList in place!\n    function mergeSubmeshes(meshDataList, mergeAll) {\n        var vertices = []\n        var indices = []\n        var matIDs = []\n\n        var target = null\n        for (var i = 0; i < meshDataList.length; ++i) {\n            var mdat = meshDataList[i]\n            if (!(mergeAll || mdat.mergeable)) continue\n\n            vertices.push(mdat.positions.length)\n            indices.push(mdat.indices.length)\n            matIDs.push(mdat.id)\n\n            if (!target) {\n                target = mdat\n\n            } else {\n                var indexOffset = target.positions.length / 3\n                // merge data in \"mdat\" onto \"target\"\n                mergeArrays(target.positions, mdat.positions)\n                mergeArrays(target.normals, mdat.normals)\n                mergeArrays(target.colors, mdat.colors)\n                mergeArrays(target.uvs, mdat.uvs)\n                // indices must be offset relative to data being merged onto\n                for (var j = 0, len = mdat.indices.length; j < len; ++j) {\n                    target.indices.push(mdat.indices[j] + indexOffset)\n                }\n                // get rid of entry that's been merged\n                meshDataList.splice(i, 1)\n                mdat.dispose()\n                i--\n            }\n        }\n\n        return {\n            vertices: vertices,\n            indices: indices,\n            matIDs: matIDs,\n        }\n    }\n\n    function mergeArrays(tgt, src) {\n        for (var i = 0; i < src.length; i++) tgt.push(src[i])\n    }\n\n\n    function buildMeshFromSubmesh(submesh, name, mats, verts, inds) {\n\n        // base mesh and vertexData object\n        var scene = noa.rendering.getScene()\n        var mesh = new Mesh(name, scene)\n        var vdat = new VertexData()\n        vdat.positions = submesh.positions\n        vdat.indices = submesh.indices\n        vdat.normals = submesh.normals\n        vdat.colors = submesh.colors\n        vdat.uvs = submesh.uvs\n        vdat.applyToMesh(mesh)\n        submesh.dispose()\n\n        if (mats.length === 1) {\n            // if only one material ID, assign as a regular mesh and return\n            mesh.material = mats[0]\n\n        } else {\n            // else we need to make a multimaterial and define (babylon) submeshes\n            var multiMat = new MultiMaterial('multimat ' + name, scene)\n            mesh.subMeshes = []\n            // var totalVerts = vdat.positions.length\n            // var totalInds = vdat.indices.length\n            var vertStart = 0\n            var indStart = 0\n            for (var i = 0; i < mats.length; i++) {\n                multiMat.subMaterials[i] = mats[i]\n                var sub = new SubMesh(i, vertStart, verts[i], indStart, inds[i], mesh)\n                mesh.subMeshes[i] = sub\n                vertStart += verts[i]\n                indStart += inds[i]\n            }\n            mesh.material = multiMat\n        }\n\n        return mesh\n    }\n\n\n\n\n    //                         Material wrangling\n\n\n    var materialCache = {}\n\n    // manage materials/textures to avoid duplicating them\n    function getTerrainMaterial(matID, ignore) {\n        if (ignore) return noa.rendering.flatMaterial\n        var name = 'terrain mat ' + matID\n        if (!materialCache[name]) materialCache[name] = makeTerrainMaterial(matID)\n        return materialCache[name]\n    }\n\n\n    // canonical function to make a terrain material\n    function makeTerrainMaterial(id) {\n        // if user-specified render material is defined, use it\n        var matData = noa.registry.getMaterialData(id)\n        if (matData.renderMat) return matData.renderMat\n        // otherwise determine which built-in material to use\n        var url = noa.registry.getMaterialTexture(id)\n        var alpha = matData.alpha\n        if (!url && alpha === 1) {\n            // base material is fine for non-textured case, if no alpha\n            return noa.rendering.flatMaterial\n        }\n        var mat = noa.rendering.flatMaterial.clone('terrain' + id)\n        if (url) {\n            var scene = noa.rendering.getScene()\n            var tex = new Texture(url, scene, true, false, Texture.NEAREST_SAMPLINGMODE)\n            if (matData.textureAlpha) tex.hasAlpha = true\n            mat.diffuseTexture = tex\n        }\n        if (matData.alpha < 1) {\n            mat.alpha = matData.alpha\n        }\n        return mat\n    }\n}\n\n\n\n\n\n\n\n\n/*\n *    Greedy voxel meshing algorithm\n *        based initially on algo by Mikola Lysenko:\n *          http://0fps.net/2012/07/07/meshing-minecraft-part-2/\n *          but evolved quite a bit since then\n *        AO handling by me, stitched together out of cobwebs and dreams\n *    \n *    Arguments:\n *        arr: 3D ndarray of dimensions X,Y,Z\n *             packed with solidity/opacity booleans in higher bits\n *        getMaterial: function( blockID, dir )\n *             returns a material ID based on block id and which cube face it is\n *             (assume for now that each mat ID should get its own mesh)\n *        getColor: function( materialID )\n *             looks up a color (3-array) by material ID\n *             TODO: replace this with a lookup array?\n *        doAO: whether or not to bake ambient occlusion into vertex colors\n *        aoValues: array[3] of color multipliers for AO (least to most occluded)\n *        revAoVal: \"reverse ao\" - color multiplier for unoccluded exposed edges\n *\n *    Return object: array of mesh objects keyed by material ID\n *        arr[id] = {\n *          id:       material id for mesh\n *          vertices: ints, range 0 .. X/Y/Z\n *          indices:  ints\n *          normals:  ints,   -1 .. 1\n *          colors:   floats,  0 .. 1\n *          uvs:      floats,  0 .. X/Y/Z\n *        }\n */\n\nfunction GreedyMesher(noa) {\n\n    var maskCache = new Int16Array(16)\n    var aomaskCache = new Uint16Array(16)\n\n    var aoPackFunction = null\n\n    var solidLookup = noa.registry._solidityLookup\n    var opacityLookup = noa.registry._opacityLookup\n\n\n    this.mesh = function (voxels, getMaterial, getColor, doAO, aoValues, revAoVal, edgesOnly) {\n        solidLookup = noa.registry._solidityLookup\n        opacityLookup = noa.registry._opacityLookup\n\n        // hash of Submeshes, keyed by material ID\n        var subMeshes = {}\n\n        // precalc how to apply AO packing in first masking function\n        var skipReverseAO = (revAoVal === aoValues[0])\n        aoPackFunction = (!doAO) ? null :\n            (skipReverseAO) ? packAOMaskNoReverse : packAOMask\n\n        //Sweep over each axis, mapping axes to [d,u,v]\n        for (var d = 0; d < 3; ++d) {\n            var u = (d + 1) % 3\n            var v = (d + 2) % 3\n\n            // make transposed ndarray so index i is the axis we're sweeping\n            var shape = voxels.shape\n            var arrT = voxels.transpose(d, u, v).lo(1, 1, 1).hi(shape[d] - 2, shape[u] - 2, shape[v] - 2)\n\n            // shorten len0 by 1 so faces at edges don't get drawn in both chunks\n            var len0 = arrT.shape[0] - 1\n            var len1 = arrT.shape[1]\n            var len2 = arrT.shape[2]\n\n            // embiggen mask arrays as needed\n            if (maskCache.length < len1 * len2) {\n                maskCache = new Int16Array(len1 * len2)\n                aomaskCache = new Uint16Array(len1 * len2)\n            }\n\n            // iterate along current major axis..\n            for (var i = 0; i <= len0; ++i) {\n\n                // fills mask and aomask arrays with values\n                constructMeshMasks(i, d, arrT, getMaterial)\n                profile_hook('masks')\n\n                // parses the masks to do greedy meshing\n                constructMeshDataFromMasks(i, d, u, v, len1, len2,\n                    doAO, subMeshes, getColor, aoValues, revAoVal)\n\n                // process edges only by jumping to other edge\n                if (edgesOnly) i += (len0 - 1)\n\n                profile_hook('submeshes')\n            }\n        }\n\n        // done, return hash of subMeshes as an array\n        return Object.keys(subMeshes).map(k => subMeshes[k])\n    }\n\n\n\n\n\n\n\n    //      Greedy meshing inner loop one\n    //\n    // iterating across ith 2d plane, with n being index into masks\n\n    function constructMeshMasks(i, d, arrT, getMaterial) {\n        var len = arrT.shape[1]\n        var mask = maskCache\n        var aomask = aomaskCache\n        // set up for quick array traversals\n        var n = 0\n        var materialDir = d * 2\n        var data = arrT.data\n        var dbase = arrT.index(i - 1, 0, 0)\n        var istride = arrT.stride[0]\n        var jstride = arrT.stride[1]\n        var kstride = arrT.stride[2]\n\n        for (var k = 0; k < len; ++k) {\n            var d0 = dbase\n            dbase += kstride\n            for (var j = 0; j < len; j++, n++, d0 += jstride) {\n\n                // mask[n] will represent the face needed between i-1,j,k and i,j,k\n                // for now, assume we never have two faces in both directions\n\n                // note that mesher zeroes out the mask as it goes, so there's \n                // no need to zero it here when no face is needed\n\n                // IDs at i-1,j,k  and  i,j,k\n                var id0 = data[d0]\n                var id1 = data[d0 + istride]\n\n                // most common case: never a face between same voxel IDs, \n                // so skip out early\n                if (id0 === id1) continue\n\n                var faceDir = getFaceDir(id0, id1, getMaterial, materialDir)\n                if (faceDir) {\n                    // set regular mask value to material ID, sign indicating direction\n                    mask[n] = (faceDir > 0) ?\n                        getMaterial(id0, materialDir) :\n                        -getMaterial(id1, materialDir + 1)\n\n                    // if doing AO, precalculate AO level for each face into second mask\n                    if (aoPackFunction) {\n                        // i values in direction face is/isn't pointing{\n                        aomask[n] = (faceDir > 0) ?\n                            aoPackFunction(arrT, i, i - 1, j, k) :\n                            aoPackFunction(arrT, i - 1, i, j, k)\n                    }\n                }\n            }\n        }\n    }\n\n\n\n    function getFaceDir(id0, id1, getMaterial, materialDir) {\n        // no face if both blocks are opaque\n        var op0 = opacityLookup[id0]\n        var op1 = opacityLookup[id1]\n        if (op0 && op1) return 0\n        // if either block is opaque draw a face for it\n        if (op0) return 1\n        if (op1) return -1\n        // can't tell from block IDs, so compare block materials of each face\n        var m0 = getMaterial(id0, materialDir)\n        var m1 = getMaterial(id1, materialDir + 1)\n        // if same material, draw no face. If one is missing, draw the other\n        if (m0 === m1) { return 0 }\n        else if (m0 === 0) { return -1 }\n        else if (m1 === 0) { return 1 }\n        // remaining case is two different non-opaque block materials\n        // facing each other. for now, draw neither..\n        return 0\n    }\n\n\n\n\n\n\n\n    //      Greedy meshing inner loop two\n    //\n    // construct data for mesh using the masks\n\n    function constructMeshDataFromMasks(i, d, u, v, len1, len2,\n        doAO, submeshes, getColor, aoValues, revAoVal) {\n        var n = 0\n        var mask = maskCache\n        var aomask = aomaskCache\n\n        var x = [0, 0, 0]\n        var du = [0, 0, 0]\n        var dv = [0, 0, 0]\n        x[d] = i\n        var norms = [0, 0, 0]\n\n        // some logic is broken into helper functions for AO and non-AO\n        // this fixes deopts in Chrome (for reasons unknown)\n        var maskCompareFcn = (doAO) ? maskCompare : maskCompare_noAO\n        var meshColorFcn = (doAO) ? pushMeshColors : pushMeshColors_noAO\n\n        for (var k = 0; k < len2; ++k) {\n            var w = 1\n            var h = 1\n            for (var j = 0; j < len1; j += w, n += w) {\n\n                var maskVal = mask[n] | 0\n                if (!maskVal) {\n                    w = 1\n                    continue\n                }\n                var ao = aomask[n] | 0\n\n                // Compute width and height of area with same mask/aomask values\n                for (w = 1; w < len1 - j; ++w) {\n                    if (!maskCompareFcn(n + w, mask, maskVal, aomask, ao)) break\n                }\n\n                OUTER:\n                for (h = 1; h < len2 - k; ++h) {\n                    for (var m = 0; m < w; ++m) {\n                        var ix = n + m + h * len1\n                        if (!maskCompareFcn(ix, mask, maskVal, aomask, ao)) break OUTER\n                    }\n                }\n\n                // for testing: doing the following will disable greediness\n                //w=h=1\n\n                // material and mesh for this face\n                var matID = Math.abs(maskVal)\n                if (!submeshes[matID]) submeshes[matID] = new Submesh(matID)\n                var mesh = submeshes[matID]\n                var colors = mesh.colors\n                var c = getColor(matID)\n\n                // colors are pushed in helper function - avoids deopts\n                // tridir is boolean for which way to split the quad into triangles\n\n                var triDir = meshColorFcn(colors, c, ao, aoValues, revAoVal)\n\n\n                //Add quad, vertices = x -> x+du -> x+du+dv -> x+dv\n                x[u] = j\n                x[v] = k\n                du[u] = w\n                dv[v] = h\n\n                var pos = mesh.positions\n                pos.push(\n                    x[0], x[1], x[2],\n                    x[0] + du[0], x[1] + du[1], x[2] + du[2],\n                    x[0] + du[0] + dv[0], x[1] + du[1] + dv[1], x[2] + du[2] + dv[2],\n                    x[0] + dv[0], x[1] + dv[1], x[2] + dv[2])\n\n\n                // add uv values, with the order and sign depending on \n                // axis and direction so as to avoid mirror-image textures\n                var dir = sign(maskVal)\n\n                if (d === 2) {\n                    mesh.uvs.push(\n                        0, h,\n                        -dir * w, h,\n                        -dir * w, 0,\n                        0, 0)\n                } else {\n                    mesh.uvs.push(\n                        0, w,\n                        0, 0,\n                        dir * h, 0,\n                        dir * h, w)\n                }\n\n\n                // Add indexes, ordered clockwise for the facing direction;\n\n                var vs = pos.length / 3 - 4\n\n                if (maskVal < 0) {\n                    if (triDir) {\n                        mesh.indices.push(vs, vs + 1, vs + 2, vs, vs + 2, vs + 3)\n                    } else {\n                        mesh.indices.push(vs + 1, vs + 2, vs + 3, vs, vs + 1, vs + 3)\n                    }\n                } else {\n                    if (triDir) {\n                        mesh.indices.push(vs, vs + 2, vs + 1, vs, vs + 3, vs + 2)\n                    } else {\n                        mesh.indices.push(vs + 3, vs + 1, vs, vs + 3, vs + 2, vs + 1)\n                    }\n                }\n\n\n                // norms depend on which direction the mask was solid in..\n                norms[d] = dir\n                // same norm for all vertices\n                mesh.normals.push(\n                    norms[0], norms[1], norms[2],\n                    norms[0], norms[1], norms[2],\n                    norms[0], norms[1], norms[2],\n                    norms[0], norms[1], norms[2])\n\n\n                //Zero-out mask\n                for (var hx = 0; hx < h; ++hx) {\n                    for (var wx = 0; wx < w; ++wx) {\n                        mask[n + wx + hx * len1] = 0\n                    }\n                }\n\n            }\n        }\n    }\n\n\n\n    // Helper functions with AO and non-AO implementations:\n\n    function maskCompare(index, mask, maskVal, aomask, aoVal) {\n        if (maskVal !== mask[index]) return false\n        if (aoVal !== aomask[index]) return false\n        return true\n    }\n\n    function maskCompare_noAO(index, mask, maskVal, aomask, aoVal) {\n        if (maskVal !== mask[index]) return false\n        return true\n    }\n\n    function pushMeshColors_noAO(colors, c, ao, aoValues, revAoVal) {\n        colors.push(c[0], c[1], c[2], 1)\n        colors.push(c[0], c[1], c[2], 1)\n        colors.push(c[0], c[1], c[2], 1)\n        colors.push(c[0], c[1], c[2], 1)\n        return true // triangle direction doesn't matter for non-AO\n    }\n\n    function pushMeshColors(colors, c, ao, aoValues, revAoVal) {\n        var ao00 = unpackAOMask(ao, 0, 0)\n        var ao10 = unpackAOMask(ao, 1, 0)\n        var ao11 = unpackAOMask(ao, 1, 1)\n        var ao01 = unpackAOMask(ao, 0, 1)\n        pushAOColor(colors, c, ao00, aoValues, revAoVal)\n        pushAOColor(colors, c, ao10, aoValues, revAoVal)\n        pushAOColor(colors, c, ao11, aoValues, revAoVal)\n        pushAOColor(colors, c, ao01, aoValues, revAoVal)\n\n        // this bit is pretty magical..\n        var triDir = true\n        if (ao00 === ao11) {\n            triDir = (ao01 === ao10) ? (ao01 === 2) : true\n        } else {\n            triDir = (ao01 === ao10) ? false : (ao00 + ao11 > ao01 + ao10)\n        }\n        return triDir\n    }\n\n    function sign(num) {\n        return (num > 0) ? 1 : -1\n    }\n\n\n\n\n    /* \n     *  packAOMask:\n     *\n     *    For a given face, find occlusion levels for each vertex, then\n     *    pack 4 such (2-bit) values into one Uint8 value\n     * \n     *  Occlusion levels:\n     *    1 is flat ground, 2 is partial occlusion, 3 is max (corners)\n     *    0 is \"reverse occlusion\" - an unoccluded exposed edge \n     *  Packing order var(bit offset):\n     *      a01(2)  -   a11(6)   ^  K\n     *        -     -            +> J\n     *      a00(0)  -   a10(4)\n     */\n\n    // when skipping reverse AO, uses this simpler version of the function:\n\n    function packAOMaskNoReverse(data, ipos, ineg, j, k) {\n        var a00 = 1\n        var a01 = 1\n        var a10 = 1\n        var a11 = 1\n\n        // inc occlusion of vertex next to obstructed side\n        if (solidLookup[data.get(ipos, j + 1, k)]) { ++a10; ++a11 }\n        if (solidLookup[data.get(ipos, j - 1, k)]) { ++a00; ++a01 }\n        if (solidLookup[data.get(ipos, j, k + 1)]) { ++a01; ++a11 }\n        if (solidLookup[data.get(ipos, j, k - 1)]) { ++a00; ++a10 }\n\n        // facing into a solid (non-opaque) block?\n        var facingSolid = solidLookup[data.get(ipos, j, k)]\n        if (facingSolid) {\n            // always 2, or 3 in corners\n            a11 = (a11 === 3 || solidLookup[data.get(ipos, j + 1, k + 1)]) ? 3 : 2\n            a01 = (a01 === 3 || solidLookup[data.get(ipos, j - 1, k + 1)]) ? 3 : 2\n            a10 = (a10 === 3 || solidLookup[data.get(ipos, j + 1, k - 1)]) ? 3 : 2\n            a00 = (a00 === 3 || solidLookup[data.get(ipos, j - 1, k - 1)]) ? 3 : 2\n        } else {\n            // treat corner as occlusion 3 only if not occluded already\n            if (a11 === 1 && (solidLookup[data.get(ipos, j + 1, k + 1)])) { a11 = 2 }\n            if (a01 === 1 && (solidLookup[data.get(ipos, j - 1, k + 1)])) { a01 = 2 }\n            if (a10 === 1 && (solidLookup[data.get(ipos, j + 1, k - 1)])) { a10 = 2 }\n            if (a00 === 1 && (solidLookup[data.get(ipos, j - 1, k - 1)])) { a00 = 2 }\n        }\n\n        return a11 << 6 | a10 << 4 | a01 << 2 | a00\n    }\n\n    // more complicated AO packing when doing reverse AO on corners\n\n    function packAOMask(data, ipos, ineg, j, k) {\n        var a00 = 1\n        var a01 = 1\n        var a10 = 1\n        var a11 = 1\n\n        // inc occlusion of vertex next to obstructed side\n        if (solidLookup[data.get(ipos, j + 1, k)]) { ++a10; ++a11 }\n        if (solidLookup[data.get(ipos, j - 1, k)]) { ++a00; ++a01 }\n        if (solidLookup[data.get(ipos, j, k + 1)]) { ++a01; ++a11 }\n        if (solidLookup[data.get(ipos, j, k - 1)]) { ++a00; ++a10 }\n\n        // facing into a solid (non-opaque) block?\n        var facingSolid = solidLookup[data.get(ipos, j, k)]\n        if (facingSolid) {\n            // always 2, or 3 in corners\n            a11 = (a11 === 3 || solidLookup[data.get(ipos, j + 1, k + 1)]) ? 3 : 2\n            a01 = (a01 === 3 || solidLookup[data.get(ipos, j - 1, k + 1)]) ? 3 : 2\n            a10 = (a10 === 3 || solidLookup[data.get(ipos, j + 1, k - 1)]) ? 3 : 2\n            a00 = (a00 === 3 || solidLookup[data.get(ipos, j - 1, k - 1)]) ? 3 : 2\n        } else {\n\n            // check each corner, and if not present do reverse AO\n            if (a11 === 1) {\n                if (solidLookup[data.get(ipos, j + 1, k + 1)]) {\n                    a11 = 2\n                } else if (!(solidLookup[data.get(ineg, j, k + 1)]) ||\n                    !(solidLookup[data.get(ineg, j + 1, k)]) ||\n                    !(solidLookup[data.get(ineg, j + 1, k + 1)])) {\n                    a11 = 0\n                }\n            }\n\n            if (a10 === 1) {\n                if (solidLookup[data.get(ipos, j + 1, k - 1)]) {\n                    a10 = 2\n                } else if (!(solidLookup[data.get(ineg, j, k - 1)]) ||\n                    !(solidLookup[data.get(ineg, j + 1, k)]) ||\n                    !(solidLookup[data.get(ineg, j + 1, k - 1)])) {\n                    a10 = 0\n                }\n            }\n\n            if (a01 === 1) {\n                if (solidLookup[data.get(ipos, j - 1, k + 1)]) {\n                    a01 = 2\n                } else if (!(solidLookup[data.get(ineg, j, k + 1)]) ||\n                    !(solidLookup[data.get(ineg, j - 1, k)]) ||\n                    !(solidLookup[data.get(ineg, j - 1, k + 1)])) {\n                    a01 = 0\n                }\n            }\n\n            if (a00 === 1) {\n                if (solidLookup[data.get(ipos, j - 1, k - 1)]) {\n                    a00 = 2\n                } else if (!(solidLookup[data.get(ineg, j, k - 1)]) ||\n                    !(solidLookup[data.get(ineg, j - 1, k)]) ||\n                    !(solidLookup[data.get(ineg, j - 1, k - 1)])) {\n                    a00 = 0\n                }\n            }\n        }\n\n        return a11 << 6 | a10 << 4 | a01 << 2 | a00\n    }\n\n\n\n    // unpack (2 bit) ao value from ao mask\n    // see above for details\n    function unpackAOMask(aomask, jpos, kpos) {\n        var offset = jpos ? (kpos ? 6 : 4) : (kpos ? 2 : 0)\n        return aomask >> offset & 3\n    }\n\n\n    // premultiply vertex colors by value depending on AO level\n    // then push them into color array\n    function pushAOColor(colors, baseCol, ao, aoVals, revAoVal) {\n        var mult = (ao === 0) ? revAoVal : aoVals[ao - 1]\n        colors.push(baseCol[0] * mult, baseCol[1] * mult, baseCol[2] * mult, 1)\n    }\n\n}\n\n\n\n\n\n\n\nimport { makeProfileHook } from './util'\nvar profile_hook = (PROFILE_EVERY) ?\n    makeProfileHook(PROFILE_EVERY, 'Terrain meshing') : () => { }\n","import { SolidParticleSystem } from '@babylonjs/core/Particles/solidParticleSystem'\n\n\nexport default new ObjectMesher()\n\n\n// enable for profiling..\nvar PROFILE = 0\n\n\n\n\n// helper class to hold data about a single object mesh\nfunction ObjMeshDat(id, x, y, z) {\n    this.id = id | 0\n    this.x = x | 0\n    this.y = y | 0\n    this.z = z | 0\n}\n\n\n\n\n\n\n\n/*\n * \n * \n *          Object meshing\n *  Per-chunk handling of the creation/disposal of voxels with static meshes\n * \n * \n */\n\n\nfunction ObjectMesher() {\n\n\n    // adds properties to the new chunk that will be used when processing\n    this.initChunk = function (chunk) {\n        chunk._objectBlocks = {}\n        chunk._objectSystems = []\n    }\n\n    this.disposeChunk = function (chunk) {\n        this.removeObjectMeshes(chunk)\n        chunk._objectBlocks = null\n    }\n\n\n\n\n    // accessors for the chunk to regester as object voxels are set/unset\n    this.addObjectBlock = function (chunk, id, x, y, z) {\n        var key = x + '|' + y + '|' + z\n        chunk._objectBlocks[key] = new ObjMeshDat(id, x, y, z, null)\n    }\n\n    this.removeObjectBlock = function (chunk, x, y, z) {\n        var key = x + '|' + y + '|' + z\n        if (chunk._objectBlocks[key]) delete chunk._objectBlocks[key]\n    }\n\n\n\n\n    /*\n     * \n     *    main implementation - remove / rebuild all needed object mesh instances\n     * \n     */\n\n    this.removeObjectMeshes = function (chunk) {\n        // remove the current (if any) sps/mesh\n        var systems = chunk._objectSystems || []\n        while (systems.length) {\n            var sps = systems.pop()\n            if (sps.mesh) sps.mesh.dispose()\n            sps.dispose()\n        }\n    }\n\n    this.buildObjectMeshes = function (chunk) {\n        profile_hook('start')\n\n        var scene = chunk.noa.rendering.getScene()\n        var objectMeshLookup = chunk.noa.registry._blockMeshLookup\n\n        // preprocess everything to build lists of object block keys\n        // hashed by material ID and then by block ID\n        var matIndexes = {}\n        for (var key in chunk._objectBlocks) {\n            var blockDat = chunk._objectBlocks[key]\n            var blockID = blockDat.id\n            var mat = objectMeshLookup[blockID].material\n            var matIndex = (mat) ? scene.materials.indexOf(mat) : -1\n            if (!matIndexes[matIndex]) matIndexes[matIndex] = {}\n            if (!matIndexes[matIndex][blockID]) matIndexes[matIndex][blockID] = []\n            matIndexes[matIndex][blockID].push(key)\n        }\n        profile_hook('preprocess')\n\n        // data structure now looks like:\n        // matIndexes = {\n        //      2: {                    // i.e. 2nd material in scene\n        //          14: {               // i.e. voxel ID 14 from registry\n        //              [ '2|3|4' ]     // key of block's local coords\n        //          }\n        //      }\n        // }\n\n        var x0 = chunk.i * chunk.size\n        var y0 = chunk.j * chunk.size\n        var z0 = chunk.k * chunk.size\n\n        // build one SPS mesh for each material\n        var meshes = []\n        for (var ix in matIndexes) {\n\n            var meshHash = matIndexes[ix]\n            var sps = buildSPSforMaterialIndex(chunk, scene, meshHash, x0, y0, z0)\n            profile_hook('made SPS')\n\n            // build SPS into the scene\n            var merged = sps.buildMesh()\n            profile_hook('built mesh')\n\n            // finish up\n            merged.material = (ix > -1) ? scene.materials[ix] : null\n            meshes.push(merged)\n            chunk._objectSystems.push(sps)\n        }\n\n        profile_hook('end')\n        return meshes\n    }\n\n\n\n\n    function buildSPSforMaterialIndex(chunk, scene, meshHash, x0, y0, z0) {\n        var blockHash = chunk._objectBlocks\n        // base sps\n        var sps = new SolidParticleSystem('object_sps_' + chunk.id, scene, {\n            updatable: false,\n        })\n\n        var blockHandlerLookup = chunk.noa.registry._blockHandlerLookup\n        var objectMeshLookup = chunk.noa.registry._blockMeshLookup\n\n        // run through mesh hash adding shapes and position functions\n        for (var blockID in meshHash) {\n            var mesh = objectMeshLookup[blockID]\n            var blockArr = meshHash[blockID]\n            var count = blockArr.length\n\n            var handlerFn\n            var handlers = blockHandlerLookup[blockID]\n            if (handlers) handlerFn = handlers.onCustomMeshCreate\n            var setShape = function (particle, partIndex, shapeIndex) {\n                var key = blockArr[shapeIndex]\n                var dat = blockHash[key]\n\n                // set (local) pos and call handler (with global coords)\n                particle.position.set(dat.x + 0.5, dat.y, dat.z + 0.5)\n                if (handlerFn) handlerFn(particle, x0 + dat.x, y0 + dat.y, z0 + dat.z)\n            }\n            sps.addShape(mesh, count, { positionFunction: setShape })\n            blockArr.length = 0\n        }\n\n        return sps\n    }\n\n\n\n\n}\n\n\n\n\n\n\n\nimport { makeProfileHook } from './util'\nvar profile_hook = (PROFILE) ?\n    makeProfileHook(50, 'Object meshing') : () => { }\n","\nvar ndarray = require('ndarray')\n\n// shared references to terrain/object meshers\nimport TerrainMesher from './terrainMesher'\nimport objectMesher from './objectMesher'\n\n\nexport default Chunk\n\n\n/* \n * \n *   Chunk\n * \n *  Stores and manages voxel ids and flags for each voxel within chunk\n * \n */\n\n\n\n\n\n/*\n *\n *    Chunk constructor\n *\n */\n\nfunction Chunk(noa, id, i, j, k, size, dataArray) {\n    this.id = id            // id used by noa\n    this.requestID = ''     // id sent to game client\n\n    this.noa = noa\n    this.isDisposed = false\n    this.octreeBlock = null\n\n    // voxel data and properties\n    this.voxels = dataArray\n    this.i = i\n    this.j = j\n    this.k = k\n    this.size = size\n    this.x = i * size\n    this.y = j * size\n    this.z = k * size\n\n    // flags to track if things need re-meshing\n    this._terrainDirty = false\n    this._objectsDirty = false\n\n    // (re) init references shared among all chunks\n    solidLookup = noa.registry._solidityLookup\n    opaqueLookup = noa.registry._opacityLookup\n    objectLookup = noa.registry._objectLookup\n    blockHandlerLookup = noa.registry._blockHandlerLookup\n\n    // makes data for terrain / object meshing\n    this._terrainMesh = null\n    this._objectBlocks = null\n    this._objectSystems = null\n    objectMesher.initChunk(this)\n\n    this.isFull = false\n    this.isEmpty = false\n\n    // references to neighboring chunks, if they exist (filled in by `world`)\n    var narr = Array.from(Array(27)).map(() => null)\n    this._neighbors = new ndarray(narr, [3, 3, 3]).lo(1, 1, 1)\n    this._neighbors.set(0, 0, 0, this)\n    this._neighborCount = 0\n    this._maxMeshedNeighbors = 0\n    this._timesMeshed = 0\n\n    // passes through voxel contents, calling block handlers etc.\n    scanVoxelData(this)\n}\n\n\n// expose logic internally to create and update the voxel data array\nChunk._createVoxelArray = function (size) {\n    var arr = new Uint16Array(size * size * size)\n    return new ndarray(arr, [size, size, size])\n}\n\nChunk.prototype._updateVoxelArray = function (dataArray) {\n    // dispose current object blocks\n    callAllBlockHandlers(this, 'onUnload')\n    objectMesher.disposeChunk(this)\n    this.voxels = dataArray\n    this._terrainDirty = false\n    this._objectsDirty = false\n    objectMesher.initChunk(this)\n    scanVoxelData(this)\n}\n\n\n// Registry lookup references shared by all chunks\nvar solidLookup\nvar opaqueLookup\nvar objectLookup\nvar blockHandlerLookup\n\n\n\n\n\n\n\n\n\n/*\n *\n *    Chunk API\n *\n */\n\n// get/set deal with block IDs, so that this class acts like an ndarray\n\nChunk.prototype.get = function (x, y, z) {\n    return this.voxels.get(x, y, z)\n}\n\nChunk.prototype.getSolidityAt = function (x, y, z) {\n    return solidLookup[this.voxels.get(x, y, z)]\n}\n\nChunk.prototype.set = function (x, y, z, newID) {\n    var oldID = this.voxels.get(x, y, z)\n    var oldIDnum = oldID\n    if (newID === oldIDnum) return\n\n    // manage data\n    this.voxels.set(x, y, z, newID)\n\n    // voxel lifecycle handling\n    if (objectLookup[oldID]) removeObjectBlock(this, x, y, z)\n    if (objectLookup[newID]) addObjectBlock(this, newID, x, y, z)\n    callBlockHandler(this, oldIDnum, 'onUnset', x, y, z)\n    callBlockHandler(this, newID, 'onSet', x, y, z)\n\n    // track full/emptiness and info about terrain\n    if (!opaqueLookup[newID]) this.isFull = false\n    if (newID !== 0) this.isEmpty = false\n    if (affectsTerrain(newID) || affectsTerrain(oldID)) {\n        this._terrainDirty = true\n    }\n\n    if (this._terrainDirty || this._objectsDirty) {\n        this.noa.world._queueChunkForRemesh(this)\n    }\n\n    // neighbors only affected if solidity or opacity changed on an edge\n    var SOchanged = false\n    if (solidLookup[oldID] !== solidLookup[newID]) SOchanged = true\n    if (opaqueLookup[oldID] !== opaqueLookup[newID]) SOchanged = true\n    if (SOchanged) {\n        var edge = this.size - 1\n        var iedge = (x === 0) ? -1 : (x < edge) ? 0 : 1\n        var jedge = (y === 0) ? -1 : (y < edge) ? 0 : 1\n        var kedge = (z === 0) ? -1 : (z < edge) ? 0 : 1\n        if (iedge | jedge | kedge) {\n            var is = (iedge) ? [0, iedge] : [0]\n            var js = (jedge) ? [0, jedge] : [0]\n            var ks = (kedge) ? [0, kedge] : [0]\n            is.forEach(i => {\n                js.forEach(j => {\n                    ks.forEach(k => {\n                        if ((i | j | k) === 0) return\n                        var nab = this._neighbors.get(i, j, k)\n                        if (!nab) return\n                        nab._terrainDirty = true\n                        this.noa.world._queueChunkForRemesh(nab)\n                    })\n                })\n            })\n        }\n    }\n}\n\n\n\n\n\n\n// helper to call handler of a given type at a particular xyz\nfunction callBlockHandler(chunk, handlers, type, x, y, z) {\n    var handler = handlers[type]\n    if (!handler) return\n    handler(chunk.x + x, chunk.y + y, chunk.z + z)\n}\n\n\n\n// Convert chunk's voxel terrain into a babylon.js mesh\n// Used internally, but needs to be public so mesh-building hacks can call it\nChunk.prototype.mesh = function (matGetter, colGetter, ignoreMats, useAO, aoVals, revAoVal) {\n    if (!terrainMesher) terrainMesher = new TerrainMesher(this.noa)\n    return terrainMesher.meshChunk(this, matGetter, colGetter, ignoreMats, useAO, aoVals, revAoVal)\n}\n\nvar terrainMesher\n\n\n\n\n// gets called by World when this chunk has been queued for remeshing\nChunk.prototype.updateMeshes = function () {\n    var rendering = this.noa.rendering\n    if (this._terrainDirty) {\n        if (this._terrainMesh) this._terrainMesh.dispose()\n        var mesh = this.mesh()\n        if (mesh && mesh.getIndices().length > 0) {\n            var pos = [this.x, this.y, this.z]\n            rendering.addMeshToScene(mesh, true, pos, this)\n        }\n        this._terrainMesh = mesh || null\n        this._terrainDirty = false\n        this._timesMeshed++\n        this._maxMeshedNeighbors = Math.max(this._maxMeshedNeighbors, this._neighborCount)\n    }\n    if (this._objectsDirty) {\n        objectMesher.removeObjectMeshes(this)\n        var meshes = objectMesher.buildObjectMeshes(this)\n        var pos2 = [this.x, this.y, this.z]\n        meshes.forEach(mesh => rendering.addMeshToScene(mesh, true, pos2, this))\n        this._objectsDirty = false\n    }\n}\n\n\n\n\n\n\n\n// helpers to determine which blocks are, or can affect, terrain meshes\nfunction affectsTerrain(id) {\n    if (id === 0) return false\n    if (solidLookup[id]) return true\n    return !objectLookup[id]\n}\n\n\n\n\n\n\n\n\n\n/*\n * \n *      Init\n * \n *  Scans voxel data, processing object blocks and setting chunk flags\n * \n*/\n\nfunction scanVoxelData(chunk) {\n    // flags for tracking if chunk is entirely opaque or transparent\n    var fullyOpaque = true\n    var fullyAir = true\n    var hasObj = false\n\n    var voxels = chunk.voxels\n    var data = voxels.data\n    var len = voxels.shape[0]\n    var handlerLookup = blockHandlerLookup\n    for (var i = 0; i < len; ++i) {\n        for (var j = 0; j < len; ++j) {\n            var index = voxels.index(i, j, 0)\n            for (var k = 0; k < len; ++k, ++index) {\n                var id = data[index]\n                // skip air blocks\n                if (id === 0) {\n                    fullyOpaque = false\n                    continue\n                }\n                fullyOpaque = fullyOpaque && opaqueLookup[id]\n                fullyAir = false\n                // handle object blocks and handlers\n                if (objectLookup[id]) {\n                    addObjectBlock(chunk, id, i, j, k)\n                    hasObj = true\n                }\n                var handlers = handlerLookup[id]\n                if (handlers) {\n                    callBlockHandler(chunk, handlers, 'onLoad', i, j, k)\n                }\n            }\n        }\n    }\n\n    chunk.isFull = fullyOpaque\n    chunk.isEmpty = fullyAir\n    chunk._terrainDirty = !chunk.isEmpty\n    chunk._objectsDirty = hasObj\n}\n\n\n\n\n\n// accessors related to meshing\n\nfunction addObjectBlock(chunk, id, x, y, z) {\n    objectMesher.addObjectBlock(chunk, id, x, y, z)\n    chunk._objectsDirty = true\n}\n\nfunction removeObjectBlock(chunk, x, y, z) {\n    objectMesher.removeObjectBlock(chunk, x, y, z)\n    chunk._objectsDirty = true\n}\n\n\n\n\n\n// dispose function - just clears properties and references\n\nChunk.prototype.dispose = function () {\n    // look through the data for onUnload handlers\n    callAllBlockHandlers(this, 'onUnload')\n\n    // let meshers dispose their stuff\n    objectMesher.disposeChunk(this)\n    if (this._terrainMesh) this._terrainMesh.dispose()\n\n    // apparently there's no way to dispose typed arrays, so just null everything\n    this.voxels.data = null\n    this.voxels = null\n    this._neighbors.data = null\n    this._neighbors = null\n\n    this.isDisposed = true\n}\n\n\n// helper to call a given handler for all blocks in the chunk\nfunction callAllBlockHandlers(chunk, type) {\n    var voxels = chunk.voxels\n    var data = voxels.data\n    var handlerLookup = blockHandlerLookup\n    var len = voxels.shape[0]\n    for (var i = 0; i < len; ++i) {\n        for (var j = 0; j < len; ++j) {\n            var index = voxels.index(i, j, 0)\n            for (var k = 0; k < len; ++k, ++index) {\n                var id = data[index]\n                if (id > 0 && handlerLookup[id]) {\n                    callBlockHandler(chunk, handlerLookup[id], type, i, j, k)\n                }\n            }\n        }\n    }\n}\n","\nvar EventEmitter = require('events').EventEmitter\nimport Chunk from './chunk'\nimport { StringList } from './util'\nimport { loopForTime, numberOfVoxelsInSphere } from './util'\n\nvar PROFILE = 0\nvar PROFILE_QUEUES = 0\n\n\nexport default function (noa, opts) {\n    return new World(noa, opts)\n}\n\n\n\n\nvar defaultOptions = {\n    chunkSize: 24,\n    chunkAddDistance: 3,\n    chunkRemoveDistance: 4,\n    worldGenWhilePaused: false,\n    manuallyControlChunkLoading: false,\n}\n\n/**\n * @class\n * @typicalname noa.world\n * @emits worldDataNeeded(id, ndarray, x, y, z, worldName)\n * @emits chunkAdded(chunk)\n * @emits chunkBeingRemoved(id, ndarray, userData)\n * @classdesc Manages the world and its chunks\n * \n * Extends `EventEmitter`\n */\n\nfunction World(noa, opts) {\n    this.noa = noa\n    opts = Object.assign({}, defaultOptions, opts)\n\n    this.playerChunkLoaded = false\n    this.Chunk = Chunk\n\n    this.chunkSize = opts.chunkSize\n    this.chunkAddDistance = opts.chunkAddDistance\n    this.chunkRemoveDistance = opts.chunkRemoveDistance\n    if (this.chunkRemoveDistance < this.chunkAddDistance) {\n        this.chunkRemoveDistance = this.chunkAddDistance\n    }\n\n    // game clients should set this if they need to manually control \n    // which chunks to load and unload.\n    // when set, client should call noa.world.manuallyLoadChunk / UnloadChunk\n    this.manuallyControlChunkLoading = !!opts.manuallyControlChunkLoading\n\n    // set this higher to cause chunks not to mesh until they have some neighbors\n    this.minNeighborsToMesh = 6\n\n    // settings for tuning worldgen behavior and throughput\n    this.maxChunksPendingCreation = 10\n    this.maxChunksPendingMeshing = 10\n    this.maxProcessingPerTick = 9      // ms\n    this.maxProcessingPerRender = 5    // ms\n    this.worldGenWhilePaused = opts.worldGenWhilePaused\n\n    // set up internal state\n    this._cachedWorldName = ''\n    this._lastPlayerChunkID = ''\n    this._chunkStorage = {}\n    initChunkQueues(this)\n    initChunkStorage(this)\n\n    // instantiate coord conversion functions based on the chunk size\n    // use bit twiddling if chunk size is a power of 2\n    var cs = this.chunkSize\n    if ((cs & cs - 1) === 0) {\n        var shift = Math.log2(cs) | 0\n        var mask = (cs - 1) | 0\n        this._worldCoordToChunkCoord = coord => (coord >> shift) | 0\n        this._worldCoordToChunkIndex = coord => (coord & mask) | 0\n        this._worldCoordsToChunkCoords = (x, y, z) => {\n            var i = (x >> shift) | 0\n            var j = (y >> shift) | 0\n            var k = (z >> shift) | 0\n            return [i, j, k]\n        }\n        this._worldCoordsToChunkIndexes = (x, y, z) => {\n            var i = (x & mask) | 0\n            var j = (y & mask) | 0\n            var k = (z & mask) | 0\n            return [i, j, k]\n        }\n    } else {\n        this._worldCoordToChunkCoord = coord => Math.floor(coord / cs) | 0\n        this._worldCoordToChunkIndex = coord => (((coord % cs) + cs) % cs) | 0\n        this._worldCoordsToChunkCoords = (x, y, z) => {\n            var i = Math.floor(x / cs) | 0\n            var j = Math.floor(y / cs) | 0\n            var k = Math.floor(z / cs) | 0\n            return [i, j, k]\n        }\n        this._worldCoordsToChunkIndexes = (x, y, z) => {\n            var i = (((x % cs) + cs) % cs) | 0\n            var j = (((y % cs) + cs) % cs) | 0\n            var k = (((z % cs) + cs) % cs) | 0\n            return [i, j, k]\n        }\n    }\n}\nWorld.prototype = Object.create(EventEmitter.prototype)\n\n\n\n\n\n\n\n\n\n/*\n *\n *\n *\n *\n *                  PUBLIC API \n *\n *\n *\n *\n*/\n\n/** @param x,y,z */\nWorld.prototype.getBlockID = function (x, y, z) {\n    var chunk = this._getChunkByCoords(x, y, z)\n    if (!chunk) return 0\n    var [i, j, k] = this._worldCoordsToChunkIndexes(x, y, z)\n    return chunk.get(i, j, k)\n}\n\n/** @param x,y,z */\nWorld.prototype.getBlockSolidity = function (x, y, z) {\n    var chunk = this._getChunkByCoords(x, y, z)\n    if (!chunk) return false\n    var [i, j, k] = this._worldCoordsToChunkIndexes(x, y, z)\n    return !!chunk.getSolidityAt(i, j, k)\n}\n\n/** @param x,y,z */\nWorld.prototype.getBlockOpacity = function (x, y, z) {\n    var id = this.getBlockID(x, y, z)\n    return this.noa.registry.getBlockOpacity(id)\n}\n\n/** @param x,y,z */\nWorld.prototype.getBlockFluidity = function (x, y, z) {\n    var id = this.getBlockID(x, y, z)\n    return this.noa.registry.getBlockFluidity(id)\n}\n\n/** @param x,y,z */\nWorld.prototype.getBlockProperties = function (x, y, z) {\n    var id = this.getBlockID(x, y, z)\n    return this.noa.registry.getBlockProps(id)\n}\n\n/** @param x,y,z */\nWorld.prototype.getBlockObjectMesh = function (x, y, z) {\n    var chunk = this._getChunkByCoords(x, y, z)\n    if (!chunk) return 0\n    return chunk.getObjectMeshAt(\n        this._worldCoordToChunkIndex(x),\n        this._worldCoordToChunkIndex(y),\n        this._worldCoordToChunkIndex(z))\n}\n\n\n/** @param val,x,y,z */\nWorld.prototype.setBlockID = function (val, x, y, z) {\n    var [i, j, k] = this._worldCoordsToChunkCoords(x, y, z)\n    var [ix, iy, iz] = this._worldCoordsToChunkIndexes(x, y, z)\n\n    // logic inside the chunk will trigger a remesh for chunk and \n    // any neighbors that need it\n    var chunk = this._getChunk(i, j, k)\n    if (chunk) chunk.set(ix, iy, iz, val)\n}\n\n\n/** @param box */\nWorld.prototype.isBoxUnobstructed = function (box) {\n    var base = box.base\n    var max = box.max\n    for (var i = Math.floor(base[0]); i < max[0] + 1; i++) {\n        for (var j = Math.floor(base[1]); j < max[1] + 1; j++) {\n            for (var k = Math.floor(base[2]); k < max[2] + 1; k++) {\n                if (this.getBlockSolidity(i, j, k)) return false\n            }\n        }\n    }\n    return true\n}\n\n\n/** client should call this after creating a chunk's worth of data (as an ndarray)  \n * If userData is passed in it will be attached to the chunk\n * @param id\n * @param array\n * @param userData\n */\nWorld.prototype.setChunkData = function (id, array, userData) {\n    setChunkData(this, id, array, userData)\n}\n\n\n/** Tells noa to discard voxel data within a given `AABB` (e.g. because \n * the game client received updated data from a server). \n * The engine will mark all affected chunks for disposal, and will later emit \n * new `worldDataNeeded` events (if the chunk is still in draw range).\n * Note that chunks invalidated this way will not emit a `chunkBeingRemoved` event \n * for the client to save data from.\n */\nWorld.prototype.invalidateVoxelsInAABB = function (box) {\n    invalidateChunksInBox(this, box)\n}\n\n\n/** When manually controlling chunk loading, tells the engine that the \n * chunk containing the specified (x,y,z) needs to be created and loaded.\n * > Note: has no effect when `noa.world.manuallyControlChunkLoading` is not set.\n * @param x, y, z\n */\nWorld.prototype.manuallyLoadChunk = function (x, y, z) {\n    if (!this.manuallyControlChunkLoading) throw manualErr\n    var [i, j, k] = this._worldCoordsToChunkCoords(x, y, z)\n    var id = getChunkID(i, j, k)\n    this._chunkIDsKnown.add(id)\n    this._chunkIDsToRequest.add(id)\n}\n/** When manually controlling chunk loading, tells the engine that the \n * chunk containing the specified (x,y,z) needs to be unloaded and disposed.\n * > Note: has no effect when `noa.world.manuallyControlChunkLoading` is not set.\n * @param x, y, z\n */\nWorld.prototype.manuallyUnloadChunk = function (x, y, z) {\n    if (!this.manuallyControlChunkLoading) throw manualErr\n    var [i, j, k] = this._worldCoordsToChunkCoords(x, y, z)\n    var id = getChunkID(i, j, k)\n    this._chunkIDsToRemove.add(id)\n    this._chunkIDsToRequest.remove(id)\n    this._chunkIDsToMesh.remove(id)\n    this._chunkIDsToMeshFirst.remove(id)\n}\nvar manualErr = 'Set `noa.world.manuallyControlChunkLoading` if you need this API'\n\n\n\n\n/*\n * \n * \n * \n *                  internals:\n * \n *          tick functions that process queues and trigger events\n * \n * \n * \n*/\n\n\nWorld.prototype.tick = function () {\n    var tickStartTime = performance.now()\n\n    // if world has changed, mark everything to be removed and re-requested\n    if (this._cachedWorldName !== this.noa.worldName) {\n        markAllChunksForRemoval(this)\n        this._cachedWorldName = this.noa.worldName\n    }\n\n    // current player chunk changed since last tick?\n    var pos = getPlayerChunkCoords(this)\n    var chunkID = getChunkID(pos[0], pos[1], pos[2])\n    var changedChunks = (chunkID != this._lastPlayerChunkID)\n    if (changedChunks) {\n        this.emit('playerEnteredChunk', pos[0], pos[1], pos[2])\n        this._lastPlayerChunkID = chunkID\n    }\n    profile_hook('start')\n    profile_queues_hook('start')\n\n    // possibly scan for chunks to add/remove\n    if (!this.manuallyControlChunkLoading) {\n        if (changedChunks) {\n            findDistantChunksToRemove(this, pos[0], pos[1], pos[2])\n            profile_hook('remQueue')\n        }\n        var numChunks = numberOfVoxelsInSphere(this.chunkAddDistance)\n        if (changedChunks || (this._chunkIDsKnown.count() < numChunks)) {\n            findNewChunksInRange(this, pos[0], pos[1], pos[2])\n            profile_hook('addQueue')\n        }\n    }\n\n    // process (create or mesh) some chunks, up to max iteration time\n    loopForTime(this.maxProcessingPerTick, () => {\n        var done = processRequestQueue(this)\n        profile_hook('requests')\n        done = done && processRemoveQueue(this)\n        profile_hook('removes')\n        done = done && processMeshingQueue(this, false)\n        profile_hook('meshes')\n        return done\n    }, tickStartTime)\n\n    // when time is left over, look for low-priority extra meshing\n    var dt = performance.now() - tickStartTime\n    if (dt + 2 < this.maxProcessingPerTick) {\n        lookForChunksToMesh(this)\n        profile_hook('looking')\n        loopForTime(this.maxProcessingPerTick, () => {\n            var done = processMeshingQueue(this, false)\n            profile_hook('meshes')\n            return done\n        }, tickStartTime, true)\n    }\n\n    // track whether the player's local chunk is loaded and ready or not\n    var pChunk = this._getChunk(pos[0], pos[1], pos[2])\n    this.playerChunkLoaded = !!pChunk\n\n    profile_queues_hook('end', this)\n    profile_hook('end')\n}\n\n\nWorld.prototype.render = function () {\n    // on render, quickly process the high-priority meshing queue\n    // to help avoid flashes of background while neighboring chunks update\n    loopForTime(this.maxProcessingPerRender, () => {\n        return processMeshingQueue(this, true)\n    })\n}\n\n\n\n\n\n\n\n\n/*\n * \n * \n * \n *              chunk IDs, storage, and lookup/retrieval\n * \n * \n * \n*/\n\nfunction getChunkID(i, j, k) {\n    // chunk coords -> canonical string ID\n    return i + '|' + j + '|' + k\n}\n\nfunction parseChunkID(id) {\n    // chunk ID -> coords\n    return id.split('|').map(s => parseInt(s))\n}\n\nfunction initChunkStorage(world) {\n    // var chunkHash = ndHash([1024, 1024, 1024])\n    world._getChunk = (i, j, k) => {\n        var id = i + '|' + j + '|' + k\n        return world._chunkStorage[id] || null\n    }\n    world._setChunk = (i, j, k, value) => {\n        var id = getChunkID(i, j, k)\n        if (value) {\n            world._chunkStorage[id] = value\n        } else {\n            delete world._chunkStorage[id]\n        }\n    }\n    // chunk accessor for internal use\n    world._getChunkByCoords = function (x, y, z) {\n        var [i, j, k] = world._worldCoordsToChunkCoords(x, y, z)\n        return world._getChunk(i, j, k)\n    }\n}\n\nfunction getPlayerChunkCoords(world) {\n    var pos = world.noa.entities.getPosition(world.noa.playerEntity)\n    var [i, j, k] = world._worldCoordsToChunkCoords(pos[0], pos[1], pos[2])\n    return [i, j, k]\n}\n\n\n\n\n\n\n\n\n/*\n * \n * \n * \n *              chunk queues and queue processing\n * \n * \n * \n*/\n\n\nfunction initChunkQueues(world) {\n    // queue meanings:\n    //    Known:        all chunks existing in any queue\n    //    ToRequest:    needed but not yet requested from client\n    //    Pending:      requested, awaiting creation\n    //    ToMesh:       created but not yet meshed\n    //    ToMeshFirst:  priority meshing queue\n    //    ToRemove:     chunks awaiting disposal\n    world._chunkIDsKnown = new StringList()\n    world._chunkIDsToRequest = new StringList()\n    world._chunkIDsPending = new StringList()\n    world._chunkIDsToMesh = new StringList()\n    world._chunkIDsToMeshFirst = new StringList()\n    world._chunkIDsToRemove = new StringList()\n    // accessor for chunks to queue themselves for remeshing\n    world._queueChunkForRemesh = (chunk) => {\n        queueChunkForRemesh(world, chunk)\n    }\n}\n\n\n// process neighborhood chunks, add missing ones to \"toRequest\" and \"inMemory\"\nfunction findNewChunksInRange(world, ci, cj, ck) {\n    var add = Math.ceil(world.chunkAddDistance)\n    var addDistSq = world.chunkAddDistance * world.chunkAddDistance\n    var known = world._chunkIDsKnown\n    var toRequest = world._chunkIDsToRequest\n    // search all nearby chunk locations\n    for (var i = ci - add; i <= ci + add; ++i) {\n        for (var j = cj - add; j <= cj + add; ++j) {\n            for (var k = ck - add; k <= ck + add; ++k) {\n                var id = getChunkID(i, j, k)\n                if (known.includes(id)) continue\n                var di = i - ci\n                var dj = j - cj\n                var dk = k - ck\n                var distSq = di * di + dj * dj + dk * dk\n                if (distSq > addDistSq) continue\n                known.add(id)\n                toRequest.add(id)\n            }\n        }\n    }\n    sortIDListByDistanceFrom(toRequest, ci, cj, ck)\n}\n\n\n// rebuild queue of chunks to be removed from around (ci,cj,ck)\nfunction findDistantChunksToRemove(world, ci, cj, ck) {\n    var remDistSq = world.chunkRemoveDistance * world.chunkRemoveDistance\n    var toRemove = world._chunkIDsToRemove\n    world._chunkIDsKnown.forEach(id => {\n        if (toRemove.includes(id)) return\n        var loc = parseChunkID(id)\n        var di = loc[0] - ci\n        var dj = loc[1] - cj\n        var dk = loc[2] - ck\n        var distSq = di * di + dj * dj + dk * dk\n        if (distSq < remDistSq) return\n        // flag chunk for removal and remove it from work queues\n        world._chunkIDsToRemove.add(id)\n        world._chunkIDsToRequest.remove(id)\n        world._chunkIDsToMesh.remove(id)\n        world._chunkIDsToMeshFirst.remove(id)\n    })\n    sortIDListByDistanceFrom(toRemove, ci, cj, ck)\n}\n\n\n// invalidate chunks overlapping the given AABB\nfunction invalidateChunksInBox(world, box) {\n    var min = box.base.map(n => Math.floor(world._worldCoordToChunkCoord(n)))\n    var max = box.max.map(n => Math.floor(world._worldCoordToChunkCoord(n)))\n    world._chunkIDsKnown.forEach(id => {\n        var pos = parseChunkID(id)\n        for (var i = 0; i < 3; i++) {\n            if (pos[i] < min[i] || pos[i] > max[i]) return\n        }\n        if (world._chunkIDsToRemove.includes(id)) return\n        world._chunkIDsToRequest.add(id)\n    })\n}\n\n// when current world changes - empty work queues and mark all for removal\nfunction markAllChunksForRemoval(world) {\n    world._chunkIDsToRemove.copyFrom(world._chunkIDsKnown)\n    world._chunkIDsToRequest.empty()\n    world._chunkIDsToMesh.empty()\n    world._chunkIDsToMeshFirst.empty()\n    var loc = getPlayerChunkCoords(world)\n    sortIDListByDistanceFrom(world._chunkIDsToRemove, loc[0], loc[1], loc[2])\n}\n\n\n// incrementally look for chunks that could stand to be re-meshed\nfunction lookForChunksToMesh(world) {\n    var queue = world._chunkIDsKnown.arr\n    var ct = Math.min(50, queue.length)\n    var numQueued = world._chunkIDsToMesh.count() + world._chunkIDsToMeshFirst.count()\n    for (var i = 0; i < ct; i++) {\n        lookIndex = (lookIndex + 1) % queue.length\n        var id = queue[lookIndex]\n        var chunk = world._chunkStorage[id]\n        if (!chunk) continue\n        var nc = chunk._neighborCount\n        if (nc < world.minNeighborsToMesh) continue\n        if (nc <= chunk._maxMeshedNeighbors) continue\n        queueChunkForRemesh(world, chunk)\n        if (++numQueued > 10) return\n    }\n}\nvar lookIndex = -1\n\n\n\n// run through chunk tracking queues looking for work to do next\nfunction processRequestQueue(world) {\n    var toRequest = world._chunkIDsToRequest\n    if (toRequest.isEmpty()) return true\n    // skip if too many outstanding requests, or if meshing queue is full\n    var pending = world._chunkIDsPending.count()\n    var toMesh = world._chunkIDsToMesh.count()\n    if (pending >= world.maxChunksPendingCreation) return true\n    if (toMesh >= world.maxChunksPendingMeshing) return true\n    var id = toRequest.pop()\n    requestNewChunk(world, id)\n    return toRequest.isEmpty()\n}\n\n\nfunction processRemoveQueue(world) {\n    var toRemove = world._chunkIDsToRemove\n    if (toRemove.isEmpty()) return true\n    removeChunk(world, toRemove.pop())\n    return (toRemove.isEmpty())\n}\n\n\n// similar to above but for chunks waiting to be meshed\nfunction processMeshingQueue(world, firstOnly) {\n    var queue = world._chunkIDsToMeshFirst\n    if (queue.isEmpty() && !firstOnly) queue = world._chunkIDsToMesh\n    if (queue.isEmpty()) return true\n\n    var id = queue.pop()\n    if (world._chunkIDsToRemove.includes(id)) return\n    var chunk = world._chunkStorage[id]\n    if (chunk) doChunkRemesh(world, chunk)\n}\n\n\n\n\n\n\n\n\n\n/*\n * \n * \n * \n *              chunk lifecycle - create / set / remove / modify\n * \n * \n * \n*/\n\n\n// create chunk object and request voxel data from client\nfunction requestNewChunk(world, id) {\n    var pos = parseChunkID(id)\n    var i = pos[0]\n    var j = pos[1]\n    var k = pos[2]\n    var size = world.chunkSize\n    var dataArr = Chunk._createVoxelArray(world.chunkSize)\n    var worldName = world.noa.worldName\n    var requestID = [i, j, k, worldName].join('|')\n    var x = i * size\n    var y = j * size\n    var z = k * size\n    world._chunkIDsPending.add(id)\n    world.emit('worldDataNeeded', requestID, dataArr, x, y, z, worldName)\n    profile_queues_hook('request')\n}\n\n// called when client sets a chunk's voxel data\n// If userData is passed in it will be attached to the chunk\nfunction setChunkData(world, reqID, array, userData) {\n    var arr = reqID.split('|')\n    var i = parseInt(arr.shift())\n    var j = parseInt(arr.shift())\n    var k = parseInt(arr.shift())\n    var worldName = arr.join('|')\n    var id = getChunkID(i, j, k)\n    world._chunkIDsPending.remove(id)\n    // discard data if it's for a world that's no longer current\n    if (worldName !== world.noa.worldName) return\n    // discard if chunk is no longer needed\n    if (!world._chunkIDsKnown.includes(id)) return\n    if (world._chunkIDsToRemove.includes(id)) return\n    var chunk = world._chunkStorage[id]\n    if (!chunk) {\n        // if chunk doesn't exist, create and init\n        var size = world.chunkSize\n        chunk = new Chunk(world.noa, id, i, j, k, size, array)\n        world._setChunk(i, j, k, chunk)\n        chunk.requestID = reqID\n        chunk.userData = userData\n        updateNeighborsOfChunk(world, i, j, k, chunk)\n        world.noa.rendering.prepareChunkForRendering(chunk)\n        world.emit('chunkAdded', chunk)\n    } else {\n        // else we're updating data for an existing chunk\n        chunk._updateVoxelArray(array)\n        // assume neighbors need remeshing\n        var list = chunk._neighbors.data\n        list.forEach(nab => {\n            if (!nab || nab === chunk) return\n            if (nab._neighborCount > 20) queueChunkForRemesh(world, nab)\n        })\n    }\n    // chunk can now be meshed...\n    queueChunkForRemesh(world, chunk)\n    profile_queues_hook('receive')\n}\n\n\n\n// remove a chunk that wound up in the remove queue\nfunction removeChunk(world, id) {\n    var loc = parseChunkID(id)\n    var chunk = world._getChunk(loc[0], loc[1], loc[2])\n    if (chunk) {\n        world.emit('chunkBeingRemoved', chunk.requestID, chunk.voxels, chunk.userData)\n        world.noa.rendering.disposeChunkForRendering(chunk)\n        chunk.dispose()\n        profile_queues_hook('dispose')\n        updateNeighborsOfChunk(world, loc[0], loc[1], loc[2], null)\n    }\n    world._setChunk(loc[0], loc[1], loc[2], null)\n    world._chunkIDsKnown.remove(id)\n    world._chunkIDsToMesh.remove(id)\n    world._chunkIDsToMeshFirst.remove(id)\n}\n\n\nfunction queueChunkForRemesh(world, chunk) {\n    var nc = chunk._neighborCount\n    var limit = Math.min(world.minNeighborsToMesh, 26)\n    if (nc < limit) return\n    chunk._terrainDirty = true\n    var queue = (nc === 26) ?\n        world._chunkIDsToMeshFirst : world._chunkIDsToMesh\n    queue.add(chunk.id)\n}\n\n\nfunction doChunkRemesh(world, chunk) {\n    world._chunkIDsToMesh.remove(chunk.id)\n    world._chunkIDsToMeshFirst.remove(chunk.id)\n    chunk.updateMeshes()\n    profile_queues_hook('mesh')\n}\n\n\n\n\n\n\n\n\n\n\n\n\n/*\n * \n * \n * \n *          misc helpers and implementation functions\n * \n * \n * \n*/\n\n\nfunction sortIDListByDistanceFrom(list, i, j, k) {\n    list.sort(id => {\n        var pos = parseChunkID(id)\n        var dx = pos[0] - i\n        var dy = pos[1] - j\n        var dz = pos[2] - k\n        // bias towards keeping verticals together for now\n        return (dx * dx + dz * dz) + Math.abs(dy)\n    })\n}\n\n\n// keep neighbor data updated when chunk is added or removed\nfunction updateNeighborsOfChunk(world, ci, cj, ck, chunk) {\n    for (var i = -1; i <= 1; i++) {\n        for (var j = -1; j <= 1; j++) {\n            for (var k = -1; k <= 1; k++) {\n                if ((i | j | k) === 0) continue\n                var nid = getChunkID(ci + i, cj + j, ck + k)\n                var neighbor = world._chunkStorage[nid]\n                if (!neighbor) continue\n                if (chunk) {\n                    chunk._neighborCount++\n                    chunk._neighbors.set(i, j, k, neighbor)\n                    neighbor._neighborCount++\n                    neighbor._neighbors.set(-i, -j, -k, chunk)\n                    // flag for remesh when chunk gets its last neighbor\n                    if (neighbor._neighborCount === 26) {\n                        queueChunkForRemesh(world, neighbor)\n                    }\n                } else {\n                    neighbor._neighborCount--\n                    neighbor._neighbors.set(-i, -j, -k, null)\n                }\n            }\n        }\n    }\n}\n\n\n\n\n\n\n\n\n/*\n * \n * \n * \n * \n *                  debugging\n * \n * \n * \n * \n*/\n\nWorld.prototype.report = function () {\n    console.log('World report - playerChunkLoaded: ', this.playerChunkLoaded)\n    _report(this, '  known:     ', this._chunkIDsKnown.arr, true)\n    _report(this, '  to request:', this._chunkIDsToRequest.arr)\n    _report(this, '  to remove: ', this._chunkIDsToRemove.arr)\n    _report(this, '  creating:  ', this._chunkIDsPending.arr)\n    _report(this, '  to mesh:   ', this._chunkIDsToMesh.arr.concat(this._chunkIDsToMeshFirst.arr))\n}\n\nfunction _report(world, name, arr, ext) {\n    var full = 0,\n        empty = 0,\n        exist = 0,\n        surrounded = 0,\n        remeshes = []\n    arr.forEach(id => {\n        var chunk = world._chunkStorage[id]\n        if (!chunk) return\n        exist++\n        remeshes.push(chunk._timesMeshed)\n        if (chunk.isFull) full++\n        if (chunk.isEmpty) empty++\n        if (chunk._neighborCount === 26) surrounded++\n    })\n    var out = arr.length.toString().padEnd(8)\n    out += ('exist: ' + exist).padEnd(12)\n    out += ('full: ' + full).padEnd(12)\n    out += ('empty: ' + empty).padEnd(12)\n    out += ('surr: ' + surrounded).padEnd(12)\n    if (ext) {\n        var sum = remeshes.reduce((acc, val) => acc + val, 0)\n        var max = remeshes.reduce((acc, val) => Math.max(acc, val), 0)\n        var min = remeshes.reduce((acc, val) => Math.min(acc, val), 0)\n        out += 'times meshed: avg ' + (sum / exist).toFixed(2)\n        out += '  max ' + max\n        out += '  min ' + min\n    }\n    console.log(name, out)\n}\n\n\nimport { makeProfileHook } from './util'\nvar profile_hook = (PROFILE) ?\n    makeProfileHook(100, 'world ticks:') : () => { }\nvar profile_queues_hook = () => { }\nif (PROFILE_QUEUES) profile_queues_hook = ((every) => {\n    var iter = 0\n    var counts = {}\n    var queues = {}\n    var started = performance.now()\n    return function profile_queues_hook(state, world) {\n        if (state === 'start') return\n        if (state !== 'end') return counts[state] = (counts[state] || 0) + 1\n        queues.toreq = (queues.toreq || 0) + world._chunkIDsToRequest.count()\n        queues.toget = (queues.toget || 0) + world._chunkIDsPending.count()\n        queues.tomesh = (queues.tomesh || 0) + world._chunkIDsToMesh.count() + world._chunkIDsToMeshFirst.count()\n        queues.tomesh1 = (queues.tomesh1 || 0) + world._chunkIDsToMeshFirst.count()\n        queues.torem = (queues.torem || 0) + world._chunkIDsToRemove.count()\n        if (++iter < every) return\n        var t = performance.now(), dt = t - started\n        var res = {}\n        Object.keys(queues).forEach(k => {\n            var num = Math.round((queues[k] || 0) / iter)\n            res[k] = `[${num}]`.padStart(5)\n        })\n        Object.keys(counts).forEach(k => {\n            var num = Math.round((counts[k] || 0) * 1000 / dt)\n            res[k] = ('' + num).padStart(3)\n        })\n        console.log('chunk flow: ',\n            `${res.toreq}-> ${res.request} req/s  `,\n            `${res.toget}-> ${res.receive} got/s  `,\n            `${(res.tomesh)}-> ${res.mesh} mesh/s  `,\n            `${res.torem}-> ${res.dispose} rem/s  `,\n            `(meshFirst: ${res.tomesh1.trim()})`,\n        )\n        iter = 0\n        counts = {}\n        queues = {}\n        started = performance.now()\n    }\n})(100)","\nvar createInputs = require('game-inputs')\n// var createInputs = require('../../../../npm-modules/game-inputs')\n\n\nexport default function (noa, opts, element) {\n    return makeInputs(noa, opts, element)\n}\n\n\n/**\n * @class Inputs\n * @typicalname noa.inputs\n * @classdesc Abstracts key/mouse input. \n * For docs see [andyhall/game-inputs](https://github.com/andyhall/game-inputs)\n */\n\n\nvar defaultBindings = {\n    bindings: {\n        \"forward\": [\"W\", \"<up>\"],\n        \"left\": [\"A\", \"<left>\"],\n        \"backward\": [\"S\", \"<down>\"],\n        \"right\": [\"D\", \"<right>\"],\n        \"fire\": \"<mouse 1>\",\n        \"mid-fire\": [\"<mouse 2>\", \"Q\"],\n        \"alt-fire\": [\"<mouse 3>\", \"E\"],\n        \"jump\": \"<space>\",\n        \"sprint\": \"<shift>\",\n        \"crouch\": \"<control>\"\n    }\n}\n\n\nfunction makeInputs(noa, opts, element) {\n    opts = Object.assign({}, defaultBindings, opts)\n    var inputs = createInputs(element, opts)\n    var b = opts.bindings\n    for (var name in b) {\n        var arr = (Array.isArray(b[name])) ? b[name] : [b[name]]\n        arr.unshift(name)\n        inputs.bind.apply(inputs, arr)\n    }\n    return inputs\n}\n","\nvar createPhysics = require('voxel-physics-engine')\n// var createPhysics = require('../../../../npm-modules/voxel-physics-engine')\n\n\nexport default function (noa, opts) {\n    return makePhysics(noa, opts)\n}\n\n\n/**\n * @class Physics\n * @typicalname noa.physics\n * @classdesc Wrapper module for the physics engine. For docs see \n * [andyhall/voxel-physics-engine](https://github.com/andyhall/voxel-physics-engine)\n */\n\n\nvar defaults = {\n    gravity: [0, -10, 0],\n    airDrag: 0.1,\n}\n\n\nfunction makePhysics(noa, opts) {\n    opts = Object.assign({}, defaults, opts)\n    var world = noa.world\n    var solidLookup = noa.registry._solidityLookup\n    var fluidLookup = noa.registry._fluidityLookup\n    \n    // physics engine runs in offset coords, so voxel getters need to match\n    var offset = noa.worldOriginOffset\n\n    var blockGetter = (x, y, z) => {\n        var id = world.getBlockID(x + offset[0], y + offset[1], z + offset[2])\n        return solidLookup[id]\n    }\n    var isFluidGetter = (x, y, z) => {\n        var id = world.getBlockID(x + offset[0], y + offset[1], z + offset[2])\n        return fluidLookup[id]\n    }\n\n    var physics = createPhysics(opts, blockGetter, isFluidGetter)\n\n    return physics\n}\n","\nvar vec3 = require('gl-vec3')\nvar aabb = require('aabb-3d')\nvar sweep = require('voxel-aabb-sweep')\n\n\nexport default function (noa, opts) {\n    return new Camera(noa, opts)\n}\n\n\n\n\nvar defaults = {\n    inverseX: false,\n    inverseY: false,\n    sensitivityX: 10,\n    sensitivityY: 10,\n    initialZoom: 0,\n    zoomSpeed: 0.2,\n}\n\n\n/** \n * @class\n * @typicalname noa.camera\n * @classdesc Manages the camera, exposes camera position, direction, mouse sensitivity.\n */\n\n\nfunction Camera(noa, opts) {\n    this.noa = noa\n\n    /**\n     * `noa.camera` uses the following options (from the root `noa(opts)` options):\n     * ```js\n     * {\n     *   inverseX: false,\n     *   inverseY: false,\n     *   sensitivityX: 15,\n     *   sensitivityY: 15,\n     *   initialZoom: 0,\n     *   zoomSpeed: 0.2,\n     * }\n     * ```\n     */\n    opts = Object.assign({}, defaults, opts)\n\n    /** Horizontal mouse sensitivity. \n     * Same scale as Overwatch (typical values around `5..10`)\n     */\n    this.sensitivityX = opts.sensitivityX\n\n    /** Vertical mouse sensitivity.\n     * Same scale as Overwatch (typical values around `5..10`)\n     */\n    this.sensitivityY = opts.sensitivityY\n\n    /** Mouse look inverse (horizontal) */\n    this.inverseX = opts.inverseX\n\n    /** Mouse look inverse (vertical) */\n    this.inverseY = opts.inverseY\n\n\n    /** Camera yaw angle (read only) \n     * \n     * Returns the camera's rotation angle around the vertical axis. Range: `0..2π`\n     */\n    this.heading = 0\n\n    /** Camera pitch angle (read only)\n     * \n     * Returns the camera's up/down rotation angle. Range: `-π/2..π/2`. \n     * (The pitch angle is clamped by a small epsilon, such that \n     * the camera never quite points perfectly up or down.\n     */\n    this.pitch = 0\n\n\n    /** Entity ID of a special entity that exists for the camera to point at.\n     * \n     * By default this entity follows the player entity, so you can \n     * change the player's eye height by changing the `follow` component's offset:\n     * ```js\n     * var followState = noa.ents.getState(noa.camera.cameraTarget, 'followsEntity')\n     * followState.offset[1] = 0.9 * myPlayerHeight\n     * ```\n     * \n     * For customized camera controls you can change the follow \n     * target to some other entity, or override the behavior entirely:\n     * ```js\n     * // make cameraTarget stop following the player\n     * noa.ents.removeComponent(noa.camera.cameraTarget, 'followsEntity')\n     * // control cameraTarget position directly (or whatever..)\n     * noa.ents.setPosition(noa.camera.cameraTarget, [x,y,z])\n     * ```\n     */\n    this.cameraTarget = this.noa.ents.createEntity(['position'])\n\n    // follow component and default offset\n    var eyeOffset = 0.9 * noa.ents.getPositionData(noa.playerEntity).height\n    noa.ents.addComponent(this.cameraTarget, 'followsEntity', {\n        entity: noa.playerEntity,\n        offset: [0, eyeOffset, 0],\n    })\n\n    /** How far back the camera is zoomed from the camera target */\n    this.zoomDistance = opts.initialZoom\n\n    /** How quickly the camera moves to its `zoomDistance` (0..1) */\n    this.zoomSpeed = opts.zoomSpeed\n\n    /** Current actual zoom distance. This differs from `zoomDistance` when\n     * the camera is in the process of moving towards the desired distance, \n     * or when it's obstructed by solid terrain behind the player. */\n    this.currentZoom = opts.initialZoom\n\n    // internals\n    this._dirVector = vec3.fromValues(0, 1, 0)\n}\n\n\n/*\n * \n *  Local position functions for high precision\n * \n */\nCamera.prototype._localGetTargetPosition = function () {\n    var pdat = this.noa.ents.getPositionData(this.cameraTarget)\n    return vec3.copy(_camPos, pdat._renderPosition)\n}\n\nCamera.prototype._localGetPosition = function () {\n    var loc = this._localGetTargetPosition()\n    if (this.currentZoom === 0) return loc\n    return vec3.scaleAndAdd(loc, loc, this._dirVector, -this.currentZoom)\n}\nvar _camPos = vec3.create()\n\n\n\n\n/**\n * Camera target position (read only)\n * \n * This returns the point the camera looks at - i.e. the player's \n * eye position. When the camera is zoomed \n * all the way in, this is equivalent to `camera.getPosition()`.\n */\nCamera.prototype.getTargetPosition = function () {\n    var loc = this._localGetTargetPosition()\n    return this.noa.localToGlobal(loc, globalCamPos)\n}\nvar globalCamPos = []\n\n/**\n * Returns the current camera position (read only)\n */\nCamera.prototype.getPosition = function () {\n    var loc = this._localGetPosition()\n    return this.noa.localToGlobal(loc, globalCamPos)\n}\n\n\n\n/**\n * Returns the camera direction vector (read only)\n */\nCamera.prototype.getDirection = function () {\n    return this._dirVector\n}\n\n\n\n\n\n/*\n * \n * \n * \n *          internals below\n * \n * \n * \n */\n\n\n/*\n *  Called before render, if mouseLock etc. is applicable.\n *  Consumes input mouse events x/y, updates camera angle and zoom\n */\n\nCamera.prototype.applyInputsToCamera = function () {\n    // dx/dy from input state\n    var state = this.noa.inputs.state\n    bugFix(state) // TODO: REMOVE EVENTUALLY    \n\n    // convert to rads, using (sens * 0.0066 deg/pixel), like Overwatch\n    var conv = 0.0066 * Math.PI / 180\n    var dy = state.dy * this.sensitivityY * conv\n    var dx = state.dx * this.sensitivityX * conv\n    if (this.inverseY) dy = -dy\n    if (this.inverseX) dx = -dx\n\n    // normalize/clamp angles, update direction vector\n    var twopi = 2 * Math.PI\n    this.heading += (dx < 0) ? dx + twopi : dx\n    if (this.heading > twopi) this.heading -= twopi\n    var maxPitch = Math.PI / 2 - 0.001\n    this.pitch = Math.max(-maxPitch, Math.min(maxPitch, this.pitch + dy))\n\n    vec3.set(this._dirVector, 0, 0, 1)\n    vec3.rotateX(this._dirVector, this._dirVector, origin, this.pitch)\n    vec3.rotateY(this._dirVector, this._dirVector, origin, this.heading)\n}\nvar origin = vec3.create()\n\n\n\n/*\n *  Called before all renders, pre- and post- entity render systems\n */\n\nCamera.prototype.updateBeforeEntityRenderSystems = function () {\n    // zoom update\n    this.currentZoom += (this.zoomDistance - this.currentZoom) * this.zoomSpeed\n}\n\nCamera.prototype.updateAfterEntityRenderSystems = function () {\n    // clamp camera zoom not to clip into solid terrain\n    var maxZoom = cameraObstructionDistance(this)\n    if (this.currentZoom > maxZoom) this.currentZoom = maxZoom\n}\n\n\n\n\n\n\n/*\n *  check for obstructions behind camera by sweeping back an AABB\n */\n\nfunction cameraObstructionDistance(self) {\n    if (!_camBox) {\n        var off = self.noa.worldOriginOffset\n        _camBox = new aabb([0, 0, 0], vec3.clone(_camBoxVec))\n        _getVoxel = (x, y, z) => self.noa.world.getBlockSolidity(x + off[0], y + off[1], z + off[2])\n        vec3.scale(_camBoxVec, _camBoxVec, -0.5)\n    }\n    _camBox.setPosition(self._localGetTargetPosition())\n    _camBox.translate(_camBoxVec)\n    var dist = Math.max(self.zoomDistance, self.currentZoom) + 0.1\n    vec3.scale(_sweepVec, self.getDirection(), -dist)\n    return sweep(_getVoxel, _camBox, _sweepVec, _hitFn, true)\n}\n\nvar _camBoxVec = vec3.fromValues(0.2, 0.2, 0.2)\nvar _sweepVec = vec3.create()\nvar _camBox\nvar _getVoxel\nvar _hitFn = () => true\n\n\n\n\n\n\n// workaround for this Chrome 63 + Win10 bug\n// https://bugs.chromium.org/p/chromium/issues/detail?id=781182\nfunction bugFix(state) {\n    var dx = state.dx\n    var dy = state.dy\n    var wval = document.body.clientWidth / 6\n    var hval = document.body.clientHeight / 6\n    var badx = (Math.abs(dx) > wval && (dx / lastx) < -1)\n    var bady = (Math.abs(dy) > hval && (dy / lasty) < -1)\n    if (badx || bady) {\n        state.dx = lastx\n        state.dy = lasty\n        lastx = (dx > 0) ? 1 : -1\n        lasty = (dy > 0) ? 1 : -1\n    } else {\n        if (dx) lastx = dx\n        if (dy) lasty = dy\n    }\n}\n\nvar lastx = 0\nvar lasty = 0\n","\n\nexport default function (noa, opts) {\n    return new Registry(noa, opts)\n}\n\n\n\n/*\n *  data structs in the registry:\n *  registry \n *      blockSolidity:     id -> boolean\n *      blockOpacity:      id -> boolean\n *      blockIsFluid:      id -> boolean\n *      blockMats:         id -> 6x matID  [-x, +x, -y, +y, -z, +z]\n *      blockProps         id -> obj of less-often accessed properties\n *      blockMeshes:       id -> obj/null (custom mesh to instantiate)\n *      blockHandlers      id -> instance of `BlockCallbackHolder` or null \n *      matIDs             matName -> matID (int)\n *      matData            matID -> { color, alpha, texture, textureAlpha }\n */\n\n\nvar defaults = {\n    texturePath: ''\n}\n\nvar blockDefaults = {\n    solid: true,\n    opaque: true,\n    fluidDensity: 1.0,\n    viscosity: 0.5,\n}\n\n\n// voxel ID now uses the whole Uint16Array element\nvar MAX_BLOCK_ID = (1 << 16) - 1\n\n\n/**\n * @class\n * @typicalname noa.registry\n * @classdesc for registering block types, materials & properties\n */\n\n\nfunction Registry(noa, opts) {\n    this.noa = noa\n    opts = Object.assign({}, defaults, opts)\n\n\n    /* \n     * \n     *      data structures\n     * \n     */\n\n    // lookup arrays for block props and flags - all keyed by blockID\n    // fill in first value for id=0, empty space\n    var blockSolidity = [false]\n    var blockOpacity = [false]\n    var blockIsFluid = [false]\n    var blockIsObject = [false]\n    var blockMats = [0, 0, 0, 0, 0, 0]\n    var blockProps = [null]\n    var blockMeshes = [null]\n    var blockHandlers = [null]\n\n    // material data structs\n    var matIDs = {} // mat name -> id\n    var matData = [null] // mat id -> { color, alpha, texture, textureAlpha }\n\n    // option data to save\n    var texturePath = opts.texturePath\n\n\n\n    /* \n     * \n     *      Block registration methods\n     * \n     */\n\n\n\n    /**\n     * Register (by integer ID) a block type and its parameters.\n     * \n     *  `id` param: integer, currently 1..255. This needs to be passed in by the \n     *    client because it goes into the chunk data, which someday will get serialized.\n     * \n     *  `options` param: Recognized fields for the options object:\n     * \n     *  * material: can be:\n     *      * one (String) material name\n     *      * array of 2 names: [top/bottom, sides]\n     *      * array of 3 names: [top, bottom, sides]\n     *      * array of 6 names: [-x, +x, -y, +y, -z, +z]\n     *    If not specified, terrain won't be meshed for the block type\n     *  * solid: (true) solidity for physics purposes\n     *  * opaque: (true) fully obscures neighboring blocks\n     *  * fluid: (false) whether nonsolid block is a fluid (buoyant, viscous..)\n     *  * blockMesh: (null) if specified, noa will create a copy this mesh in the voxel\n     *  * fluidDensity: (1.0) for fluid blocks\n     *  * viscosity: (0.5) for fluid blocks\n     *  * onLoad(): block event handler\n     *  * onUnload(): block event handler\n     *  * onSet(): block event handler\n     *  * onUnset(): block event handler\n     *  * onCustomMeshCreate(): block event handler\n     */\n\n    this.registerBlock = function (id, _options) {\n        _options = _options || {}\n        blockDefaults.solid = !_options.fluid\n        blockDefaults.opaque = !_options.fluid\n        var opts = Object.assign({}, blockDefaults, _options)\n\n        // console.log('register block: ', id, opts)\n        if (id < 1 || id > MAX_BLOCK_ID) throw 'Block id out of range: ' + id\n\n        // if block ID is greater than current highest ID, \n        // register fake blocks to avoid holes in lookup arrays\n        while (id > blockSolidity.length) {\n            this.registerBlock(blockSolidity.length, {})\n        }\n\n        // flags default to solid, opaque, nonfluid\n        blockSolidity[id] = !!opts.solid\n        blockOpacity[id] = !!opts.opaque\n        blockIsFluid[id] = !!opts.fluid\n\n        // store any custom mesh\n        blockIsObject[id] = !!opts.blockMesh\n        blockMeshes[id] = opts.blockMesh || null\n\n        // parse out material parameter\n        // always store 6 material IDs per blockID, so material lookup is monomorphic\n        var mat = opts.material || null\n        var mats\n        if (!mat) {\n            mats = [null, null, null, null, null, null]\n        } else if (typeof mat == 'string') {\n            mats = [mat, mat, mat, mat, mat, mat]\n        } else if (mat.length && mat.length == 2) {\n            // interpret as [top/bottom, sides]\n            mats = [mat[1], mat[1], mat[0], mat[0], mat[1], mat[1]]\n        } else if (mat.length && mat.length == 3) {\n            // interpret as [top, bottom, sides]\n            mats = [mat[2], mat[2], mat[0], mat[1], mat[2], mat[2]]\n        } else if (mat.length && mat.length == 6) {\n            // interpret as [-x, +x, -y, +y, -z, +z]\n            mats = mat\n        } else throw 'Invalid material parameter: ' + mat\n\n        // argument is material name, but store as material id, allocating one if needed\n        for (var i = 0; i < 6; ++i) {\n            blockMats[id * 6 + i] = getMaterialId(this, matIDs, mats[i], true)\n        }\n\n        // props data object - currently only used for fluid properties\n        blockProps[id] = {}\n\n        // if block is fluid, initialize properties if needed\n        if (blockIsFluid[id]) {\n            blockProps[id].fluidDensity = opts.fluidDensity\n            blockProps[id].viscosity = opts.viscosity\n        }\n\n        // event callbacks\n        var hasHandler = opts.onLoad || opts.onUnload || opts.onSet || opts.onUnset || opts.onCustomMeshCreate\n        blockHandlers[id] = (hasHandler) ? new BlockCallbackHolder(opts) : null\n\n        return id\n    }\n\n\n\n\n    /**\n     * Register (by name) a material and its parameters.\n     * \n     * @param name\n     * @param color\n     * @param textureURL\n     * @param texHasAlpha\n     * @param renderMaterial an optional BABYLON material to be used for block faces with this block material\n     */\n\n    this.registerMaterial = function (name, color, textureURL, texHasAlpha, renderMaterial) {\n        // console.log('register mat: ', name, color, textureURL)\n        var id = matIDs[name] || matData.length\n        matIDs[name] = id\n        var alpha = 1\n        if (color && color.length == 4) {\n            alpha = color.pop()\n        }\n        matData[id] = {\n            color: color || [1, 1, 1],\n            alpha: alpha,\n            texture: textureURL ? texturePath + textureURL : '',\n            textureAlpha: !!texHasAlpha,\n            renderMat: renderMaterial || null,\n        }\n        return id\n    }\n\n\n\n    /*\n     *      quick accessors for querying block ID stuff\n     */\n\n    /** \n     * block solidity (as in physics) \n     * @param id\n     */\n    this.getBlockSolidity = function (id) {\n        return blockSolidity[id]\n    }\n\n    /**\n     * block opacity - whether it obscures the whole voxel (dirt) or \n     * can be partially seen through (like a fencepost, etc)\n     * @param id\n     */\n    this.getBlockOpacity = function (id) {\n        return blockOpacity[id]\n    }\n\n    /** \n     * block is fluid or not\n     * @param id\n     */\n    this.getBlockFluidity = function (id) {\n        return blockIsFluid[id]\n    }\n\n    /** \n     * Get block property object passed in at registration\n     * @param id\n     */\n    this.getBlockProps = function (id) {\n        return blockProps[id]\n    }\n\n    // look up a block ID's face material\n    // dir is a value 0..5: [ +x, -x, +y, -y, +z, -z ]\n    this.getBlockFaceMaterial = function (blockId, dir) {\n        return blockMats[blockId * 6 + dir]\n    }\n\n\n\n\n\n    // look up material color given ID\n    this.getMaterialColor = function (matID) {\n        return matData[matID].color\n    }\n\n    // look up material texture given ID\n    this.getMaterialTexture = function (matID) {\n        return matData[matID].texture\n    }\n\n    // look up material's properties: color, alpha, texture, textureAlpha\n    this.getMaterialData = function (matID) {\n        return matData[matID]\n    }\n\n\n\n\n\n    /*\n     * \n     *   Meant for internal use within the engine\n     * \n     */\n\n\n    // internal access to lookup arrays\n    this._solidityLookup = blockSolidity\n    this._opacityLookup = blockOpacity\n    this._fluidityLookup = blockIsFluid\n    this._objectLookup = blockIsObject\n    this._blockMeshLookup = blockMeshes\n    this._blockHandlerLookup = blockHandlers\n\n\n\n\n\n\n    // look up color used for vertices of blocks of given material\n    // - i.e. white if it has a texture, color otherwise\n    this._getMaterialVertexColor = function (matID) {\n        if (matData[matID].texture) return white\n        return matData[matID].color\n    }\n    var white = [1, 1, 1]\n\n\n\n\n\n    /*\n     * \n     *      default initialization\n     * \n     */\n\n    // add a default material and set ID=1 to it\n    // note that registering new block data overwrites the old\n    this.registerMaterial('dirt', [0.4, 0.3, 0], null)\n    this.registerBlock(1, { material: 'dirt' })\n\n\n\n}\n\n\n\n/*\n * \n *          helpers\n * \n */\n\n\n\n// look up material ID given its name\n// if lazy is set, pre-register the name and return an ID\nfunction getMaterialId(reg, matIDs, name, lazyInit) {\n    if (!name) return 0\n    var id = matIDs[name]\n    if (id === undefined && lazyInit) id = reg.registerMaterial(name)\n    return id\n}\n\n\n\n// data class for holding block callback references\nfunction BlockCallbackHolder(opts) {\n    this.onLoad = opts.onLoad || null\n    this.onUnload = opts.onUnload || null\n    this.onSet = opts.onSet || null\n    this.onUnset = opts.onUnset || null\n    this.onCustomMeshCreate = opts.onCustomMeshCreate || null\n}\n","\nvar vec3 = require('gl-vec3')\nvar EntComp = require('ent-comp')\n// var EntComp = require('../../../../npm-modules/ent-comp')\n\n\nimport { updatePositionExtents } from '../components/position'\nimport { setPhysicsFromPosition } from '../components/physics'\n\n\n\nexport default function (noa, opts) {\n    return new Entities(noa, opts)\n}\n\n\n\nvar defaults = {\n    shadowDistance: 10,\n}\n\n\n/**\n * @class Entities\n * @typicalname noa.ents\n * @classdesc Wrangles entities. Aliased as `noa.ents`.\n * \n * This class is an instance of [ECS](https://github.com/andyhall/ent-comp), \n * and as such implements the usual ECS methods.\n * It's also decorated with helpers and accessor functions for getting component existence/state.\n * \n * Expects entity definitions in a specific format - see source `components` folder for examples.\n */\n\nfunction Entities(noa, opts) {\n    // inherit from the ECS library\n    EntComp.call(this)\n\n    this.noa = noa\n    opts = Object.assign({}, defaults, opts)\n\n    // properties\n    /** Hash containing the component names of built-in components. */\n    this.names = {}\n\n    // optional arguments to supply to component creation functions\n    var componentArgs = {\n        'shadow': opts.shadowDistance,\n    }\n\n    // Bundler magic to import everything in the ../components directory\n    // each component module exports a default function: (noa) => compDefinition\n    var reqContext = require.context('../components/', false, /\\.js$/)\n    reqContext.keys().forEach(name => {\n        // convert name ('./foo.js') to bare name ('foo')\n        var bareName = /\\.\\/(.*)\\.js/.exec(name)[1]\n        var arg = componentArgs[bareName] || undefined\n        var compFn = reqContext(name)\n        if (compFn.default) compFn = compFn.default\n        var compDef = compFn(noa, arg)\n        var comp = this.createComponent(compDef)\n        this.names[bareName] = comp\n    })\n\n\n    // decorate the entities object with accessor functions\n    /** @param id */\n    this.isPlayer = function (id) { return id === noa.playerEntity }\n\n    /** @param id */\n    this.hasPhysics = this.getComponentAccessor(this.names.physics)\n\n    /** @param id */\n    this.cameraSmoothed = this.getComponentAccessor(this.names.smoothCamera)\n\n    /** @param id */\n    this.hasMesh = this.getComponentAccessor(this.names.mesh)\n\n    // position functions\n    /** @param id */\n    this.hasPosition = this.getComponentAccessor(this.names.position)\n    var getPos = this.getStateAccessor(this.names.position)\n\n    /** @param id */\n    this.getPositionData = getPos\n\n    /** @param id */\n    this._localGetPosition = function (id) {\n        return getPos(id)._localPosition\n    }\n\n    /** @param id */\n    this.getPosition = function (id) {\n        return getPos(id).position\n    }\n\n    /** @param id */\n    this._localSetPosition = function (id, pos) {\n        var posDat = getPos(id)\n        vec3.copy(posDat._localPosition, pos)\n        updateDerivedPositionData(id, posDat)\n    }\n\n    /** @param id, positionArr */\n    this.setPosition = (id, pos, _yarg, _zarg) => {\n        // check if called with \"x, y, z\" args\n        if (typeof pos === 'number') pos = [pos, _yarg, _zarg]\n        // convert to local and defer impl\n        var loc = noa.globalToLocal(pos, null, [])\n        this._localSetPosition(id, loc)\n    }\n\n    /** @param id, xs, ys, zs */\n    this.setEntitySize = function (id, xs, ys, zs) {\n        var posDat = getPos(id)\n        posDat.width = (xs + zs) / 2\n        posDat.height = ys\n        updateDerivedPositionData(id, posDat)\n    }\n\n    // called when engine rebases its local coords\n    this._rebaseOrigin = function (delta) {\n        this.getStatesList(this.names.position).forEach(state => {\n            vec3.subtract(state._localPosition, state._localPosition, delta)\n            updateDerivedPositionData(state.__id, state)\n        })\n    }\n\n    // helper to update everything derived from `_localPosition`\n    function updateDerivedPositionData(id, posDat) {\n        vec3.copy(posDat._renderPosition, posDat._localPosition)\n        vec3.add(posDat.position, posDat._localPosition, noa.worldOriginOffset)\n        updatePositionExtents(posDat)\n        var physDat = getPhys(id)\n        if (physDat) setPhysicsFromPosition(physDat, posDat)\n    }\n\n\n\n    // physics\n    var getPhys = this.getStateAccessor(this.names.physics)\n    this.getPhysics = getPhys\n    this.getPhysicsBody = function (id) { return getPhys(id).body }\n\n    // misc\n    this.getMeshData = this.getStateAccessor(this.names.mesh)\n    this.getMovement = this.getStateAccessor(this.names.movement)\n    this.getCollideTerrain = this.getStateAccessor(this.names.collideTerrain)\n    this.getCollideEntities = this.getStateAccessor(this.names.collideEntities)\n\n    // pairwise collideEntities event - this is for client to override\n    this.onPairwiseEntityCollision = function (id1, id2) {}\n}\n\n// inherit from EntComp\nEntities.prototype = Object.create(EntComp.prototype)\nEntities.prototype.constructor = Entities\n\n\n\n\n/*\n *\n *    ENTITY MANAGER API\n * \n *  note most APIs are on the original ECS module (ent-comp)\n *  these are some overlaid extras for noa\n *\n */\n\n\n/** @param id,name,state */\nEntities.prototype.addComponentAgain = function (id, name, state) {\n    // removes component first if necessary\n    if (this.hasComponent(id, name)) this.removeComponent(id, name, true)\n    this.addComponent(id, name, state)\n}\n\n\n/** @param x,y,z */\nEntities.prototype.isTerrainBlocked = function (x, y, z) {\n    // checks if terrain location is blocked by entities\n    var off = this.noa.worldOriginOffset\n    var xlocal = Math.floor(x - off[0])\n    var ylocal = Math.floor(y - off[1])\n    var zlocal = Math.floor(z - off[2])\n    var blockExt = [\n        xlocal + 0.001, ylocal + 0.001, zlocal + 0.001,\n        xlocal + 0.999, ylocal + 0.999, zlocal + 0.999,\n    ]\n    var list = this.getStatesList(this.names.collideTerrain)\n    for (var i = 0; i < list.length; i++) {\n        var id = list[i].__id\n        var ext = this.getPositionData(id)._extents\n        if (extentsOverlap(blockExt, ext)) return true\n    }\n    return false\n}\n\n\n\nfunction extentsOverlap(extA, extB) {\n    if (extA[0] > extB[3]) return false\n    if (extA[1] > extB[4]) return false\n    if (extA[2] > extB[5]) return false\n    if (extA[3] < extB[0]) return false\n    if (extA[4] < extB[1]) return false\n    if (extA[5] < extB[2]) return false\n    return true\n}\n\n\n\n\n/** @param box */\nEntities.prototype.getEntitiesInAABB = function (box, withComponent) {\n    // extents to test against\n    var off = this.noa.worldOriginOffset\n    var testExtents = [\n        box.base[0] + off[0], box.base[1] + off[1], box.base[2] + off[2],\n        box.max[0] + off[0], box.max[1] + off[1], box.max[2] + off[2],\n    ]\n    // entity position state list\n    var entStates = (withComponent) ?\n        this.getStatesList(withComponent).map(state => {\n            return this.getPositionData(state.__id)\n        }) : this.getStatesList(this.names.position)\n    // run each test\n    var hits = []\n    entStates.forEach(state => {\n        if (extentsOverlap(testExtents, state._extents)) {\n            hits.push(state.__id)\n        }\n    })\n    return hits\n}\n\n\n\n/** \n * Helper to set up a general entity, and populate with some common components depending on arguments.\n * \n * Parameters: position, width, height [, mesh, meshOffset, doPhysics, shadow]\n * \n * @param position\n * @param width\n * @param height..\n */\nEntities.prototype.add = function (position, width, height, // required\n    mesh, meshOffset, doPhysics, shadow) {\n\n    var self = this\n\n    // new entity\n    var eid = this.createEntity()\n\n    // position component\n    this.addComponent(eid, this.names.position, {\n        position: position || [0, 0, 0],\n        width: width,\n        height: height\n    })\n\n    // rigid body in physics simulator\n    if (doPhysics) {\n        // body = this.noa.physics.addBody(box)\n        this.addComponent(eid, this.names.physics)\n        var body = this.getPhysicsBody(eid)\n\n        // handler for physics engine to call on auto-step\n        var smoothName = this.names.smoothCamera\n        body.onStep = function () {\n            self.addComponentAgain(eid, smoothName)\n        }\n    }\n\n    // mesh for the entity\n    if (mesh) {\n        if (!meshOffset) meshOffset = vec3.create()\n        this.addComponent(eid, this.names.mesh, {\n            mesh: mesh,\n            offset: meshOffset\n        })\n    }\n\n    // add shadow-drawing component\n    if (shadow) {\n        this.addComponent(eid, this.names.shadow, { size: width })\n    }\n\n    return eid\n}\n","/*!\n * noa: an experimental voxel game engine.\n * @url      github.com/andyhall/noa\n * @author   Andy Hall <andy@fenomas.com>\n * @license  MIT\n */\n\nvar vec3 = require('gl-vec3')\nvar ndarray = require('ndarray')\nvar raycast = require('fast-voxel-raycast')\nvar EventEmitter = require('events').EventEmitter\n\nimport createContainer from './lib/container'\nimport createRendering from './lib/rendering'\nimport createWorld from './lib/world'\nimport createInputs from './lib/inputs'\nimport createPhysics from './lib/physics'\nimport createCamera from './lib/camera'\nimport createRegistry from './lib/registry'\nimport createEntities from './lib/entities'\n\n\n\n\nexport default Engine\n\n\n// profiling flags\nvar PROFILE = 0\nvar PROFILE_RENDER = 0\n\n\n\n\nvar defaults = {\n    debug: false,\n    silent: false,\n    playerHeight: 1.8,\n    playerWidth: 0.6,\n    playerStart: [0, 10, 0],\n    playerAutoStep: false,\n    tickRate: 33, // ms per tick - not ticks per second\n    blockTestDistance: 10,\n    stickyPointerLock: true,\n    dragCameraOutsidePointerLock: true,\n    skipDefaultHighlighting: false,\n    originRebaseDistance: 25,\n}\n\n\n/**\n * Main engine object.\n * Takes a big options object full of flags and settings as a parameter.\n * \n * ```js\n * var opts = {\n *     debug: false,\n *     silent: false,\n *     playerHeight: 1.8,\n *     playerWidth: 0.6,\n *     playerStart: [0, 10, 0],\n *     playerAutoStep: false,\n *     tickRate: 33, // ms per tick - not ticks per second\n *     blockTestDistance: 10,\n *     stickyPointerLock: true,\n *     dragCameraOutsidePointerLock: true,\n *     skipDefaultHighlighting: false,\n *     originRebaseDistance: 25,\n * }\n * var NoaEngine = require('noa-engine')\n * var noa = NoaEngine(opts)\n * ```\n * \n * All option parameters are, well, optional. Note that \n * the root `opts` parameter object is also passed to \n * noa's child modules (rendering, camera, etc). \n * See docs for each module for which options they use.\n * \n * @class\n * @alias Noa\n * @typicalname noa\n * @emits tick(dt)\n * @emits beforeRender(dt)\n * @emits afterRender(dt)\n * @emits targetBlockChanged(blockDesc)\n * @classdesc Root class of the noa engine\n * \n * Extends: `EventEmitter`\n */\n\nfunction Engine(opts) {\n    if (!(this instanceof Engine)) return new Engine(opts)\n\n    /**  version string, e.g. `\"0.25.4\"` */\n    this.version = require('../package.json').version\n\n    opts = Object.assign({}, defaults, opts)\n    this._tickRate = opts.tickRate\n    this._lastRenderTime = 0\n    this._paused = false\n    this._dragOutsideLock = opts.dragCameraOutsidePointerLock\n    var self = this\n\n    if (!opts.silent) {\n        var debugstr = (opts.debug) ? ' (debug)' : ''\n        console.log(`noa-engine v${this.version}${debugstr}`)\n    }\n\n    // world origin offset, used throughout engine for origin rebasing\n    this.worldOriginOffset = [0, 0, 0]\n    this._originRebaseDistance = opts.originRebaseDistance\n\n    // vec3 library used throughout the engine\n    this.vec3 = vec3\n\n    // how far engine is into the current tick. Updated each render.\n    this.positionInCurrentTick = 0\n\n    /** String identifier for the current world. (It's safe to ignore this if\n     * your game doesn't need to swap between levels/worlds.)\n     */\n    this.worldName = 'default'\n\n    /**\n     * container (html/div) manager\n     * @type {Container}\n     */\n    this.container = createContainer(this, opts)\n\n    /**\n     * inputs manager - abstracts key/mouse input\n     * @type {Inputs}\n     */\n    this.inputs = createInputs(this, opts, this.container.element)\n\n    /**\n     * block/item property registry\n     * @type {Registry}\n     */\n    this.registry = createRegistry(this, opts)\n\n    /**\n     * world manager\n     * @type {World}\n     */\n    this.world = createWorld(this, opts)\n\n    /**\n     * Rendering manager\n     * @type {Rendering}\n     */\n    this.rendering = createRendering(this, opts, this.container.canvas)\n\n    /**\n     * physics engine - solves collisions, properties, etc.\n     * @type {Physics}\n     */\n    this.physics = createPhysics(this, opts)\n\n    /** Entity manager / Entity Component System (ECS) \n     * Aliased to `noa.ents` for convenience.\n     * @type {Entities}\n     */\n    this.entities = createEntities(this, opts)\n    this.ents = this.entities\n    var ents = this.ents\n\n    /** Entity id for the player entity */\n    this.playerEntity = ents.add(\n        opts.playerStart, // starting location\n        opts.playerWidth, opts.playerHeight,\n        null, null, // no mesh for now, no meshOffset, \n        true, true\n    )\n\n    // make player entity it collide with terrain and other entities\n    ents.addComponent(this.playerEntity, ents.names.collideTerrain)\n    ents.addComponent(this.playerEntity, ents.names.collideEntities)\n\n    // adjust default physics parameters\n    var body = ents.getPhysicsBody(this.playerEntity)\n    body.gravityMultiplier = 2 // less floaty\n    body.autoStep = opts.playerAutoStep // auto step onto blocks\n\n    // input component - sets entity's movement state from key inputs\n    ents.addComponent(this.playerEntity, ents.names.receivesInputs)\n\n    // add a component to make player mesh fade out when zooming in\n    ents.addComponent(this.playerEntity, ents.names.fadeOnZoom)\n\n    // movement component - applies movement forces\n    // todo: populate movement settings from options\n    var moveOpts = {\n        airJumps: 1\n    }\n    ents.addComponent(this.playerEntity, ents.names.movement, moveOpts)\n\n\n    /**\n     * Manages camera, view angle, etc.\n     * @type {Camera}\n     */\n    this.camera = createCamera(this, opts)\n\n\n    // set up block targeting\n    this.blockTestDistance = opts.blockTestDistance\n\n    /** function for which block IDs are targetable. \n     * Defaults to a solidity check, but can be overridden */\n    this.blockTargetIdCheck = this.registry.getBlockSolidity\n\n    /** Dynamically updated object describing the currently targeted block.\n     * Gets updated each tick, to `null` if not block is targeted, or \n     * to an object like:\n     * \n     *     {\n     *        blockID,   // voxel ID\n     *        position,  // the (solid) block being targeted\n     *        adjacent,  // the (non-solid) block adjacent to the targeted one\n     *        normal,    // e.g. [0, 1, 0] when player is targting the top face of a voxel\n     *     }\n     */\n    this.targetedBlock = null\n\n    // add a default block highlighting function\n    if (!opts.skipDefaultHighlighting) {\n        // the default listener, defined onto noa in case people want to remove it later\n        this.defaultBlockHighlightFunction = function (tgt) {\n            if (tgt) {\n                self.rendering.highlightBlockFace(true, tgt.position, tgt.normal)\n            } else {\n                self.rendering.highlightBlockFace(false)\n            }\n        }\n        this.on('targetBlockChanged', this.defaultBlockHighlightFunction)\n    }\n\n\n    // temp hacks for development\n    if (opts.debug) {\n        window.noa = this\n        window.scene = this.rendering._scene\n        window.ndarray = ndarray\n        window.vec3 = vec3\n        ents.getMovement(1).airJumps = 999\n        this.setViewDistance = function (dist) {\n            var cs = this.world.chunkSize\n            this.world.chunkAddDistance = dist / cs\n            this.world.chunkRemoveDistance = dist / cs + 1\n            this.world._lastPlayerChunkID = '' // pings noa's chunk queues\n        }\n    }\n\n    // add hooks to throw helpful errors when using deprecated methods\n    deprecateStuff(this)\n}\n\nEngine.prototype = Object.create(EventEmitter.prototype)\n\n\n\n\n\n/*\n *\n *\n *   Core Engine API\n *\n *\n */\n\n\n/*\n * Tick function, called by container module at a fixed timestep. Emits #tick(dt),\n * where dt is the tick rate in ms (default 16.6)\n */\n\nEngine.prototype.tick = function () {\n    if (this._paused) {\n        if (this.world.worldGenWhilePaused) this.world.tick(dt)\n        return\n    }\n    profile_hook('start')\n    checkWorldOffset(this)\n    var dt = this._tickRate // fixed timesteps!\n    this.world.tick(dt) // chunk creation/removal\n    profile_hook('world')\n    if (!this.world.playerChunkLoaded) {\n        // when waiting on worldgen, just tick the meshing queue and exit\n        this.rendering.tick(dt)\n        return\n    }\n    this.physics.tick(dt) // iterates physics\n    profile_hook('physics')\n    this.rendering.tick(dt) // does deferred chunk meshing\n    profile_hook('rendering')\n    updateBlockTargets(this) // finds targeted blocks, and highlights one if needed\n    profile_hook('targets')\n    this.entities.tick(dt) // runs all entity systems\n    profile_hook('entities')\n    this.emit('tick', dt)\n    profile_hook('tick event')\n    profile_hook('end')\n    // clear accumulated scroll inputs (mouseMove is cleared on render)\n    var st = this.inputs.state\n    st.scrollx = st.scrolly = st.scrollz = 0\n}\n\n\n\n\n\n/*\n * Render function, called every animation frame. Emits #beforeRender(dt), #afterRender(dt) \n * where dt is the time in ms *since the last tick*.\n */\n\nEngine.prototype.render = function (framePart) {\n    // frame position - for rendering movement between ticks\n    this.positionInCurrentTick = framePart\n    // dt - actual time difference (in ms), for animating things\n    // that aren't tied to game tick rate\n    var t = performance.now()\n    var dt = t - (this._lastRenderTime || (t - 16))\n    this._lastRenderTime = t\n\n    // when paused, just optionally ping worldgen, then exit\n    if (this._paused) {\n        if (this.world.worldGenWhilePaused) this.world.render()\n        return\n    }\n\n    profile_hook_render('start')\n\n    // only move camera during pointerlock or mousedown, or if pointerlock is unsupported\n    if (this.container.hasPointerLock ||\n        !this.container.supportsPointerLock ||\n        (this._dragOutsideLock && this.inputs.state.fire)) {\n        this.camera.applyInputsToCamera()\n    }\n    profile_hook_render('init')\n\n    // brief run through meshing queue\n    this.world.render(dt)\n    profile_hook_render('meshing')\n\n    // entity render systems\n    this.camera.updateBeforeEntityRenderSystems()\n    this.entities.render(dt)\n    this.camera.updateAfterEntityRenderSystems()\n    profile_hook_render('entities')\n\n    // events and render\n    this.emit('beforeRender', dt)\n    profile_hook_render('before render')\n\n    this.rendering.render(dt)\n    profile_hook_render('render')\n\n    this.emit('afterRender', dt)\n    profile_hook_render('after render')\n    profile_hook_render('end')\n\n    // clear accumulated mouseMove inputs (scroll inputs cleared on render)\n    this.inputs.state.dx = this.inputs.state.dy = 0\n}\n\n\n\n\n\n\n\n\n\n/*\n *   Rebasing local <-> global coords\n */\n\n\n/** \n * Precisely converts a world position to the current internal \n * local frame of reference.\n * \n * See `/doc/positions.md` for more info.\n * \n * Params: \n *  * `global`: input position in global coords\n *  * `globalPrecise`: (optional) sub-voxel offset to the global position\n *  * `local`: output array which will receive the result\n */\nEngine.prototype.globalToLocal = function (global, globalPrecise, local) {\n    var off = this.worldOriginOffset\n    if (globalPrecise) {\n        for (var i = 0; i < 3; i++) {\n            var coord = global[i] - off[i]\n            coord += globalPrecise[i]\n            local[i] = coord\n        }\n        return local\n    } else {\n        return vec3.sub(local, global, off)\n    }\n}\n\n/** \n * Precisely converts a world position to the current internal \n * local frame of reference.\n * \n * See `/doc/positions.md` for more info.\n * \n * Params: \n *  * `local`: input array of local coords\n *  * `global`: output array which receives the result\n *  * `globalPrecise`: (optional) sub-voxel offset to the output global position\n * \n * If both output arrays are passed in, `global` will get int values and \n * `globalPrecise` will get fractional parts. If only one array is passed in,\n * `global` will get the whole output position.\n */\nEngine.prototype.localToGlobal = function (local, global, globalPrecise) {\n    var off = this.worldOriginOffset\n    if (globalPrecise) {\n        for (var i = 0; i < 3; i++) {\n            var floored = Math.floor(local[i])\n            global[i] = floored + off[i]\n            globalPrecise[i] = local[i] - floored\n        }\n        return global\n    } else {\n        return vec3.add(global, local, off)\n    }\n}\n\n\n\n\n/*\n * \n *   rebase world origin offset around the player if necessary\n * \n */\nfunction checkWorldOffset(noa) {\n    var lpos = noa.ents.getPositionData(noa.playerEntity)._localPosition\n    var cutoff = noa._originRebaseDistance\n    if (vec3.sqrLen(lpos) < cutoff * cutoff) return\n    var delta = []\n    for (var i = 0; i < 3; i++) {\n        var d = Math.floor(lpos[i])\n        delta[i] = d\n        noa.worldOriginOffset[i] += d\n    }\n    noa.rendering._rebaseOrigin(delta)\n    noa.entities._rebaseOrigin(delta)\n}\n\n\n\n\n\n\n/*\n *   Utility APIs\n */\n\n/** \n * Pausing the engine will also stop render/tick events, etc.\n * @param paused\n */\nEngine.prototype.setPaused = function (paused) {\n    this._paused = !!paused\n    // when unpausing, clear any built-up mouse inputs\n    if (!paused) {\n        this.inputs.state.dx = this.inputs.state.dy = 0\n    }\n}\n\n/** @param x,y,z */\nEngine.prototype.getBlock = function (x, y, z) {\n    if (x.length) {\n        return this.world.getBlockID(x[0], x[1], x[2])\n    } else {\n        return this.world.getBlockID(x, y, z)\n    }\n}\n\n/** @param x,y,z */\nEngine.prototype.setBlock = function (id, x, y, z) {\n    // skips the entity collision check\n    if (x.length) {\n        return this.world.setBlockID(id, x[0], x[1], x[2])\n    } else {\n        return this.world.setBlockID(id, x, y, z)\n    }\n}\n\n/**\n * Adds a block unless obstructed by entities \n * @param id,x,y,z */\nEngine.prototype.addBlock = function (id, x, y, z) {\n    // add a new terrain block, if nothing blocks the terrain there\n    if (x.length) {\n        if (this.entities.isTerrainBlocked(x[0], x[1], x[2])) return\n        this.world.setBlockID(id, x[0], x[1], x[2])\n        return id\n    } else {\n        if (this.entities.isTerrainBlocked(x, y, z)) return\n        this.world.setBlockID(id, x, y, z)\n        return id\n    }\n}\n\n\n\n\n\n\n\n\n/**\n * Raycast through the world, returning a result object for any non-air block\n * @param pos (default: to player eye position)\n * @param vec (default: to camera vector)\n * @param dist (default: `noa.blockTestDistance`)\n * @param blockTestFunction (default: voxel solidity)\n * \n * Returns: `null`, or an object with array properties: `position`, \n * `normal`, `_localPosition`. \n * \n * See `/doc/positions.md` for info on working with precise positions.\n */\nEngine.prototype.pick = function (pos, vec, dist, blockIdTestFunction) {\n    if (dist === 0) return null\n    // input position to local coords, if any\n    if (pos) {\n        this.globalToLocal(pos, null, _pickPos)\n        pos = _pickPos\n    }\n    return this._localPick(pos, vec, dist, blockIdTestFunction)\n}\nvar _pickPos = vec3.create()\n\n\n\n/**\n * Do a raycast in local coords. \n * See `/doc/positions.md` for more info.\n * @param pos\n * @param vec\n * @param dist\n * @param blockTestFunction\n */\n\nEngine.prototype._localPick = function (pos, vec, dist, blockIdTestFunction) {\n    // do a raycast in local coords - result obj will be in global coords\n    if (dist === 0) return null\n    var testFn = blockIdTestFunction || this.registry.getBlockSolidity\n    var world = this.world\n    var off = this.worldOriginOffset\n    var testVoxel = function (x, y, z) {\n        var id = world.getBlockID(x + off[0], y + off[1], z + off[2])\n        return testFn(id)\n    }\n    if (!pos) pos = this.camera._localGetTargetPosition()\n    vec = vec || this.camera.getDirection()\n    dist = dist || this.blockTestDistance\n    var rpos = _hitResult._localPosition\n    var rnorm = _hitResult.normal\n    var hit = raycast(testVoxel, pos, vec, dist, rpos, rnorm)\n    if (!hit) return null\n    // position is right on a voxel border - adjust it so that flooring works reliably\n    // adjust along normal direction, i.e. away from the block struck\n    vec3.scaleAndAdd(rpos, rpos, rnorm, 0.01)\n    // add global result\n    this.localToGlobal(rpos, _hitResult.position)\n    return _hitResult\n}\nvar _hitResult = {\n    _localPosition: vec3.create(),\n    position: [0, 0, 0],\n    normal: [0, 0, 0],\n}\n\n\n\n\n\n\n// Each frame, by default pick along the player's view vector \n// and tell rendering to highlight the struck block face\nfunction updateBlockTargets(noa) {\n    var newhash = ''\n    var blockIdFn = noa.blockTargetIdCheck || noa.registry.getBlockSolidity\n    var result = noa._localPick(null, null, null, blockIdFn)\n    if (result) {\n        var dat = _targetedBlockDat\n        // pick stops just shy of voxel boundary, so floored pos is the adjacent voxel\n        vec3.floor(dat.adjacent, result.position)\n        vec3.copy(dat.normal, result.normal)\n        vec3.sub(dat.position, dat.adjacent, dat.normal)\n        dat.blockID = noa.world.getBlockID(dat.position[0], dat.position[1], dat.position[2])\n        noa.targetedBlock = dat\n        newhash = dat.position.join('|') + dat.normal.join('|') + '|' + dat.blockID\n    } else {\n        noa.targetedBlock = null\n    }\n    if (newhash != _prevTargetHash) {\n        noa.emit('targetBlockChanged', noa.targetedBlock)\n        _prevTargetHash = newhash\n    }\n}\n\nvar _targetedBlockDat = {\n    blockID: 0,\n    position: [],\n    normal: [],\n    adjacent: [],\n}\n\nvar _prevTargetHash = ''\n\n\n\n\n/*\n * \n *  add some hooks for guidance on removed APIs\n * \n */\n\nfunction deprecateStuff(noa) {\n    var ver = `0.27`\n    var dep = (loc, name, msg) => {\n        var throwFn = () => { throw `This property changed in ${ver} - ${msg}` }\n        Object.defineProperty(loc, name, { get: throwFn, set: throwFn })\n    }\n    dep(noa, 'getPlayerEyePosition', 'to get the camera/player offset see API docs for `noa.camera.cameraTarget`')\n    dep(noa, 'setPlayerEyePosition', 'to set the camera/player offset see API docs for `noa.camera.cameraTarget`')\n    dep(noa, 'getPlayerPosition', 'use `noa.ents.getPosition(noa.playerEntity)` or similar')\n    dep(noa, 'getCameraVector', 'use `noa.camera.getDirection`')\n    dep(noa, 'getPlayerMesh', 'use `noa.ents.getMeshData(noa.playerEntity).mesh` or similar')\n    dep(noa, 'playerBody', 'use `noa.ents.getPhysicsBody(noa.playerEntity)`')\n    dep(noa.rendering, 'zoomDistance', 'use `noa.camera.zoomDistance`')\n    dep(noa.rendering, '_currentZoom', 'use `noa.camera.currentZoom`')\n    dep(noa.rendering, '_cameraZoomSpeed', 'use `noa.camera.zoomSpeed`')\n    dep(noa.rendering, 'getCameraVector', 'use `noa.camera.getDirection`')\n    dep(noa.rendering, 'getCameraPosition', 'use `noa.camera.getLocalPosition`')\n    dep(noa.rendering, 'getCameraRotation', 'use `noa.camera.heading` and `noa.camera.pitch`')\n    dep(noa.rendering, 'setCameraRotation', 'to customize camera behavior see API docs for `noa.camera`')\n    ver = '0.28'\n    dep(noa.rendering, 'makeMeshInstance', 'removed, use Babylon\\'s `mesh.createInstance`')\n    dep(noa.world, '_maxChunksPendingCreation', 'use `maxChunksPendingCreation` (no \"_\")')\n    dep(noa.world, '_maxChunksPendingMeshing', 'use `maxChunksPendingMeshing` (no \"_\")')\n    dep(noa.world, '_maxProcessingPerTick', 'use `maxProcessingPerTick` (no \"_\")')\n    dep(noa.world, '_maxProcessingPerRender', 'use `maxProcessingPerRender` (no \"_\")')\n    ver = '0.29'\n    dep(noa, '_constants', 'removed, voxel IDs are no longer packed with bit flags')\n}\n\n\n\n\n\n\n\nimport { makeProfileHook } from './lib/util'\nvar profile_hook = (PROFILE) ?\n    makeProfileHook(200, 'tick   ') : () => { }\nvar profile_hook_render = (PROFILE_RENDER) ?\n    makeProfileHook(200, 'render ') : () => { }\n","\n\n/* \n * \n *          noa hello-world example\n * \n *  This is a bare-minimum example world, intended to be a \n *  starting point for hacking on noa game world content.\n * \n*/\n\n\n\n// Engine options object, and engine instantiation:\nimport Engine from 'noa-engine'\n\nvar opts = {\n    debug: true,\n    showFPS: true,\n    chunkSize: 32,\n    chunkAddDistance: 2.5,\n    chunkRemoveDistance: 3.5,\n    // See `test` example, or noa docs/source, for more options\n}\nvar noa = new Engine(opts)\n\n\n\n/*\n *\n *      Registering voxel types\n * \n *  Two step process. First you register a material, specifying the \n *  color/texture/etc. of a given block face, then you register a \n *  block, which specifies the materials for a given block type.\n * \n*/\n\n// block materials (just colors for this demo)\nvar textureURL = null // replace that with a filename to specify textures\nvar brownish = [0.45, 0.36, 0.22]\nvar greenish = [0.1, 0.8, 0.2]\nnoa.registry.registerMaterial('dirt', brownish, textureURL)\nnoa.registry.registerMaterial('grass', greenish, textureURL)\n\n// block types and their material names\nvar dirtID = noa.registry.registerBlock(1, { material: 'dirt' })\nvar grassID = noa.registry.registerBlock(2, { material: 'grass' })\n\n\n\n\n/*\n * \n *      World generation\n * \n *  The world is divided into chunks, and `noa` will emit an \n *  `worldDataNeeded` event for each chunk of data it needs.\n *  The game client should catch this, and call \n *  `noa.world.setChunkData` whenever the world data is ready.\n *  (The latter can be done asynchronously.)\n * \n*/\n\n// simple height map worldgen function\nfunction getVoxelID(x, y, z) {\n    if (y < -3) return dirtID\n    var height = 2 * Math.sin(x / 10) + 3 * Math.cos(z / 20)\n    if (y < height) return grassID\n    return 0 // signifying empty space\n}\n\n// register for world events\nnoa.world.on('worldDataNeeded', function (id, data, x, y, z) {\n    // `id` - a unique string id for the chunk\n    // `data` - an `ndarray` of voxel ID data (see: https://github.com/scijs/ndarray)\n    // `x, y, z` - world coords of the corner of the chunk\n    for (var i = 0; i < data.shape[0]; i++) {\n        for (var j = 0; j < data.shape[1]; j++) {\n            for (var k = 0; k < data.shape[2]; k++) {\n                var voxelID = getVoxelID(x + i, y + j, z + k)\n                data.set(i, j, k, voxelID)\n            }\n        }\n    }\n    // tell noa the chunk's terrain data is now set\n    noa.world.setChunkData(id, data)\n})\n\n\n\n\n/*\n * \n *      Create a mesh to represent the player:\n * \n*/\n\n// get the player entity's ID and other info (position, size, ..)\nvar player = noa.playerEntity\nvar dat = noa.entities.getPositionData(player)\nvar w = dat.width\nvar h = dat.height\n\n\n// add a mesh to represent the player, and scale it, etc.\nimport { Mesh } from '@babylonjs/core/Meshes/mesh'\nvar scene = noa.rendering.getScene()\nvar mesh = Mesh.CreateBox('player-mesh', 1, scene)\nmesh.scaling.x = w\nmesh.scaling.z = w\nmesh.scaling.y = h\n\n\n// add \"mesh\" component to the player entity\n// this causes the mesh to move around in sync with the player entity\nnoa.entities.addComponent(player, noa.entities.names.mesh, {\n    mesh: mesh,\n    // offset vector is needed because noa positions are always the \n    // bottom-center of the entity, and Babylon's CreateBox gives a \n    // mesh registered at the center of the box\n    offset: [0, h / 2, 0],\n})\n\n\n\n/*\n * \n *      Minimal interactivity \n * \n*/\n\n// clear targeted block on on left click\nnoa.inputs.down.on('fire', function () {\n    if (noa.targetedBlock) noa.setBlock(0, noa.targetedBlock.position)\n})\n\n// place some grass on right click\nnoa.inputs.down.on('alt-fire', function () {\n    if (noa.targetedBlock) noa.addBlock(grassID, noa.targetedBlock.adjacent)\n})\n\n// add a key binding for \"E\" to do the same as alt-fire\nnoa.inputs.bind('alt-fire', 'E')\n\n\n// each tick, consume any scroll events and use them to zoom camera\nnoa.on('tick', function (dt) {\n    var scroll = noa.inputs.state.scrolly\n    if (scroll !== 0) {\n        noa.camera.zoomDistance += (scroll > 0) ? 1 : -1\n        if (noa.camera.zoomDistance < 0) noa.camera.zoomDistance = 0\n        if (noa.camera.zoomDistance > 10) noa.camera.zoomDistance = 10\n    }\n})\n"],"sourceRoot":""}